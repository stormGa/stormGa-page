<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://stormga.github.io/</id>
    <title>Kohath</title>
    <updated>2020-03-09T11:17:08.804Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://stormga.github.io/"/>
    <link rel="self" href="https://stormga.github.io/atom.xml"/>
    <subtitle>Every ğŸ¦ has an ğŸ¦…&apos;s dream.</subtitle>
    <logo>https://stormga.github.io/images/avatar.png</logo>
    <icon>https://stormga.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, Kohath</rights>
    <entry>
        <title type="html"><![CDATA[å¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„]]></title>
        <id>https://stormga.github.io/post/book-01/</id>
        <link href="https://stormga.github.io/post/book-01/">
        </link>
        <updated>2020-03-09T11:01:21.000Z</updated>
        <summary type="html"><![CDATA[<p>æœ€è¿‘åœ¨è¯»ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ã€‹ï¼Œæ–‡ç« å¹¿åº¦å¾ˆå¤§ï¼Œå¯¹äºæˆ‘è¿™ç§åˆæ­¥å»ºç«‹èµ·ç½‘ç«™æ¶æ„ä½“ç³»çš„äººæ— ç–‘æ˜¯ä¸€ä¸ªå½¢æˆä½“ç³»ç»“æ„çš„æœºä¼šã€‚æœ¬æ–‡å¯¹è¯¥ä¹¦é‡è¦çŸ¥è¯†åšä¸€ä¸ªæ€»ç»“ï¼Œä¾›è‡ªå·±ç»å¸¸ç¿»é˜….</p>
]]></summary>
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨è¯»ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ã€‹ï¼Œæ–‡ç« å¹¿åº¦å¾ˆå¤§ï¼Œå¯¹äºæˆ‘è¿™ç§åˆæ­¥å»ºç«‹èµ·ç½‘ç«™æ¶æ„ä½“ç³»çš„äººæ— ç–‘æ˜¯ä¸€ä¸ªå½¢æˆä½“ç³»ç»“æ„çš„æœºä¼šã€‚æœ¬æ–‡å¯¹è¯¥ä¹¦é‡è¦çŸ¥è¯†åšä¸€ä¸ªæ€»ç»“ï¼Œä¾›è‡ªå·±ç»å¸¸ç¿»é˜….</p>
<!-- more -->
<h1 id="å¤§å‹ç½‘ç«™è¿›åŒ–å²">å¤§å‹ç½‘ç«™è¿›åŒ–å²</h1>
<h2 id="å¤§å‹ç½‘ç«™è½¯ä»¶ç³»ç»Ÿçš„ç‰¹ç‚¹">å¤§å‹ç½‘ç«™è½¯ä»¶ç³»ç»Ÿçš„ç‰¹ç‚¹</h2>
<ul>
<li>é«˜å¹¶å‘ã€å¤§æµé‡</li>
<li>é«˜å¯ç”¨ã€‚7*24å°æ—¶ä¸æ–­çš„æœåŠ¡</li>
<li>æµ·é‡æ•°æ®</li>
<li>ç”¨æˆ·åˆ†å¸ƒå¹¿å‘ã€ç½‘ç»œæƒ…å†µå¤æ‚ã€‚ç”¨æˆ·åˆ†å¸ƒå¹¿ï¼Œå„åœ°çš„ç½‘ç»œæƒ…å†µåƒå·®ä¸‡åˆ«ï¼Œå†è¿‡å›½å†…å„ä¸ªè¿è¥å•†ä¹‹é—´çš„ç½‘ç»œäº’é€šé—®é¢˜</li>
<li>å®‰å…¨ç¯å¢ƒæ¶åŠ£</li>
<li>éœ€æ±‚å¿«é€Ÿå˜æ›´ï¼Œå‘å¸ƒé¢‘ç¹</li>
<li>æ¸è¿›å¼å‘å±•ã€‚ä¹Ÿå°±æ˜¯ éšç€ç½‘ç»œå‘å±•é€æ¸å˜åŒ–çš„ã€‚</li>
</ul>
<h2 id="åˆçº§ç½‘ç«™æ¶æ„">åˆçº§ç½‘ç«™æ¶æ„</h2>
<p>åˆå§‹é˜¶æ®µçš„ç½‘ç«™è®¿é—®äººæ•°æ¯”è¾ƒå°‘ï¼Œæ‰€æœ‰çš„åœ¨ä¸€å°æœåŠ¡å™¨ã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://stormga.github.io//post-images/1089769-20180422153541801-2019951891.png" alt="" loading="lazy"></figure>
<h2 id="åº”ç”¨æœåŠ¡å’Œæ•°æ®æœåŠ¡åˆ†ç¦»">åº”ç”¨æœåŠ¡å’Œæ•°æ®æœåŠ¡åˆ†ç¦»</h2>
<figure data-type="image" tabindex="2"><img src="https://stormga.github.io//post-images/1089769-20180422153949952-969765602.png" alt="" loading="lazy"></figure>
<p>éšç€ä¸šåŠ¡çš„å‘å±•ï¼Œå°±ä¼šå‘ç°ä¸€å°æœåŠ¡å™¨æŠ—ä¸è¿‡æ¥äº†ï¼Œæ‰€ä»¥å°†åº”ç”¨æœåŠ¡å™¨ä¸æ•°æ®ï¼ˆæ–‡ä»¶ã€æ•°æ®åº“ï¼‰æœåŠ¡å™¨åˆ†ç¦»ã€‚ä¸‰å°æœåŠ¡å™¨å¯¹ç¡¬ä»¶èµ„æºçš„è¦æ±‚å„ä¸ç›¸åŒï¼šåº”ç”¨æœåŠ¡å™¨éœ€è¦æ›´å¿«çš„CPUï¼Œæ–‡ä»¶æœåŠ¡å™¨éœ€è¦æ›´å¤§çš„ç£ç›˜å’Œå¸¦å®½ï¼Œæ•°æ®åº“æœåŠ¡å™¨éœ€è¦æ›´å¿«é€Ÿçš„ç£ç›˜å’Œæ›´å¤§çš„å†…å­˜ã€‚åˆ†ç¦»ä¹‹åï¼Œä¸‰ä¸ªæœåŠ¡å™¨å„å¸å…¶èŒï¼Œä¹Ÿæ–¹ä¾¿é’ˆå¯¹æ€§çš„ä¼˜åŒ–ã€‚</p>
<h2 id="ä½¿ç”¨ç¼“å­˜æ”¹å–„ç½‘ç«™æ€§èƒ½">ä½¿ç”¨ç¼“å­˜æ”¹å–„ç½‘ç«™æ€§èƒ½</h2>
<figure data-type="image" tabindex="3"><img src="https://stormga.github.io//post-images/1089769-20180422154411541-1804654037.png" alt="" loading="lazy"></figure>
<p>â€œä¸–ç•Œä¸Šæ²¡æœ‰ä»€ä¹ˆé—®é¢˜æ˜¯åŠ ä¸€çº§ç¼“å­˜è§£å†³ä¸äº†çš„ï¼Œå¦‚æœæœ‰é‚£å°±å†åŠ ä¸€çº§ç¼“å­˜â€</p>
<p>ç¼“å­˜çš„ä½¿ç”¨æ— å¤„ä¸åœ¨ï¼Œç¼“å­˜çš„æ ¹æœ¬ç›®çš„æ˜¯åŠ å¿«è®¿é—®é€Ÿåº¦ã€‚å½“æ•°æ®åº“çš„è®¿é—®å‹åŠ›è¿‡å¤§çš„æ—¶å€™ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨ç¼“å­˜äº†ã€‚ç½‘ç«™ä½¿ç”¨çš„ç¼“å­˜å¯ä»¥åˆ†ä¸ºä¸¤ç§: ç¼“å­˜åœ¨åº”ç”¨æœåŠ¡å™¨ä¸Šçš„æœ¬åœ°ç¼“å­˜å’Œç¼“å­˜åœ¨ä¸“é—¨çš„åˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡å™¨ä¸Šçš„è¿œç¨‹ç¼“å­˜ã€‚</p>
<h2 id="ä½¿ç”¨åº”ç”¨æœåŠ¡å™¨é›†ç¾¤æ”¹å–„ç½‘ç«™çš„å¹¶å‘å¤„ç†èƒ½åŠ›">ä½¿ç”¨åº”ç”¨æœåŠ¡å™¨é›†ç¾¤æ”¹å–„ç½‘ç«™çš„å¹¶å‘å¤„ç†èƒ½åŠ›</h2>
<figure data-type="image" tabindex="4"><img src="https://stormga.github.io//post-images/1089769-20180422154734552-838306655.png" alt="" loading="lazy"></figure>
<p></p>
<p>éšç€ä¸šåŠ¡çš„å‘å±•ï¼Œå•ä¸ªåº”ç”¨æœåŠ¡å™¨ä¸€å®šä¼šæˆä¸ºç“¶é¢ˆï¼Œåº”ç”¨æœåŠ¡å™¨å®ç°é›†ç¾¤æ˜¯ç½‘ç«™å¯ä¼¸ç¼©é›†ç¾¤æ¶æ„è®¾è®¡ä¸­è¾ƒä¸ºç®€å•æˆç†Ÿçš„ä¸€ç§ã€‚åé¢ä¹Ÿä¼šæåˆ°ï¼Œå°†åº”ç”¨æœåŠ¡å™¨è®¾è®¡ä¸ºæ— çŠ¶æ€çš„ï¼ˆæ²¡æœ‰éœ€è¦ä¿å­˜çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼‰ï¼Œå°±å¯ä»¥é€šè¿‡å¢åŠ æœºå™¨ï¼Œä½¿ç”¨è´Ÿè½½å‡è¡¡æ¥scale outã€‚</p>
<h2 id="æ•°æ®åº“è¯»å†™åˆ†ç¦»">æ•°æ®åº“è¯»å†™åˆ†ç¦»</h2>
<figure data-type="image" tabindex="5"><img src="https://stormga.github.io//post-images/1089769-20180422154958394-621428384.png" alt="" loading="lazy"></figure>
<p>å³ä½¿ä½¿ç”¨äº†ç¼“å­˜ï¼Œä½†åœ¨ç¼“å­˜æœªå‘½ä¸­ã€æˆ–è€…ç¼“å­˜æœåŠ¡æ—¶æ•ˆçš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯éœ€è¦è®¿é—®æ•°æ®åº“ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æ•°æ®åº“çš„è¯»å†™åˆ†ç¦»ï¼šä¸»åº“æä¾›å†™æ“ä½œï¼Œä»åº“æä¾›è¯»æœåŠ¡ã€‚æ³¨æ„ï¼Œåœ¨ä¸Šå›¾ä¸­å¢åŠ äº†ä¸€ä¸ªæ•°æ®è®¿é—®æ¨¡å—ï¼Œå¯ä»¥å¯¹åº”ç”¨å±‚é€æ˜æ•°æ®åº“çš„ä¸»ä»åˆ†ç¦»ä¿¡æ¯ã€‚</p>
<h2 id="ä½¿ç”¨åå‘ä»£ç†å’Œcdn-åŠ é€Ÿç½‘ç«™æ™Œåº”">ä½¿ç”¨åå‘ä»£ç†å’ŒCDN åŠ é€Ÿç½‘ç«™æ™Œåº”</h2>
<figure data-type="image" tabindex="6"><img src="https://stormga.github.io//post-images/1089769-20180422155322032-1195590504.png" alt="" loading="lazy"></figure>
<p>CDNå’Œåå‘ä»£ç†å…¶å®éƒ½æ˜¯ç¼“å­˜ï¼ŒåŒºåˆ«åœ¨äºCDN éƒ¨ç½²åœ¨ç½‘ç»œæä¾›å•†çš„æœºæˆ¿ï¼›è€Œåå‘ä»£ç†åˆ™éƒ¨ç½²åœ¨ç½‘ç«™çš„ä¸­å¿ƒæœºæˆ¿ã€‚ä½¿ç”¨CDN å’Œåå‘ä»£ç†çš„ç›®çš„éƒ½æ˜¯å°½æ—±è¿”å›æ•°æ®ç»™ç”¨æˆ·ï¼Œ ä¸€æ–¹é¢åŠ å¿«ç”¨æˆ·è®¿é—®é€Ÿåº¦ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå‡è½»åç«¯æœåŠ¡å™¨çš„è´Ÿè½½å‹åŠ›ã€‚</p>
<h2 id="ä½¿ç”¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå’Œåˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿ">ä½¿ç”¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå’Œåˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿ</h2>
<figure data-type="image" tabindex="7"><img src="https://stormga.github.io//post-images/1089769-20180422155540571-959599459.png" alt="" loading="lazy"></figure>
<p>å•ä¸ªç‰©ç†æœºçš„ç£ç›˜æ˜¯æœ‰é™çš„ï¼Œå•ä¸ªå…³ç³»æ•°æ®åº“çš„å¤„ç†èƒ½åŠ›ä¹Ÿæ˜¯æœ‰ä¸Šé™çš„ï¼Œæ‰€ä»¥éœ€è¦åˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨ä¸åˆ†å¸ƒå¼æ•°æ®åº“ã€‚å½“ç„¶ï¼Œä¹Ÿéœ€è¦â€ç»Ÿä¸€æ•°æ®è®¿é—®æ¨¡å—â€œï¼Œä½¿å¾—åº”ç”¨å±‚ä¸ç”¨å…³å¿ƒæ–‡ä»¶ã€æ•°æ®çš„å…·ä½“ä½ç½®ã€‚å€¼å¾—ä¸€æçš„äº‹ï¼Œå…³ç³»å‹æ•°æ®åº“è‡ªèº«å¹¶æ²¡æœ‰å¾ˆå¥½çš„æ°´å¹³æ‰©å±•æ–¹æ¡ˆï¼Œå› æ­¤ä¸€èˆ¬éƒ½éœ€è¦ä¸€ä¸ªæ•°æ®åº“ä»£ç†å±‚ï¼Œå¦‚mycatã€‚</p>
<h2 id="ä½¿ç”¨nosql-å’Œæœç´¢å¼•æ“">ä½¿ç”¨NoSQL å’Œæœç´¢å¼•æ“</h2>
<figure data-type="image" tabindex="8"><img src="https://stormga.github.io//post-images/1089769-20180422160052062-334394168.png" alt="" loading="lazy"></figure>
<p>web2.0çš„å¾ˆå¤šåº”ç”¨å¹¶ä¸€å®šé€‚åˆç”¨å…³ç³»æ•°æ®åº“å­˜å‚¨ï¼Œæ›´åŠ çµæ´»çš„NoSqlèƒ½æ›´åŠ æ–¹ä¾¿çš„è§£å†³ä¸€äº›é—®é¢˜ï¼Œè€Œä¸”NoSQLå¤©ç„¶å°±æ”¯æŒåˆ†å¸ƒå¼ã€‚ä¸“é—¨çš„æœç´¢å¼•æ“åœ¨æä¾›æ›´ä¼˜è´¨æœåŠ¡çš„åŒæ—¶ï¼Œä¹Ÿå¤§å¤§å‡è½»äº†æ•°æ®åº“çš„å‹åŠ›ã€‚</p>
<h2 id="ä¸šåŠ¡æ‹†åˆ†">ä¸šåŠ¡æ‹†åˆ†</h2>
<p><img src="https://stormga.github.io//post-images/1089769-20180422160336085-10854169.png" alt="" loading="lazy">â€</p>
<p>å°†ä¸€ä¸ªç½‘ç«™æ‹†åˆ†æˆè®¸å¤šä¸åŒçš„åº”ç”¨ï¼Œ æ¯ä¸ªåº”ç”¨ç‹¬ç«‹éƒ¨ç½²ç»´æŠ¤ã€‚åº”ç”¨ä¹‹é—´å¯ä»¥é€šè¿‡ä¸€ä¸ªè¶…é“¾æ¥å»ºç«‹å…³ç³»(åœ¨é¦–é¡µä¸Šçš„å¯¼èˆªé“¾æ¥æ¯ä¸ªéƒ½æŒ‡å‘ä¸åŒçš„åº”ç”¨åœ°å€) ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œæ•°æ®åˆ†å‘ï¼Œ å½“ç„¶æœ€å¤šçš„è¿˜æ˜¯é€šè¿‡è®¿é—®åŒä¸€ä¸ªæ•°æ®å­˜å‚¨ç³»ç»Ÿæ¥æ„æˆä¸€ä¸ªå…³è”çš„å®Œæ•´ç³»ç»Ÿ</p>
<h2 id="åˆ†å¸ƒå¼æœåŠ¡">åˆ†å¸ƒå¼æœåŠ¡</h2>
<figure data-type="image" tabindex="9"><img src="https://stormga.github.io//post-images/1089769-20180422160547076-1416732001.png" alt="" loading="lazy"></figure>
<p>æ—¢ç„¶æ¯ä¸€ä¸ªåº”ç”¨ç³»ç»Ÿéƒ½éœ€è¦æ‰§è¡Œè®¸å¤šç›¸åŒçš„ä¸šåŠ¡æ“ä½œï¼Œ æ¯”å¦‚ç”¨æˆ·ç®¡ç†ã€å•†å“ç®¡ç†ç­‰ï¼Œé‚£ä¹ˆå¯ä»¥<strong>å°†è¿™äº›å…±ç”¨çš„ä¸šåŠ¡æå–å‡ºæ¥ï¼Œç‹¬ç«‹éƒ¨ç½²</strong>ã€‚</p>
<p>é€šè¿‡æœåŠ¡çš„åˆ†å¸ƒå¼ï¼Œå„ä¸ªåº”ç”¨èƒ½æ›´å¥½çš„ç‹¬ç«‹å‘å±•ï¼Œå®ç°äº†<strong>ä»ä¾èµ–æ¨¡å—åˆ°ä¾èµ–æœåŠ¡çš„è¿‡æ¸¡</strong>ã€‚å°†é€šç”¨çš„å…¬å…±æœåŠ¡ç‹¬ç«‹å‡ºæ¥ï¼Œä¹Ÿæ–¹ä¾¿åšæœåŠ¡ç®¡æ§ï¼Œæ¯”å¦‚å¯¹å„ä¸ªåº”ç”¨çš„æœåŠ¡è¯·æ±‚è¿›è¡Œç›‘æ§ï¼Œåœ¨é«˜å³°æ—¶æœŸé™åˆ¶ã€å…³é—­æŸäº›åº”ç”¨çš„è®¿é—®ç­‰</p>
<h1 id="å¤§å‹ç½‘ç«™æ¶æ„æ¨¡å¼">å¤§å‹ç½‘ç«™æ¶æ„æ¨¡å¼</h1>
<p>æ–‡ä¸­è¯´ï¼šâ€œ<strong>æ¯ä¸ªæ¨¡å¼æè¿°äº†ä¸€ä¸ªåœ¨æˆ‘ä»¬å‘¨å›´ä¸æ–­é‡å¤å‘ç”Ÿçš„é—®é¢˜ä»¥åŠè¯¥é—®é¢˜è§£å†³æ–¹æ¡ˆçš„æ ¸å¿ƒï¼Œè¿™æ ·å°±èƒ½ä¸€æ¬¡åˆä¸€æ¬¡çš„ä½¿ç”¨è¿™ä¸ªæ–¹æ¡ˆä¸å¿…åšé‡å¤å·¥ä½œ</strong>â€ã€‚æ¨¡å¼çš„å…³é”®åœ¨äºæ¨¡å¼çš„å¯é‡å¤æ€§ï¼Œ é—®é¢˜ä¸åœºæ™¯çš„å¯é‡å¤æ€§å¸¦æ¥è§£å†³æ–¹æ¡ˆçš„å¯é‡å¤ä½¿ç”¨ã€‚</p>
<h2 id="åˆ†å±‚">åˆ†å±‚</h2>
<p>å°†ç½‘ç«™è½¯ä»¶ç³»ç»Ÿåˆ†ä¸ºåº”ç”¨å±‚ï¼ŒæœåŠ¡å±‚ï¼Œæ•°æ®å±‚ã€‚</p>
<p>åˆ†å±‚çš„å¥½å¤„åœ¨äºï¼šè§£è€¦åˆï¼Œç‹¬ç«‹å‘å±•ï¼Œä¼¸ç¼©æ€§ï¼Œå¯æ‰©å±•æ€§ã€‚</p>
<p>ä½†æ˜¯åˆ†å±‚æ¶æ„ä¹Ÿæœ‰ä¸€äº›æŒ‘æˆ˜ï¼Œ å°±æ˜¯<strong>å¿…é¡»åˆç†è§„åˆ’å±‚æ¬¡è¾¹ç•Œå’Œæ¥å£</strong>ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸¥æ ¼éµå¾ªåˆ†å±‚æ¶æ„çš„çº¦æŸï¼Œ ç¦æ­¢è·¨å±‚æ¬¡çš„è°ƒç”¨( åº”ç”¨å±‚ç›´æ¥è°ƒç”¨æ•°æ®å±‚)åŠé€†å‘è°ƒç”¨(æ•°æ®å±‚è°ƒç”¨æœåŠ¡å±‚ï¼Œ æˆ–è€…æœåŠ¡å±‚è°ƒç”¨åº”ç”¨å±‚)ã€‚</p>
<p>åˆ†å±‚åçš„å„ä¸ªæ¨¡å—å¯ä»¥éƒ¨ç½²åœ¨åŒä¸€ä¸ªç‰©ç†æœºå™¨ä¸Šã€‚åˆ†å±‚æœ€åˆæ˜¯ä¸ºäº†è§„åˆ’è½¯ä»¶æ¸…æ™°çš„é€»è¾‘ç»“æ„ä¾¿äºå¼€å‘ï¼Œè€Œåœ¨ç½‘ç«™å‘å±•ä¸­ï¼Œåˆ†å±‚åœ¨æ”¯æŒåˆ†å¸ƒå¼é«˜å¹¶å‘æ—¶æ˜¯å¿…è¦çš„ã€‚</p>
<h2 id="åˆ†å‰²">åˆ†å‰²</h2>
<p>åˆ†å±‚å¼ºè°ƒçš„æ˜¯æ¨ªå‘åˆ‡åˆ†ï¼Œè€Œåˆ†å‰²æ˜¯çºµå‘åˆ‡åˆ†ï¼Œ ä¸Šé¢ç½‘ç«™è¿›åŒ–å²éƒ¨åˆ†çš„ä¸šåŠ¡æ‹†åˆ†å°±åŒ…å«äº†åˆ†å‰²ã€‚</p>
<p>åˆ†å‰²çš„ç›®æ ‡æ˜¯é«˜å†…èšã€ä½è€¦åˆçš„æ¨¡å—å•å…ƒã€‚</p>
<p>æ¯”å¦‚åœ¨åº”ç”¨å±‚ï¼Œå°†è´­ç‰©ï¼Œè®ºå›ï¼Œå¹¿å‘Šåˆ†å‰²æˆä¸åŒçš„åº”ç”¨ï¼Œç”±ä¸åŒå›¢é˜Ÿå¼€å‘ï¼Œéƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šã€‚</p>
<h2 id="åˆ†å¸ƒå¼">åˆ†å¸ƒå¼</h2>
<p>åˆ†å±‚å’Œåˆ†å‰²çš„ä¸€ä¸ªä¸»è¦ç›®çš„æ˜¯åˆ†å¸ƒå¼éƒ¨ç½²ï¼Œä½†åˆ†å¸ƒå¼ä¹Ÿæœ‰è‡ªå·±çš„é—®é¢˜ï¼šç½‘ç»œé€šä¿¡å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œå¯ç”¨æ€§ï¼Œä¸€è‡´æ€§ä¸åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œç³»ç»Ÿç»´æŠ¤ç®¡ç†å¤æ‚åº¦ã€‚</p>
<ul>
<li>åˆ†å¸ƒå¼åº”ç”¨å’ŒæœåŠ¡</li>
<li>åˆ†å¸ƒå¼é™æ€èµ„æº</li>
<li>åˆ†å¸ƒå¼æ•°æ®å’Œå­˜å‚¨</li>
<li>åˆ†å¸ƒå¼è®¡ç®—</li>
</ul>
<h2 id="é›†ç¾¤">é›†ç¾¤</h2>
<p>ä¸€ä¸ªæœºå™¨è§£å†³ä¸äº†çš„é—®é¢˜ï¼Œå°±ç”¨å‡ ä¸ªæœºå™¨æ¥è§£å†³ï¼Œå½“æœåŠ¡æ— çŠ¶æ€çš„æ—¶å€™ï¼Œé€šè¿‡å¾€é›†ç¾¤å¢åŠ æœºå™¨å°±èƒ½è§£å†³å¤§éƒ¨åˆ†é—®é¢˜ã€‚å¯¹åº”ç½‘ç«™è¿›åŒ–å²ä¸­â€œä½¿ç”¨åº”ç”¨æœåŠ¡å™¨é›†ç¾¤æ”¹å–„ç½‘ç«™çš„å¹¶å‘å¤„ç†èƒ½åŠ›â€</p>
<p><strong>ä¾‹å¦‚ç½‘ç«™é¦–é¡µï¼Œè®¿é—®é›†ä¸­ï¼Œå¯ä»¥å¤šå°æœåŠ¡å™¨éƒ¨ç½²ç›¸åŒçš„æœåŠ¡æ„æˆä¸€ä¸ªé›†ç¾¤ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡è®¾å¤‡å…±åŒå¯¹å¤–æœåŠ¡</strong></p>
<h2 id="ç¼“å­˜">ç¼“å­˜</h2>
<p>ç¼“å­˜å°±æ˜¯å°†æ•°æ®å­˜æ”¾åœ¨è·ç¦»è®¡ç®—æœ€è¿‘çš„ä½ç½®ä»¥åŠ å¿«å¤„ç†é€Ÿåº¦ï¼ŒåŒæ—¶å¤§å¤§å‡è½»äº†æ•°æ®æä¾›è€…çš„å‹åŠ›</p>
<p>å¤§å‹ç½‘ç«™æ¶æ„è®¾è®¡åœ¨å¾ˆå¤šæ–¹é¢éƒ½ä½¿ç”¨äº†ç¼“å­˜è®¾è®¡ï¼š<strong>CDNã€åå‘ä»£ç†ã€æœ¬åœ°ç¼“å­˜ã€åˆ†å¸ƒå¼ç¼“å­˜</strong></p>
<h2 id="å¼‚æ­¥">å¼‚æ­¥</h2>
<p>å¼‚æ­¥æ˜¯è§£è€¦åˆçš„ä¸€ä¸ªé‡è¦æ‰‹æ®µï¼Œå¸¸è§çš„ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹å°±æ˜¯ä¸€ä¸ªå¼‚æ­¥æ¨¡å¼ã€‚</p>
<p>å‡ºäº†è§£è€¦åˆï¼Œå¼‚æ­¥è¿˜èƒ½æé«˜ç³»ç»Ÿå¯ç”¨æ€§ã€åŠ å¿«å“åº”é€Ÿåº¦ã€æµé‡å‰Šå³°</p>
<h2 id="å†—ä½™">å†—ä½™</h2>
<p>å†—ä½™æ˜¯ç³»ç»Ÿå¯ç”¨æ€§çš„é‡è¦ä¿éšœï¼Œä¹Ÿæ˜¯æ•°æ®å¯é æ€§çš„é‡è¦æ‰‹æ®µã€‚æ•°æ®åº“å†·å¤‡ä»½å’Œçƒ­å¤‡ä»½ã€‚</p>
<h2 id="è‡ªåŠ¨åŒ–">è‡ªåŠ¨åŒ–</h2>
<p>å‡¡äººæ€»æ˜¯ä¼šå‡ºè¿™æ ·é‚£æ ·çš„é”™è¯¯ï¼Œèƒ½è‡ªåŠ¨è¯çš„å°±è¦è‡ªåŠ¨åŒ–ã€‚è‡ªåŠ¨åŒ–å¤§å¤§è§£æ”¾äº†ç¨‹åºå‘˜ã€è¿ç»´äººå‘˜çš„ç”Ÿäº§åŠ›ï¼</p>
<p>å‘å¸ƒè¿‡ç¨‹è‡ªåŠ¨åŒ–ã€è‡ªåŠ¨åŒ–ä»£ç ç®¡ç†ã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€è‡ªåŠ¨åŒ–å®‰å…¨æ£€æµ‹ã€è‡ªåŠ¨åŒ–éƒ¨ç½²ã€è‡ªåŠ¨åŒ–ç›‘æ§ã€è‡ªåŠ¨åŒ–æŠ¥è­¦ã€è‡ªåŠ¨åŒ–å¤±æ•ˆè½¬ç§»ã€è‡ªåŠ¨åŒ–å¤±æ•ˆæ¢å¤ã€è‡ªåŠ¨åŒ–é™çº§ã€‚</p>
<h1 id="æ¶æ„æ¨¡å¼åœ¨æ–°æµªçš„åº”ç”¨">æ¶æ„æ¨¡å¼åœ¨æ–°æµªçš„åº”ç”¨</h1>
<ul>
<li>æ—©èµ·ä½¿ç”¨MPSSï¼ˆå•æœåŠ¡å™¨å¤šç«¯å£ï¼‰ï¼Œæ¯å°éƒ½éƒ¨ç½²å¤šä¸ªæœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡ä½¿ç”¨ä¸åŒçš„ç«¯å£æä¾›æœåŠ¡ã€‚ç°åœ¨å¸¸ç”¨çš„æœåŠ¡éƒ¨ç½²ï¼Œä¸€å°æœºå™¨è™šæ‹Ÿæˆå¤šä¸ªæœºå™¨ã€‚</li>
<li>å¼‚æ­¥æ¨æ‹‰ï¼šç”¨æˆ·å‘å¾®åšåä¼šåœ¨æ‰€æœ‰ç²‰ä¸è®¢é˜…ä¸­æ˜¾ç¤ºï¼Œè¿™æ ·ä¼šé€ æˆä¸€ä¸ªç”¨æˆ·å‘æ–‡ï¼Œä¼šå°†è¿™æ¡å¾®åšæ’å…¥åˆ°æ‰€æœ‰ç²‰ä¸è®¢é˜…ä¸­é€ æˆå¤§é‡å†™æ“ä½œã€‚æ–°æµªä½¿ç”¨å¼‚æ­¥æ¨æ‹‰ç»“åˆï¼Œç”¨æˆ·å‘å¾®åšåå†™å…¥æ¶ˆæ¯é˜Ÿåˆ—åç«‹å³è¿”å›ï¼Œç”¨æˆ·å“åº”è¿…é€Ÿï¼Œæ¶ˆæ¯é˜Ÿåˆ—æ¶ˆè´¹è€…å°†å¾®åšæ¨é€ç»™æ‰€æœ‰å½“å‰<strong>åœ¨çº¿ç²‰ä¸</strong>ï¼Œéåœ¨çº¿ç”¨æˆ·ä¸Šçº¿åæ ¹æ®å…³æ³¨åˆ—è¡¨æ‹‰å–è®¢é˜…åˆ—è¡¨ã€‚</li>
<li>ç”±äºå¾®åšæ›´æ–°é¢‘ç¹ï¼Œæ–°æµªä½¿ç”¨å¤šçº§ç¼“å­˜ï¼Œçƒ­é—¨å¾®åšå’Œæ˜æ˜Ÿç”¨æˆ·çš„å¾®åšç¼“å­˜åœ¨æ‰€æœ‰æœåŠ¡å™¨ä¸­ï¼Œåœ¨çº¿ç”¨æˆ·çš„å¾®åšå’Œè¿‘æœŸå¾®åšåœ¨åˆ†å¸ƒå¼ç¼“å­˜é›†ç¾¤ä¸­ã€‚æ‰€ä»¥â€œåˆ·å¾®åšæ“ä½œå…¨éƒ¨éƒ½æ˜¯ç¼“å­˜è®¿é—®â€ã€‚</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[SpringBootä½¿ç”¨Redisçš„åºåˆ—åŒ–é—®é¢˜]]></title>
        <id>https://stormga.github.io/post/springboot-reids-Serialization/</id>
        <link href="https://stormga.github.io/post/springboot-reids-Serialization/">
        </link>
        <updated>2020-03-09T10:51:13.000Z</updated>
        <summary type="html"><![CDATA[<p>redisä½œä¸ºäº’è”ç½‘ä¸­é‡è¦çš„åŠ é€Ÿç»„ä»¶ï¼Œåœ¨ç³»ç»Ÿä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ï¼Œåœ¨ä½¿ç”¨springbootæ•´åˆredisçš„æ—¶å€™è¸©å‘çºªè®°å½•ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>redisä½œä¸ºäº’è”ç½‘ä¸­é‡è¦çš„åŠ é€Ÿç»„ä»¶ï¼Œåœ¨ç³»ç»Ÿä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ï¼Œåœ¨ä½¿ç”¨springbootæ•´åˆredisçš„æ—¶å€™è¸©å‘çºªè®°å½•ã€‚</p>
<!-- more -->
<h1 id="redisç®€ä»‹">Redisç®€ä»‹</h1>
<ul>
<li>redisæ˜¯ä¸€ç§è¿è¡Œåœ¨å†…å­˜çš„æ•°æ®åº“ï¼Œæ”¯æŒ7ç§æ•°æ®ç±»å‹å­˜å‚¨ã€‚</li>
<li>rediså¼€æºï¼Œä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ï¼Œéµå®ˆBSDåè®®ï¼Œæ”¯æŒç½‘ç»œï¼Œå¯ä»¥å­˜å‚¨åœ¨å†…å­˜ï¼Œä¹Ÿæ”¯æŒæ•°æ®æŒä¹…åŒ–çš„æ—¥æ‰§è¡Œï¼Œé”®å€¼å¯¹å‹æ•°æ®åº“ï¼Œæä¾›äº†å¤šç§è¯­è¨€çš„api</li>
<li>æŒ‰ç…§å®˜ç½‘æ–‡æ¡£ï¼Œredisæ”¯æŒ1så†…10ä¸‡æ¬¡çš„è¯»å†™ã€‚</li>
<li>Redisåœ¨2.6ç‰ˆæœ¬å¢åŠ äº†Luaè¯­è¨€çš„æ”¯æŒï¼Œè€Œä¸”redisåœ¨Luaè¯­è¨€ä¸‹ çš„æ‰§è¡Œæ˜¯åŸå­æ€§çš„ï¼Œä¹Ÿå°±æ˜¯ä¸è¢«å…¶ä»–å‘½ä»¤æ‰“æ–­ã€‚è¿™æ ·æˆ‘ä»¬ä¿è¯åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹çš„ä¸€è‡´æ€§ã€‚</li>
</ul>
<h2 id="redisåœ¨springboot-çš„pomæ–‡ä»¶ä¸­çš„é…ç½®">redisåœ¨springboot çš„pomæ–‡ä»¶ä¸­çš„é…ç½®</h2>
<pre><code class="language-xml">&lt;!-- redisä¾èµ– --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;io.lettuce&lt;/groupId&gt;
            &lt;artifactId&gt;lettuce-core&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;

&lt;!-- redisçš„å®¢æˆ·ç«¯jedis --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;redis.clients&lt;/groupId&gt;
    &lt;artifactId&gt;jedis&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<ul>
<li>spring-boot-starter-data-redisé»˜è®¤ä¼šå¯åŠ¨Lettuceä½œä¸ºrediså®¢æˆ·ç«¯é©±åŠ¨ï¼Œä½†æ˜¯ä¸€èˆ¬æˆ‘ä»¬ä¼šç”¨jedisï¼Œæ‰€ä»¥åœ¨è¿™é‡Œä½¿ç”¨exclusionæ’é™¤ã€‚</li>
</ul>
<h1 id="spring-data-redisçš„è®¾è®¡">Spring-data-redisçš„è®¾è®¡</h1>
<ul>
<li>
<p>Spring æä¾›äº†ä¸€ä¸ªRedisConnectionFactoryæ¥å£</p>
</li>
<li>
<p>é€šè¿‡RedisConnectionFactoryæ¥å£å¯ä»¥ç”Ÿæˆä¸€ä¸ªRedisConnectionæ¥å£å¯¹è±¡</p>
</li>
<li>
<p>RedisConnectionæ¥å£å¯¹è±¡å°±æ˜¯å¯¹redisåº•å±‚çš„å°è£…</p>
</li>
<li>
<p>å¦‚æœæˆ‘ä»¬è¦æ“ä½œredisï¼Œæˆ‘ä»¬éœ€è¦å…ˆä»å·¥å‚è·å¾—è¿æ¥ï¼Œç„¶åä½¿ç”¨ååœ¨å…³é—­ä»–ï¼Œspring ä¸ºäº†ç®€åŒ–å¼€å‘æä¾›äº†RedisTemplateå»ä»RedisConnectionFactoryå·¥å‚è·å–è¿æ¥ï¼Œç„¶åæ‰§è¡Œrediså‘½ä»¤ï¼Œå…³é—­è¿æ¥ã€‚</p>
</li>
</ul>
<h2 id="è§£å†³åºåˆ—åŒ–é—®é¢˜">è§£å†³åºåˆ—åŒ–é—®é¢˜</h2>
<ul>
<li>æˆ‘ä»¬éœ€è¦çŸ¥é“redisæ˜¯åŸºäºå­—ç¬¦ä¸²å­˜å‚¨çš„NoSQLï¼Œè€ŒJavaæ˜¯åŸºäºå¯¹è±¡å­˜å‚¨çš„ã€‚å¯¹è±¡æ˜¯æ— æ³•å­˜å‚¨åˆ°redisä¸­çš„ã€‚</li>
<li>Javaæä¾›äº†åºåˆ—åŒ–æœºåˆ¶ï¼Œåªè¦ç±»å®ç°äº†java.io.Serializableæ¥å£ï¼Œè¿™æ ·å°±èƒ½å°†å¯¹è±¡è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œè¿™æ ·rediså°±èƒ½å°†å¯¹è±¡ä»¥å­—ç¬¦ä¸²å­˜å‚¨ã€‚</li>
<li>Springæä¾›äº†åºåˆ—åŒ–æœºåˆ¶ã€‚</li>
<li><strong>åœ¨é»˜è®¤æƒ…å†µä¸‹ä¼šä½¿ç”¨JdkSerializationRedisSerializerå¯¹å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œä½†è¿™æ ·ä¼šå¾—åˆ°å¤æ‚çš„å­—ç¬¦ä¸²ï¼Œä¸åˆ©ç”¨æˆ‘ä»¬ä½¿ç”¨redisã€‚</strong></li>
</ul>
<h3 id="è§£å†³æ–¹æ³•">è§£å†³æ–¹æ³•</h3>
<ul>
<li>åœ¨springbootçš„å¯åŠ¨æ–‡ä»¶ä¸­ä¿®æ”¹RedisTemplateåºåˆ—åŒ–å™¨</li>
</ul>
<pre><code class="language-java">@Autowired
private RedisTemplate redisTemplate = null;


//å®šä¹‰è‡ªå®šä¹‰ååˆå§‹åŒ–æ–¹æ³•
@PostConstruct
public void init(){
    initRedisTemplate();
}

private void initRedisTemplate(){
    RedisSerializer stringSerializable = redisTemplate.getStringSerializer();
    redisTemplate.setKeySerializer(stringSerializable);
    redisTemplate.setHashKeySerializer(stringSerializable);

}
</code></pre>
<ul>
<li>é¦–å…ˆä¼˜@AutoWiredæ³¨å…¥ç”±springbooté…ç½®ç”Ÿæˆçš„RedisTemplateï¼Œç„¶ååˆ©ç”¨spring beançš„ç”Ÿå‘½å‘¨æœŸç‰¹æ€§ä½¿ç”¨@PostConstructè‡ªå®šä¹‰åˆå§‹åŒ–æ–¹æ³•ã€‚</li>
<li>åœ¨è¿™ä¸ªåˆå§‹åŒ–æ–¹æ³•é‡Œï¼ŒæŠŠredisTemplateä¸­çš„é”®åºåˆ—åŒ–å™¨ä¿®æ”¹ä¸ºStringRedisSerializerå¯¹è±¡</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[SpringBootï¼ˆäºŒï¼‰]]></title>
        <id>https://stormga.github.io/post/springboot-note2/</id>
        <link href="https://stormga.github.io/post/springboot-note2/">
        </link>
        <updated>2020-03-09T10:47:49.000Z</updated>
        <summary type="html"><![CDATA[<p>æœ¬æ–‡ç»§ç»­ä»‹ç»SpringBootçš„ä½¿ç”¨ï¼šSpringBootä¸‹çš„SpringMVCï¼ŒSpringBooté›†æˆMyBatisï¼ŒSpringBootå®ç°restful,SpringBootçƒ­éƒ¨ç½²æ’ä»¶ï¼ŒSpringBooté›†æˆRedisã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>æœ¬æ–‡ç»§ç»­ä»‹ç»SpringBootçš„ä½¿ç”¨ï¼šSpringBootä¸‹çš„SpringMVCï¼ŒSpringBooté›†æˆMyBatisï¼ŒSpringBootå®ç°restful,SpringBootçƒ­éƒ¨ç½²æ’ä»¶ï¼ŒSpringBooté›†æˆRedisã€‚</p>
<!-- more -->
<h1 id="springbootä¸‹çš„springmvc">SpringBootä¸‹çš„SpringMVC</h1>
<h2 id="restcontroller">@RestController</h2>
<ul>
<li>è¿™ä¸ªæ³¨è§£çš„ä½œç”¨å°±æ˜¯Controller + ResponseBody</li>
<li>æ‰€æœ‰æ–¹æ³•çš„è¿”å›å€¼éƒ½æ˜¯json</li>
</ul>
<pre><code class="language-java">@RestController
public class UserController {

    @RequestMapping(&quot;/boot/getUser&quot;)
    public Object getUser(){
        User user = new User();
        user.setId(&quot;1&quot;);
        user.setAge(&quot;12&quot;);
        user.setName(&quot;zs&quot;);
        return user;
    }
}
</code></pre>
<h2 id="getmapping">@GetMapping</h2>
<h2 id="postmapping">@PostMapping</h2>
<h2 id="putmapping">@PutMapping</h2>
<h2 id="deletemapping">@DeleteMapping</h2>
<h1 id="springbooté›†æˆmybatis">SpringBooté›†æˆMyBatis</h1>
<h2 id="æ·»åŠ ä¾èµ–">æ·»åŠ ä¾èµ–</h2>
<pre><code class="language-xml">&lt;!-- Tomcatå¯¹jspçš„ä¾èµ– --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;
    &lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;
&lt;/dependency&gt;

&lt;!-- Tomcatå¯¹servletçš„ä¾èµ– --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
    &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
&lt;/dependency&gt;

&lt;!-- jspçš„ä¾èµ– --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;
    &lt;artifactId&gt;javax.servlet.jsp-api&lt;/artifactId&gt;
    &lt;version&gt;2.3.1&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- jstlä¾èµ– --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
    &lt;artifactId&gt;jstl&lt;/artifactId&gt;
&lt;/dependency&gt;


&lt;!-- æ·»åŠ Myatisä¾èµ– --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;1.3.1&lt;/version&gt;
&lt;/dependency&gt;


&lt;!-- æ·»åŠ Mysql-jdbcä¾èµ–--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;mysql&lt;/groupId&gt;
    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<h2 id="applicationpropertiesä¸­é…ç½®æ•°æ®åº“ä¿¡æ¯">application.propertiesä¸­é…ç½®æ•°æ®åº“ä¿¡æ¯</h2>
<pre><code class="language-properties"># é…ç½®mybatisçš„mapper.xmlæ–‡ä»¶
mybatis.mapper-locations=classpath:cn/lkhcoding/springboot/mapper/*.xml


# æ•°æ®åº“è¿æ¥ä¿¡æ¯
spring.datasource.url=jdbc:MySQL://localhost:3306/springboot_chapter
spring.datasource.username=root
spring.datasource.password=root
</code></pre>
<h2 id="åœ¨mapperæ¥å£ä¸Šæ·»åŠ mapperæ³¨è§£æˆ–è€…åœ¨è¿è¡Œä¸»ç±»æ·»åŠ mapperscanxxxxxxæ³¨è§£åŒ…æ‰«æ">åœ¨mapperæ¥å£ä¸Šæ·»åŠ @Mapperæ³¨è§£æˆ–è€…åœ¨è¿è¡Œä¸»ç±»æ·»åŠ @MapperScan(&quot;xx.xx.xx&quot;)æ³¨è§£åŒ…æ‰«æ</h2>
<ul>
<li>UserMapper.java</li>
</ul>
<pre><code class="language-java">@Mapper
public interface UserMapper {

    /**
     * æ ¹æ®idè·å–ä¿¡æ¯
     * @return
     */
    User getUser(int id);
}
</code></pre>
<ul>
<li>
<p>UserMapper.xml</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper
  PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
  &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
  
&lt;mapper namespace=&quot;cn.lkhcoding.springboot.mapper.UserMapper&quot;&gt;
   &lt;select id=&quot;getUser&quot; resultType=&quot;cn.lkhcoding.springboot.model.User&quot;&gt;
      SELECT id,name,age FROM user WHERE id=#{id}
   &lt;/select&gt;
&lt;/mapper&gt;
</code></pre>
</li>
</ul>
<h2 id="åœ¨pomä¸­æ·»åŠ ">åœ¨POMä¸­æ·»åŠ </h2>
<pre><code class="language-xml">&lt;resources&gt;
    &lt;resource&gt;
        &lt;directory&gt;src/main/java&lt;/directory&gt;
        &lt;includes&gt;
            &lt;include&gt;**/*.xml&lt;/include&gt;
        &lt;/includes&gt;
    &lt;/resource&gt;
    &lt;resource&gt;
        &lt;directory&gt;src/main/resources&lt;/directory&gt;
        &lt;includes&gt;
            &lt;include&gt;**/*.*&lt;/include&gt;
        &lt;/includes&gt;
    &lt;/resource&gt;
    &lt;resource&gt;
        &lt;directory&gt;src/main/webapp&lt;/directory&gt;
        &lt;targetPath&gt;META-INF/resources&lt;/targetPath&gt;
        &lt;includes&gt;
            &lt;include&gt;**/*.*&lt;/include&gt;
        &lt;/includes&gt;
    &lt;/resource&gt;
&lt;/resources&gt;
</code></pre>
<h2 id="ä½¿ç”¨controllerè®¿é—®">ä½¿ç”¨Controllerè®¿é—®</h2>
<pre><code class="language-java">@Autowired
private UserService userService;

@RequestMapping(&quot;/boot/getUserFromMysql&quot;)
public  User getUser(int id) {
    return userService.getUser(id);
}
</code></pre>
<p>#SpringBootå®ç°restful</p>
<h2 id="ä½¿ç”¨pathvariable">ä½¿ç”¨@PathVariable</h2>
<ul>
<li>
<p>è·å–urlçš„æ•°æ®</p>
</li>
<li>
<p>è¯¥æ³¨è§£æ˜¯å®ç°RESTFullæœ€é‡è¦çš„ä¸€ä¸ªæ³¨è§£</p>
<pre><code class="language-java">@RequestMapping(&quot;/boot/getUserFromMysql/{id}&quot;)
public User getUser(@PathVariable(&quot;id&quot;) int id) {
    return userService.getUser(id);
}
</code></pre>
</li>
<li>
<p>è®¿é—®çš„æ—¶å€™è·¯å¾„ä¸º:http://localhost:8080/springboot_03/boot/getUserFromMysql/1</p>
</li>
</ul>
<p>#SpringBootçƒ­éƒ¨ç½²æ’ä»¶</p>
<h2 id="ä¸ºä»€ä¹ˆéœ€è¦çƒ­éƒ¨ç½²">ä¸ºä»€ä¹ˆéœ€è¦çƒ­éƒ¨ç½²</h2>
<ul>
<li>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¿®æ”¹ä»£ç çš„é€»è¾‘åŠŸèƒ½ï¼Œéƒ½éœ€è¦é‡å¯åº”ç”¨ï¼Œè¿™æ— å½¢ä¸­é™ä½äº†å¼€å‘æ•ˆç‡.</li>
</ul>
<h2 id="92-ä»€ä¹ˆæ˜¯çƒ­éƒ¨ç½²">9.2 ä»€ä¹ˆæ˜¯çƒ­éƒ¨ç½²</h2>
<ul>
<li>å½“æˆ‘ä»¬ä¿®æ”¹ä»£ç çš„æ—¶å€™ï¼ŒæœåŠ¡èƒ½è‡ªåŠ¨é‡å¯åŠ è½½æ–°ä¿®æ”¹çš„å†…å®¹ï¼Œè¿™æ ·å¤§å¤§æé«˜äº†æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡</li>
</ul>
<h2 id="93-å®ç°çƒ­éƒ¨ç½²">9.3 å®ç°çƒ­éƒ¨ç½²</h2>
<h3 id="931-æ·»åŠ æ’ä»¶spring-boot-devtools">9.3.1 æ·»åŠ æ’ä»¶spring-boot-devtools</h3>
<ul>
<li>
<p>åœ¨pomæ–‡ä»¶ä¸­æ·»åŠ </p>
<pre><code class="language-xml">&lt;!-- spring-boot-devtools --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
    &lt;optional&gt;true&lt;/optional&gt;
&lt;/dependency&gt;
</code></pre>
</li>
</ul>
<p>#SpringBooté›†æˆRedis</p>
<h2 id="åœ¨pomä¸­æ·»åŠ jarä¾èµ–">åœ¨pomä¸­æ·»åŠ jarä¾èµ–</h2>
<pre><code class="language-xml">&lt;!--  springboot  redisä¾èµ– --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<h2 id="åœ¨applicationpropertiesä¸­é…ç½®redisè¿æ¥ä¿¡æ¯">åœ¨application.propertiesä¸­é…ç½®redisè¿æ¥ä¿¡æ¯</h2>
<pre><code class="language-properties"># Redisé…ç½®
spring.redis.host=xxx.xxx.xxx.xxx
spring.redis.port=6379
spring.redis.password=xxx
</code></pre>
<h2 id="åœ¨éœ€è¦æ“ä½œredisçš„ç±»ä¸­æ³¨å…¥redis-template">åœ¨éœ€è¦æ“ä½œredisçš„ç±»ä¸­æ³¨å…¥redis Template</h2>
<ul>
<li>
<p>åœ¨éœ€è¦ä½¿ç”¨ç±»ä¸Šæ·»åŠ </p>
<pre><code class="language-java">@Autowired
private RedisTemplate&lt;String,String&gt; redisTemplate;

@Autowired
private RedisTemplate&lt;Object,Object&gt; redisTemplate;
</code></pre>
</li>
</ul>
<h2 id="springbooté›†æˆrediså“¨å…µæ¨¡å¼">springbooté›†æˆrediså“¨å…µæ¨¡å¼</h2>
<pre><code class="language-properties">#rediså“¨å…µé…ç½®
spring.redis.password=xx
spring.redis.sentinel.master=mymaster
spring.redis.sentinel.nodes=xxx.xxx.xxx.xxx:26380,xxx.xxx.xxx.xxx:26382.....
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[SpringBootï¼ˆä¸€ï¼‰]]></title>
        <id>https://stormga.github.io/post/springboot-note1/</id>
        <link href="https://stormga.github.io/post/springboot-note1/">
        </link>
        <updated>2020-03-09T10:24:41.000Z</updated>
        <summary type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†ï¼šSpringbootçš„å…¥é—¨ç¨‹åºï¼Œspringbooté…ç½®æ–‡ä»¶ï¼Œæ—¥å¿—æ¨¡å—ï¼Œwebå¼€å‘ï¼Œdockerï¼Œæ•°æ®è®¿é—®ï¼Œå¯åŠ¨åŸç†ï¼Œè‡ªå®šä¹‰starterã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†ï¼šSpringbootçš„å…¥é—¨ç¨‹åºï¼Œspringbooté…ç½®æ–‡ä»¶ï¼Œæ—¥å¿—æ¨¡å—ï¼Œwebå¼€å‘ï¼Œdockerï¼Œæ•°æ®è®¿é—®ï¼Œå¯åŠ¨åŸç†ï¼Œè‡ªå®šä¹‰starterã€‚</p>
<!-- more -->
<h1 id="ä¸€-spring-bootå…¥é—¨">ä¸€ã€Spring Bootå…¥é—¨</h1>
<h2 id="1-spring-bootç®€ä»‹">1ã€Spring Bootç®€ä»‹</h2>
<p>Spring Bootæ˜¯ç”±Pivotalå›¢é˜Ÿæä¾›çš„å…¨æ–°æ¡†æ¶ï¼Œå…¶è®¾è®¡ç›®çš„æ˜¯ç”¨æ¥ç®€åŒ–æ–°Springåº”ç”¨çš„åˆå§‹æ­å»ºä»¥åŠå¼€å‘è¿‡ç¨‹ã€‚è¯¥æ¡†æ¶ä½¿ç”¨äº†ç‰¹å®šçš„æ–¹å¼æ¥è¿›è¡Œé…ç½®ï¼Œä»è€Œä½¿å¼€å‘äººå‘˜ä¸å†éœ€è¦å®šä¹‰æ ·æ¿åŒ–çš„é…ç½®ã€‚</p>
<h2 id="2-å¾®æœåŠ¡">2ã€å¾®æœåŠ¡</h2>
<p>å¾®æœåŠ¡ï¼šæ¶æ„é£æ ¼ï¼ˆæœåŠ¡å¾®åŒ–ï¼‰</p>
<p>ä¸€ä¸ªåº”ç”¨åº”è¯¥æ˜¯ä¸€ç»„å°å‹æœåŠ¡ï¼Œå¯ä»¥é€šè¿‡HTTPçš„æ–¹å¼è¿›è¡Œäº’é€š</p>
<p>å•ä½“åº”ç”¨ï¼šALL IN ONE</p>
<p>å¾®æœåŠ¡ï¼šæ¯ä¸ªåŠŸèƒ½å…ƒç´ æœ€ç»ˆéƒ½æ˜¯ä¸€ä¸ªå¯ä»¥ç‹¬ç«‹æ›¿æ¢å’Œå‡çº§çš„è½¯ä»¶å•å…ƒ</p>
<h2 id="3-ç¯å¢ƒå‡†å¤‡">3ã€ç¯å¢ƒå‡†å¤‡</h2>
<p>ç¯å¢ƒçº¦æŸ</p>
<ul>
<li>jdk1.8</li>
<li>maven 3.x :maven3.3ä»¥ä¸Š</li>
<li>IDEA2017</li>
<li>SpringBoot 1.5.9RELEASE</li>
</ul>
<h3 id="1-mavenè®¾ç½®">1ã€MAVENè®¾ç½®</h3>
<pre><code class="language-xml">&lt;!-- é…ç½®JDKç‰ˆæœ¬ --&gt;
&lt;profile&gt;    
    &lt;id&gt;jdk18&lt;/id&gt;    
    &lt;activation&gt;    
        &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;    
        &lt;jdk&gt;1.8&lt;/jdk&gt;    
    &lt;/activation&gt;    
    &lt;properties&gt;    
        &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;    
        &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;    
        &lt;maven.compiler.compilerVersion&gt;1.8&lt;/maven.compiler.compilerVersion&gt;    
    &lt;/properties&gt;     
&lt;/profile&gt;
   &lt;!-- å½“ nexus-aliyun ä¸‹ä¸äº†çš„åŒ…ï¼Œæˆ–è®¸è¿™ä¸ªé•œåƒèƒ½ä¸‹ï¼Œ
        æ‰å¼€æ”¾å®ƒï¼Œè¿™ä¸ªå®åœ¨å¤ªæ…¢ï¼Œè€Œä¸”è¦æŠŠå®ƒæ”¾åœ¨é¦–ä½ï¼Œå³ nexus-aliyun ä¹‹å‰ï¼Œåšè¿‡æµ‹è¯•ã€‚
        æ‰€ä»¥å®ƒçš„ç”¨é€”åªæœ‰é‚£ä¹ˆä¸€ç¬é—´ï¼Œå°±æ˜¯æˆ–è®¸å®ƒèƒ½ä¸‹è½½ï¼Œå¯ä»¥é€šè¿‡ url å»æŸ¥æ‰¾ç¡®å®šä¸€ä¸‹
    --&gt;
    &lt;!-- &lt;mirror&gt;
        &lt;id&gt;spring-libs-milestone&lt;/id&gt;
        &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
        &lt;name&gt;Spring Milestones&lt;/name&gt;
        &lt;url&gt;http://repo.spring.io/libs-milestone&lt;/url&gt;
    &lt;/mirror&gt; --&gt;

    &lt;!-- nexus-aliyun é¦–é€‰ï¼Œæ”¾ç¬¬ä¸€ä½,æœ‰ä¸èƒ½ä¸‹è½½çš„åŒ…ï¼Œå†å»åšå…¶ä»–é•œåƒçš„é€‰æ‹©  --&gt;
    &lt;mirror&gt;
        &lt;id&gt;nexus-aliyun&lt;/id&gt;
        &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
        &lt;name&gt;Nexus aliyun&lt;/name&gt;
        &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public&lt;/url&gt;
    &lt;/mirror&gt;

    &lt;!-- å¤‡é€‰é•œåƒï¼Œä¹Ÿæ˜¯å¯ä»¥é€šè¿‡ url å»æŸ¥æ‰¾ç¡®å®šä¸€ä¸‹ï¼Œ
        è¯¥é•œåƒæ˜¯å¦å«æœ‰ä½ æƒ³è¦çš„åŒ…ï¼Œå®ƒæ¯” spring-libs-milestone å¿«  --&gt;
    &lt;mirror&gt;
        &lt;id&gt;central-repository&lt;/id&gt;
        &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;
        typor&lt;name&gt;Central Repository&lt;/name&gt;
        &lt;url&gt;http://central.maven.org/maven2/&lt;/url&gt;
    &lt;/mirror&gt;  
</code></pre>
<h3 id="2-ideaè®¾ç½®">2ã€IDEAè®¾ç½®</h3>
<p>â€‹    é…ç½®IDEAçš„Mavenï¼ŒæŒ‡å®šSettingçš„Mavenç›®å½•å’ŒMAVENçš„setting.xmlæ–‡ä»¶</p>
<p>â€‹	å¿«æ·é”®ï¼š</p>
<p>â€‹	Ctrl+D å¤åˆ¶ä¸€è¡Œ</p>
<p>â€‹	Ctrl+Y åˆ é™¤ä¸€è¡Œ</p>
<p>â€‹	Ctrl+P å‚æ•°æç¤º</p>
<p>â€‹	Ctrl+Alt+V è‡ªåŠ¨è¡¥é½æ–¹æ³•</p>
<p>â€‹	Ctrl+N æŸ¥æ‰¾ç±»æ–¹æ³•</p>
<p>â€‹	Alt+Ins æ„é€ å™¨ã€getter/setter toString</p>
<p>â€‹	Ctrl+O é‡è½½æ–¹æ³•æç¤º</p>
<p>â€‹	Alt+Enter æç¤ºå¯¼å…¥ç±»etc</p>
<p>â€‹	Shift+F6 :æ–‡ä»¶é‡å‘½å</p>
<h2 id="4-spring-bootçš„hello-world">4ã€Spring Bootçš„Hello World</h2>
<h3 id="1-åˆ›å»ºä¸€ä¸ªmavenå·¥ç¨‹">1ã€åˆ›å»ºä¸€ä¸ªMavenå·¥ç¨‹</h3>
<h3 id="2-å¯¼å…¥spring-bootçš„ç›¸å…³ä¾èµ–">2ã€å¯¼å…¥Spring Bootçš„ç›¸å…³ä¾èµ–</h3>
<pre><code class="language-xml">&lt;parent&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
    &lt;version&gt;2.0.1.RELEASE&lt;/version&gt;
    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
&lt;/parent&gt;

&lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
    &lt;java.version&gt;1.8&lt;/java.version&gt;
&lt;/properties&gt;

&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;

</code></pre>
<h3 id="3-ç¼–å†™ä¸ªä¸»ç¨‹åº">3ã€ç¼–å†™ä¸ªä¸»ç¨‹åº</h3>
<pre><code class="language-java">@SpringBootApplication
public class SpringBoot01HelloQuickApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringBoot01HelloQuickApplication.class, args);
    }
}
</code></pre>
<h3 id="4-ç¼–å†™ç›¸åº”çš„controllerå’Œservice">4ã€ç¼–å†™ç›¸åº”çš„Controllerå’ŒService</h3>
<pre><code class="language-java">@Controller
public class HelloController {

    @ResponseBody
    @RequestMapping(&quot;/hello&quot;)
    public  String  hello(){
        return &quot;hello world&quot;;
    }
}
</code></pre>
<h3 id="5-è¿è¡Œä¸»ç¨‹åºæµ‹è¯•">5ã€è¿è¡Œä¸»ç¨‹åºæµ‹è¯•</h3>
<p>è®¿é—® localhost:8080/hello</p>
<h3 id="6-ç®€åŒ–éƒ¨ç½²">6ã€ç®€åŒ–éƒ¨ç½²</h3>
<p>åœ¨pom.xmlæ–‡ä»¶ä¸­ï¼Œå¯¼å…¥buildæ’ä»¶</p>
<pre><code class="language-xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;
</code></pre>
<h2 id="5-helloworldæ·±åº¦ç†è§£">5ã€HelloWorldæ·±åº¦ç†è§£</h2>
<h3 id="1pomxmlæ–‡ä»¶">1.POM.xmlæ–‡ä»¶</h3>
<h4 id="1-çˆ¶é¡¹ç›®">1ã€çˆ¶é¡¹ç›®</h4>
<pre><code class="language-xml">&lt;parent&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
    &lt;version&gt;2.0.1.RELEASE&lt;/version&gt;
    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
&lt;/parent&gt;
</code></pre>
<p>è¿™ä¸ªçˆ¶é¡¹ç›®<strong>spring-boot-starter-parent</strong>åˆä¾èµ–ä¸€ä¸ªçˆ¶é¡¹ç›®</p>
<pre><code class="language-xml">&lt;parent&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;
    &lt;version&gt;2.0.1.RELEASE&lt;/version&gt;
    &lt;relativePath&gt;../../spring-boot-dependencies&lt;/relativePath&gt;
&lt;/parent&gt;
</code></pre>
<p>ä¸‹é¢æœ‰ä¸ªå±æ€§ï¼Œå®šä¹‰äº†å¯¹åº”çš„ç‰ˆæœ¬å·</p>
<pre><code class="language-xml">&lt;properties&gt;
    &lt;activemq.version&gt;5.15.3&lt;/activemq.version&gt;
    &lt;antlr2.version&gt;2.7.7&lt;/antlr2.version&gt;
    &lt;appengine-sdk.version&gt;1.9.63&lt;/appengine-sdk.version&gt;
    &lt;artemis.version&gt;2.4.0&lt;/artemis.version&gt;
    &lt;aspectj.version&gt;1.8.13&lt;/aspectj.version&gt;
    &lt;assertj.version&gt;3.9.1&lt;/assertj.version&gt;
    &lt;atomikos.version&gt;4.0.6&lt;/atomikos.version&gt;
    &lt;bitronix.version&gt;2.1.4&lt;/bitronix.version&gt;
    &lt;build-helper-maven-plugin.version&gt;3.0.0&lt;/build-helper-maven-plugin.version&gt;
    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
</code></pre>
<p>Spring Bootçš„ç‰ˆæœ¬ä»²è£ä¸­å¿ƒ ä¼šè‡ªåŠ¨å¯¼å…¥å¯¹åº”çš„ç‰ˆæœ¬ï¼Œä¸éœ€è¦æˆ‘ä»¬è‡ªå·±å¯¼å…¥ä¾èµ–ï¼Œæ²¡æœ‰dependenciesé‡Œé¢ç®¡ç†çš„ä¾èµ–è‡ªå·±å£°æ˜</p>
<h4 id="2-å¯åŠ¨å™¨">2ã€å¯åŠ¨å™¨</h4>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;

</code></pre>
<p>**spring-boot-starter-web:**å¸®æˆ‘ä»¬å¯¼å…¥webæ¨¡å—æ­£å¸¸è¿è¡Œæ‰€ä¾èµ–çš„ç»„ä»¶</p>
<p><strong>spring boot</strong>å°†æ‰€æœ‰çš„åŠŸèƒ½åœºæ™¯éƒ½æŠ½å–å‡ºæ¥ï¼Œåšæˆä¸€ä¸ªä¸ªçš„starter(å¯åŠ¨å™¨)ï¼Œåªéœ€è¦åœ¨é¡¹ç›®é‡Œå¼•å…¥è¿™äº›starterç›¸å…³åœºæ™¯çš„æ‰€æœ‰ä¾èµ–éƒ½ä¼šè¢«å¯¼å…¥è¿›æ¥ï¼Œè¦ç”¨ä»€ä¹ˆåŠŸèƒ½å°±å¯¼å…¥ä»€ä¹ˆåœºæ™¯çš„å¯åŠ¨å™¨ã€‚</p>
<h3 id="2-ä¸»ç¨‹åºå…¥å£">2ã€ä¸»ç¨‹åºå…¥å£</h3>
<pre><code class="language-java">@SpringBootApplication
public class SpringBoot01HelloQuickApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringBoot01HelloQuickApplication.class, args);
    }
}

</code></pre>
<p><strong>@SpringBootApplication:</strong> è¯´æ˜è¿™ä¸ªç±»æ˜¯SpringBootçš„ä¸»é…ç½®ç±»ï¼ŒSpringBootå°±åº”è¯¥è¿è¡Œè¿™ä¸ªç±»çš„mainæ–¹æ³•æ¥å¯åŠ¨åº”ç”¨</p>
<p>è¿›å…¥SpringBootApplicationæ³¨è§£</p>
<pre><code class="language-java">@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Inherited
@SpringBootConfiguration
@EnableAutoConfiguration
@ComponentScan(
    excludeFilters = {@Filter(
    type = FilterType.CUSTOM,
    classes = {TypeExcludeFilter.class}
), @Filter(
    type = FilterType.CUSTOM,
    classes = {AutoConfigurationExcludeFilter.class}
)}
)
public @interface SpringBootApplication {

</code></pre>
<p><strong>@SpringBootConfiguration</strong>ï¼šSpringBootçš„é…ç½®ç±»ï¼š æ ‡å‡†åœ¨æŸä¸ªç±»ä¸Šï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªSpringBootçš„é…ç½®ç±»</p>
<p><strong>@Configuration</strong>:é…ç½®ç±»ä¸Šï¼Œæ¥æ ‡æ³¨è¿™ä¸ªæ³¨è§£ï¼›<br>
é…ç½®ç±» ---- é…ç½®æ–‡ä»¶ï¼Œä¹Ÿæ˜¯å®¹å™¨ä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼ˆ@Componentï¼‰<br>
<strong>@EnableAutoConfiguration</strong>:å¼€å¯è‡ªåŠ¨é…ç½®åŠŸèƒ½<br>
ä»¥å‰éœ€è¦è‡ªåŠ¨é…ç½®çš„ä¸œè¥¿ï¼ŒSpring Bootå¸®æˆ‘ä»¬è‡ªåŠ¨é…ç½®ï¼›@EnableAutoConfigurationå‘Šè¯‰SpringBootå¼€å¯è‡ªåŠ¨<br>
é…ç½®åŠŸèƒ½ï¼›è¿™æ ·è‡ªåŠ¨é…ç½®æ‰èƒ½ç”Ÿæ•ˆã€‚</p>
<pre><code class="language-java">@AutoConfigurationPackage
@Import({AutoConfigurationImportSelector.class})
public @interface EnableAutoConfiguration { 

</code></pre>
<p><strong>@AutoConfigurationPackage</strong>:è‡ªåŠ¨é…ç½®åŒ…<br>
<strong>@Import({Registrar.class})</strong>ï¼šåº•å±‚æ³¨è§£ï¼Œç»™å®¹å™¨å¯¼å…¥ç»„ä»¶ï¼›<br>
å°†ä¸»é…ç½®ç±»ï¼ˆ@SpringBootApplicationæ ‡æ³¨çš„ç±»ï¼‰çš„æ‰€åœ¨åŒ…åŠä¸‹é¢æ‰€æœ‰çš„å­åŒ…é‡Œé¢çš„æ‰€æœ‰ç»„ä»¶æ‰«æåˆ°Springå®¹å™¨ï¼›</p>
<p><strong>@Import({AutoConfigurationImportSelector.class})ï¼š</strong><br>
ç»™å®¹å™¨å¯¼å…¥ç»„ä»¶ï¼Ÿ</p>
<p>AutoConfigurationImportSelectorï¼šå¯¼å…¥ç»„ä»¶é€‰æ‹©å™¨</p>
<p>å°†æ‰€æœ‰éœ€è¦å¯¼å…¥çš„ç»„ä»¶ä»¥åŠå…¨ç±»åçš„æ–¹å¼è¿”å›ï¼›è¿™äº›ç»„ä»¶å°†ä»¥å­—ç¬¦ä¸²æ•°ç»„ String[] æ·»åŠ åˆ°å®¹å™¨ä¸­ï¼›</p>
<p>ä¼šç»™å®¹å™¨éå¸¸å¤šçš„è‡ªåŠ¨é…ç½®ç±»ï¼Œï¼ˆxxxAutoConfigurationï¼‰;å°±æ˜¯ç»™å®¹å™¨ä¸­å¯¼å…¥è¿™ä¸ªåœºæ™¯éœ€è¦çš„æ‰€æœ‰ç»„ä»¶ï¼Œå¹¶é…ç½®<br>
å¥½è¿™äº›ç»„ä»¶ã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://stormga.github.io//post-images/1.configuration.jpg" alt="" loading="lazy"></figure>
<pre><code class="language-java">protected List&lt;String&gt; getCandidateConfigurations(AnnotationMetadata metadata,
AnnotationAttributes attributes) {
	List&lt;String&gt; configurations =
SpringFactoriesLoader.loadFactoryNames(this.getSpringFactoriesLoaderFactoryClass(),
this.getBeanClassLoader());
	Assert.notEmpty(configurations, &quot;No auto configuration classes found in METAâ€INF/spring.factories. If you are using a custom packaging, make sure that file is correct.&quot;);
	return configurations;
} 

</code></pre>
<p><code>SpringFactoriesLoader.loadFactoryNames(this.getSpringFactoriesLoaderFactoryClass(),</code><br>
<code>this.getBeanClassLoader());</code></p>
<p>Spring Bootåœ¨å¯åŠ¨çš„æ—¶å€™ä»ç±»è·¯å¾„ä¸‹çš„META-INF/spring.factorysä¸­è·å–çš„EnableAutoConfigurationæŒ‡å®šçš„å€¼ï¼›</p>
<p>å°†è¿™äº›å€¼ä½œä¸ºè‡ªåŠ¨é…ç½®ç±»å¯¼å…¥åˆ°å®¹å™¨ä¸­ï¼Œè‡ªåŠ¨é…ç½®å°±ç”Ÿæ•ˆäº†ã€‚ <img src="https://stormga.github.io//post-images/2.factories.jpg" alt="" loading="lazy"></p>
<p>J2EEçš„æ•´ä½“è§£å†³æ–¹æ¡ˆ</p>
<p>org\springframework\boot\spring-boot-autoconfigure\2.0.1.RELEASE\spring-boot-autoconfigure-2.0.1.RELEASE.jar</p>
<h2 id="6-ä½¿ç”¨spring-initializeråˆ›å»ºä¸€ä¸ªå¿«é€Ÿå‘å¯¼">6ã€ä½¿ç”¨Spring Initializeråˆ›å»ºä¸€ä¸ªå¿«é€Ÿå‘å¯¼</h2>
<p>1.IDEæ”¯æŒä½¿ç”¨Spring Initializer</p>
<p>è‡ªå·±é€‰æ‹©éœ€è¦çš„ç»„ä»¶:ä¾‹å¦‚web</p>
<p>é»˜è®¤ç”Ÿæˆçš„SpringBooté¡¹ç›®</p>
<ul>
<li>
<p>ä¸»ç¨‹åºå·²ç»ç”Ÿæˆå¥½äº†ï¼Œæˆ‘ä»¬åªéœ€è¦å®Œæˆæˆ‘ä»¬çš„é€»è¾‘</p>
</li>
<li>
<p>resourcesæ–‡ä»¶å¤¹ç›®å½•ç»“æ„</p>
<ul>
<li>
<p>static:ä¿å­˜æ‰€æœ‰çš„é™æ€æ–‡ä»¶ï¼›js css images</p>
</li>
<li>
<p>templates:ä¿å­˜æ‰€æœ‰çš„æ¨¡æ¿é¡µé¢ï¼›ï¼ˆSpring Booté»˜è®¤jaråŒ…ä½¿ç”¨åµŒå…¥å¼çš„Tomcat,é»˜è®¤ä¸æ”¯æŒJSPï¼‰ï¼›å¯</p>
<p>ä»¥ä½¿ç”¨æ¨¡æ¿å¼•æ“ï¼ˆfreemarker.thymeleafï¼‰;</p>
</li>
<li>
<p>application.properties:Spring Bootçš„é»˜è®¤é…ç½®ï¼Œä¾‹å¦‚ server.port=9000</p>
</li>
</ul>
</li>
</ul>
<h1 id="äºŒ-é…ç½®æ–‡ä»¶">äºŒã€é…ç½®æ–‡ä»¶</h1>
<h2 id="1-é…ç½®æ–‡ä»¶">1ã€é…ç½®æ–‡ä»¶</h2>
<p>Spring Bootä½¿ç”¨å…¨å±€é…ç½®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶åæ˜¯å›ºå®šçš„ï¼›</p>
<ul>
<li>application.properties</li>
<li>application.yml</li>
</ul>
<p>é…ç½®æ–‡ä»¶ä½œç”¨ï¼šä¿®æ”¹Spring Bootåœ¨åº•å±‚å°è£…å¥½çš„é»˜è®¤å€¼ï¼›</p>
<p>YAMLï¼ˆYAML AIN'T Markup Languageï¼‰</p>
<p>æ˜¯ä¸€ä¸ªæ ‡è®°è¯­è¨€</p>
<p>åˆä¸æ˜¯ä¸€ä¸ªæ ‡è®°è¯­è¨€</p>
<p><strong>æ ‡è®°è¯­è¨€ï¼š</strong></p>
<p>ä»¥å‰çš„é…ç½®æ–‡ä»¶ï¼›å¤§å¤šæ•°ä½¿ç”¨çš„æ˜¯ xxx.xmlæ–‡ä»¶ï¼›</p>
<p>ä»¥æ•°æ®ä¸ºä¸­å¿ƒï¼Œæ¯”jsonã€xmlç­‰æ›´é€‚åˆåšé…ç½®æ–‡ä»¶</p>
<p>YAMLï¼šé…ç½®ä¾‹å­</p>
<pre><code class="language-yaml">server:
	port: 9000 

</code></pre>
<p>XML:</p>
<pre><code class="language-xml">&lt;server&gt;
	&lt;port&gt;9000&lt;/port&gt;
&lt;/server&gt; 

</code></pre>
<h2 id="2-yamlè¯­æ³•">2ã€YAMLè¯­æ³•</h2>
<h3 id="1-åŸºæœ¬è¯­æ³•">1ã€åŸºæœ¬è¯­æ³•</h3>
<p>k:(ç©ºæ ¼)v:è¡¨ç¤ºä¸€å †é”®å€¼å¯¹ï¼ˆç©ºæ ¼å¿…é¡»æœ‰ï¼‰ï¼›</p>
<p>ä»¥ç©ºæ ¼çš„ç¼©è¿›æ¥æ§åˆ¶å±‚çº§å…³ç³»ï¼›åªè¦æ˜¯å·¦å¯¹é½çš„ä¸€åˆ—æ•°æ®ï¼Œéƒ½æ˜¯åŒä¸€å±‚çº§çš„</p>
<pre><code class="language-yaml">server:
	port: 9000
	path: /hello 

</code></pre>
<p>å±æ€§å’Œå€¼ä¹Ÿæ˜¯å¤§å°å†™æ•æ„Ÿ</p>
<h3 id="2-å€¼çš„å†™æ³•">2ã€å€¼çš„å†™æ³•</h3>
<p><strong>å­—é¢é‡ï¼šæ™®é€šçš„å€¼ï¼ˆæ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œå¸ƒå°”ï¼‰</strong></p>
<p>k: v:å­—é¢ç›´æ¥æ¥å†™ï¼›</p>
<p>å­—ç¬¦ä¸²é»˜è®¤ä¸ç”¨åŠ ä¸Šå•å¼•å·æˆ–è€…åŒå¼•å·</p>
<p>&quot;&quot;:<strong>åŒå¼•å·</strong> ä¸ä¼šè½¬ä¹‰å­—ç¬¦ä¸²é‡Œçš„ç‰¹æ®Šå­—ç¬¦ï¼›ç‰¹æ®Šå­—ç¬¦ä¼šä½œä¸ºæœ¬èº«æƒ³è¦è¡¨ç¤ºçš„æ„æ€</p>
<p><code>name:&quot;zhangsan\n lisi&quot;</code> è¾“å‡ºï¼š<code>zhangsanæ¢è¡Œ lisi</code></p>
<p>'':<strong>å•å¼•å·</strong> ä¼šè½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ï¼Œç‰¹æ®Šå­—ç¬¦æœ€ç»ˆåªæ˜¯ä¸€ä¸ªæ™®é€šçš„å­—ç¬¦ä¸²æ•°æ®</p>
<p><code>name:'zhangsan\n lisi'</code> è¾“å‡ºï¼š<code>zhangsan\n lisi</code></p>
<p><strong>å¯¹è±¡ã€Mapï¼ˆå±æ€§å’Œå€¼ï¼‰é”®å€¼å¯¹</strong></p>
<p>k :v ï¼šåœ¨ä¸‹ä¸€è¡Œæ¥å†™å¯¹è±¡çš„å±æ€§å’Œå€¼çš„å…³ç³»ï¼›æ³¨æ„ç©ºæ ¼æ§åˆ¶ç¼©è¿›</p>
<p>å¯¹è±¡è¿˜æ˜¯k:vçš„æ–¹å¼</p>
<pre><code class="language-yaml">frends:
	lastName: zhangsan
	age: 20 

</code></pre>
<p>è¡Œå†…å†™æ³•</p>
<pre><code class="language-yaml">friends: {lastName: zhangsan,age: 18} 

</code></pre>
<p><strong>æ•°ç»„ï¼ˆListã€Setï¼‰:</strong><br>
ç”¨-è¡¨ç¤ºæ•°ç»„ä¸­çš„ä¸€ä¸ªå…ƒç´ </p>
<pre><code class="language-yaml">pets:
 â€ cat
 â€ dog
 â€ pig 

</code></pre>
<p>è¡Œå†…å†™æ³•</p>
<pre><code class="language-yaml">pets: [cat,dog,pig] 

</code></pre>
<p><strong>ç»„åˆå˜é‡</strong></p>
<p>å¤šä¸ªç»„åˆåˆ°ä¸€èµ·</p>
<h2 id="3-é…ç½®æ–‡ä»¶å€¼æ³¨å…¥">3ã€é…ç½®æ–‡ä»¶å€¼æ³¨å…¥</h2>
<h3 id="1-configurationproperties">1ã€@ConfigurationProperties</h3>
<p>1ã€application.yml é…ç½®æ–‡ä»¶</p>
<pre><code class="language-yaml">person:
  age: 18
  boss: false
  birth: 2017/12/12
  maps: {k1: v1,k2: 12}
  lists:
   - lisi
   - zhaoliu
  dog:
    name: wangwang
    age: 2
  last-name: wanghuahua

</code></pre>
<p><code>application.properties</code> é…ç½®æ–‡ä»¶ï¼ˆäºŒé€‰ä¸€ï¼‰</p>
<pre><code class="language-properties">ideaé…ç½®æ–‡ä»¶utf-8
properties é»˜è®¤GBK
person.age=12
person.boss=false
person.last-name=å¼ ä¸‰
person.maps.k1=v1
person.maps.k2=v2
person.lists=a,b,c
person.dog.name=wanghuahu
person.dog.age=15

</code></pre>
<p>æ‰€ä»¥ä¸­æ–‡è¾“å‡ºä¹±ç ï¼Œæ”¹è¿›settings--&gt;file encoding --&gt;[property--&gt;utf-8 ,å‹¾é€‰è½¬æˆascii]</p>
<p>javaBean</p>
<pre><code class="language-java">/**
* å°†é…ç½®æ–‡ä»¶çš„é…ç½®æ¯ä¸ªå±æ€§çš„å€¼ï¼Œæ˜ å°„åˆ°ç»„ä»¶ä¸­
* @ConfigurationProperties:å‘Šè¯‰SpringBootå°†æ–‡æœ¬çš„æ‰€æœ‰å±æ€§å’Œé…ç½®æ–‡ä»¶ä¸­çš„ç›¸å…³é…ç½®è¿›è¡Œç»‘å®šï¼›
* prefix = &quot;person&quot; é…ç½®æ–‡ä»¶çˆ±ä½ çš„é‚£ä¸ªå±æ€§è¿›è¡Œä¸€ä¸€æ˜ å°„
* *
åªæœ‰è¿™ä¸ªç»„ä»¶æ˜¯å®¹å™¨ä¸­çš„ç»„ä»¶ï¼Œæ‰èƒ½æä¾›åˆ°å®¹å™¨ä¸­
*/
@Component
@ConfigurationProperties(prefix = &quot;person&quot;)
public class Person {
    private String lastName;
    private Integer age;
    private Boolean boss;
    private Map&lt;String,Object&gt; maps;
    private List&lt;Object&gt; lists;
    private Dog dog;

</code></pre>
<p>å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨ï¼Œä»¥åç¼–å†™é…ç½®å°±æœ‰æç¤ºäº†</p>
<pre><code class="language-xml">&lt;dependency&gt;
	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
	&lt;artifactId&gt;springâ€bootâ€configurationâ€processor&lt;/artifactId&gt;
	&lt;optional&gt;true&lt;/optional&gt;
&lt;/dependency&gt; 

</code></pre>
<h3 id="2-valueæ³¨è§£">2ã€@Valueæ³¨è§£</h3>
<p>æ›´æ”¹javaBeanä¸­çš„æ³¨è§£</p>
<pre><code class="language-java">@Component
public class Person {
    /**
     * &lt;bean class=&quot;Person&quot;&gt;
     *     &lt;property name=&quot;lastName&quot; value=&quot;å­—é¢é‡/${key}ä»ç¯å¢ƒå˜é‡/#{spEL}&quot;&gt;&lt;/property&gt;
     * &lt;/bean&gt;
     */
    @Value(&quot;${person.last-name}&quot;)
    private String lastName;
    @Value(&quot;#{11*2}&quot;)
    private Integer age;
    @Value(&quot;true&quot;)
    private Boolean boss;

</code></pre>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">@ConfigurationProperties</th>
<th style="text-align:center">@Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">åŠŸèƒ½</td>
<td style="text-align:center">æ‰¹é‡æ³¨å…¥é…ç½®æ–‡ä»¶å±æ€§</td>
<td style="text-align:center">å•ä¸ªæŒ‡å®š</td>
</tr>
<tr>
<td style="text-align:center">æ¾æ•£ç»‘å®š(è¯­æ³•)</td>
<td style="text-align:center">æ”¯æŒ</td>
<td style="text-align:center">ä¸æ”¯æŒ</td>
</tr>
<tr>
<td style="text-align:center">spEL</td>
<td style="text-align:center">ä¸æ”¯æŒ</td>
<td style="text-align:center">æ”¯æŒ</td>
</tr>
<tr>
<td style="text-align:center">JSR303æ ¡éªŒ</td>
<td style="text-align:center">æ”¯æŒ</td>
<td style="text-align:center">ä¸æ”¯æŒ</td>
</tr>
<tr>
<td style="text-align:center">å¤æ‚ç±»å‹</td>
<td style="text-align:center">æ”¯æŒ</td>
<td style="text-align:center">ä¸æ”¯æŒ</td>
</tr>
</tbody>
</table>
<blockquote>
<p>æ¾æ•£è¯­æ³•ï¼šjavaBeanä¸­last-name(æˆ–è€…lastName) --&gt;application.propertiesä¸­çš„last-name;</p>
<p>spELè¯­æ³•ï¼š#{11*2}</p>
<p>JSR303ï¼š@Valueä¼šç›´æ¥å¿½ç•¥ï¼Œæ ¡éªŒè§„åˆ™</p>
</blockquote>
<p>JSR303æ ¡éªŒï¼š</p>
<pre><code class="language-java">@Component
@ConfigurationProperties(prefix = &quot;person&quot;)
@Validated
public class Person {
    @Email
    private String lastName;

</code></pre>
<p>å¤æ‚ç±»å‹æ —å­ï¼š</p>
<pre><code class="language-java">@Component
public class Person {
    /**
     * &lt;bean class=&quot;Person&quot;&gt;
     *     &lt;property name=&quot;lastName&quot; value=&quot;å­—é¢é‡/${key}ä»ç¯å¢ƒå˜é‡/#{spEL}&quot;&gt;&lt;/property&gt;
     * &lt;/bean&gt;
     */
    private String lastName;
    private Integer age;
    private Boolean boss;
   // @Value(&quot;${person.maps}&quot;)
    private Map&lt;String,Object&gt; maps;

</code></pre>
<p>ä»¥ä¸Šä¼šæŠ¥é”™ï¼Œä¸æ”¯æŒå¤æ‚ç±»å‹</p>
<p><strong>ä½¿ç”¨åœºæ™¯åˆ†æ</strong></p>
<p>â€‹	å¦‚æœè¯´ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨æŸä¸ªä¸šåŠ¡é€»è¾‘ä¸­è·å–ä¸€ä¸‹é…ç½®æ–‡ä»¶çš„æŸä¸€é¡¹å€¼ï¼Œä½¿ç”¨@Valueï¼›</p>
<p>å¦‚æœä¸“é—¨ç¼–å†™äº†ä¸€ä¸ªjavaBeanå’Œé…ç½®æ–‡ä»¶è¿›è¡Œæ˜ å°„ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨@ConfigurationProperties</p>
<p>ä¸¾æ —å­ï¼š</p>
<p>1ã€ç¼–å†™æ–°çš„Controlleræ–‡ä»¶</p>
<pre><code class="language-java">@RestController
public class HelloController {

    @Value(&quot;${person.last-name}&quot;)
    private String name;
    @RequestMapping(&quot;/hello&quot;)
    public  String sayHello(){
        return &quot;Hello&quot;+ name;
    }
}

</code></pre>
<p>2ã€é…ç½®æ–‡ä»¶</p>
<pre><code class="language-properties">person.age=12
person.boss=false
person.last-name=æå››
person.maps.k1=v1
person.maps.k2=v2
person.lists=a,b,c
person.dog.name=wanghuahu
person.dog.age=15

</code></pre>
<p>3ã€æµ‹è¯•è¿è¡Œ</p>
<p>è®¿é—® localhost:9000/hello</p>
<p>ç»“æœä¸º<code>Hello æå››</code></p>
<h3 id="3-å…¶ä»–æ³¨è§£">3ã€å…¶ä»–æ³¨è§£</h3>
<p><strong>@PropertySource</strong></p>
<p>ä½œç”¨ï¼šåŠ è½½æŒ‡å®šçš„propertiesé…ç½®æ–‡ä»¶</p>
<p>1ã€æ–°å»ºä¸€ä¸ªperson.propertiesæ–‡ä»¶</p>
<pre><code class="language-properties">person.age=12
person.boss=false
person.last-name=æå››
person.maps.k1=v1
person.maps.k2=v2
person.lists=a,b,c
person.dog.name=wanghuahu
person.dog.age=15

</code></pre>
<p>2ã€åœ¨javaBeanä¸­åŠ å…¥@PropertySourceæ³¨è§£</p>
<pre><code class="language-java">@PropertySource(value = {&quot;classpath:person.properties&quot;})
@Component
@ConfigurationProperties(prefix = &quot;person&quot;)
public class Person {
    private String lastName;

</code></pre>
<p><strong>@ImportResource</strong></p>
<p>ä½œç”¨ï¼šå¯¼å…¥Springé…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸”è®©è¿™ä¸ªé…ç½®æ–‡ä»¶ç”Ÿæ•ˆ</p>
<p>1ã€æ–°å»ºä¸€ä¸ªSpringçš„é…ç½®æ–‡ä»¶ï¼Œbean.xml</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;

    &lt;bean id=&quot;HelloService&quot; class=&quot;com.wdjr.springboot.service.HelloService&quot;&gt;&lt;/bean&gt;
&lt;/beans&gt;

</code></pre>
<p>2ã€ç¼–å†™æµ‹è¯•ç±»ï¼Œæ£€æŸ¥å®¹å™¨æ˜¯å¦åŠ è½½Springé…ç½®æ–‡ä»¶å†™çš„bean</p>
<pre><code class="language-java">@Autowired
ApplicationContext ioc;

@Test
public void testHelloService(){
    boolean b = ioc.containsBean(&quot;HelloService&quot;);
    System.out.println(b);
}

</code></pre>
<blockquote>
<p>import org.springframework.context.ApplicationContext;</p>
</blockquote>
<p>3ã€è¿è¡Œæ£€æµ‹</p>
<p>ç»“æœä¸ºfalseï¼Œæ²¡æœ‰åŠ è½½é…ç½®çš„å†…å®¹</p>
<p>4ã€ä½¿ç”¨@ImportResourceæ³¨è§£</p>
<p>å°†@ImportResourceæ ‡æ³¨åœ¨ä¸»é…ç½®ç±»ä¸Š</p>
<pre><code class="language-java">@ImportResource(locations={&quot;classpath:beans.xml&quot;})
@SpringBootApplication
public class SpringBoot02ConfigApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringBoot02ConfigApplication.class, args);
    }
}

</code></pre>
<p>5ã€å†æ¬¡è¿è¡Œæ£€æµ‹</p>
<p>ç»“æœä¸ºtrue</p>
<p>ç¼ºç‚¹ï¼šæ¯æ¬¡æŒ‡å®šxmlæ–‡ä»¶å¤ªéº»çƒ¦</p>
<p>SpringBootæ¨èç»™å®¹å™¨æ·»åŠ ç»„ä»¶çš„æ–¹å¼ï¼š</p>
<p>1ã€é…ç½®ç±»=====Springçš„xmlé…ç½®æ–‡ä»¶ï¼ˆoldï¼‰</p>
<p>2ã€å…¨æ³¨è§£æ–¹å¼@Configuration+@Beanï¼ˆnewï¼‰</p>
<figure data-type="image" tabindex="2"><img src="https://stormga.github.io//post-images/4.MyAppConfig.jpg" alt="" loading="lazy"></figure>
<pre><code class="language-java">/**
 * @Configurationï¼šæŒ‡æ˜å½“å‰ç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼›å°±æ˜¯æ¥ä»£æ›¿ä¹‹å‰çš„Springé…ç½®æ–‡ä»¶
 *
 * åœ¨é…ç½®æ–‡ä»¶ä¸­ç”¨&lt;bean&gt;&lt;/bean&gt;æ ‡ç­¾æ·»åŠ ç»„ä»¶
 */

@Configuration
public class MyAppConfig {

    //å°†æ–¹æ³•çš„è¿”å›å€¼æ·»åŠ åˆ°å®¹å™¨ä¸­ï¼›å®¹å™¨è¿™ä¸ªç»„ä»¶idå°±æ˜¯æ–¹æ³•å
    @Bean
    public HelloService helloService01(){
        System.out.println(&quot;é…ç½®ç±»ç»™å®¹å™¨æ·»åŠ äº†HelloServiceç»„ä»¶&quot;);
        return new HelloService();
    }
}

</code></pre>
<pre><code class="language-java">@Autowired
ApplicationContext ioc;

@Test
public void testHelloService(){
    boolean b = ioc.containsBean(&quot;helloService01&quot;);
    System.out.println(b);
}

</code></pre>
<p><em>å®¹å™¨è¿™ä¸ªç»„ä»¶idå°±æ˜¯æ–¹æ³•å</em></p>
<h2 id="4-é…ç½®æ–‡ä»¶å ä½ç¬¦">4ã€é…ç½®æ–‡ä»¶å ä½ç¬¦</h2>
<h4 id="1-éšæœºæ•°">1ã€éšæœºæ•°</h4>
<pre><code class="language-properties">${random.value} ã€${random.int}ã€${random.long}
${random.int(10)}ã€${random.int[100,200]}

</code></pre>
<h4 id="2-è·å–é…ç½®å€¼">2ã€è·å–é…ç½®å€¼</h4>
<pre><code class="language-properties">person.age=${random.int}
person.boss=false
person.last-name=å¼ ä¸‰${random.uuid}
person.maps.k1=v1
person.maps.k2=v2
person.lists=a,b,c
person.dog.name=${person.last-name}'s wanghuahu
person.dog.age=15

</code></pre>
<p>å­˜åœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µ</p>
<p>æ²¡æœ‰å£°æ˜<code>person.last-name</code>ä¼šæŠ¥é”™ï¼Œæ–°å£°æ˜çš„éœ€è¦åŠ é»˜è®¤å€¼</p>
<pre><code class="language-properties">person.age=${random.int}
person.boss=false
person.last-name=å¼ ä¸‰${random.uuid}
person.maps.k1=v1
person.maps.k2=v2
person.lists=a,b,c
person.dog.name=${person.hello:hello}'s wanghuahu
person.dog.age=15

</code></pre>
<p>ç»“æœï¼šè¾“å‡º<code>hello's wanghuahua</code></p>
<h2 id="5-profile">5ã€Profile</h2>
<h3 id="1-å¤šprofileæ–‡ä»¶">1ã€å¤šProfileæ–‡ä»¶</h3>
<p>æˆ‘ä»¬åœ¨ä¸»é…ç½®æ–‡ä»¶ç¼–å†™çš„æ—¶å€™ï¼Œæ–‡ä»¶åå¯ä»¥æ˜¯ application-{profile}.properties/yml</p>
<ul>
<li>application.properties</li>
<li>application-dev.properties</li>
<li>application-prod.properties</li>
</ul>
<p>é»˜è®¤ä½¿ç”¨application.properties</p>
<p>application.propertiesé…ç½®æ–‡ä»¶æŒ‡å®š</p>
<pre><code class="language-properties">spring.profiles.active=dev

</code></pre>
<h3 id="2-yamlæ–‡æ¡£å—">2ã€YAMLæ–‡æ¡£å—</h3>
<pre><code class="language-yaml">server:
  port: 8081
spring:
  profiles:
    active: dev

---

server:
  port: 9000
spring:
  profiles: dev

---
server:
  port: 80
spring:
  profiles: prod


</code></pre>
<h3 id="3-æ¿€æ´»æŒ‡å®šprofile">3ã€æ¿€æ´»æŒ‡å®šprofile</h3>
<p>1ã€åœ¨é…ç½®æ–‡ä»¶ä¸­æ¿€æ´»</p>
<p>2ã€å‘½ä»¤è¡Œï¼š</p>
<p>--spring.profiles.active=dev</p>
<figure data-type="image" tabindex="3"><img src="https://stormga.github.io//post-images/5.comandLine.jpg" alt="" loading="lazy"></figure>
<p>ä¼˜å…ˆçº§å¤§äºé…ç½®æ–‡ä»¶</p>
<p>æ‰“åŒ… æˆjarå</p>
<p><code>java -jar spring-boot-02-config-0.0.1-SNAPSHOT.jar --spring.profiles.active=dev</code></p>
<p>è™šæ‹Ÿæœºå‚æ•°</p>
<p><code>-Dspring.profiles.active=dev</code></p>
<h2 id="6-åŠ è½½é…ç½®æ–‡ä»¶ä½ç½®">6ã€åŠ è½½é…ç½®æ–‡ä»¶ä½ç½®</h2>
<p>SpringBootå¯åŠ¨æ‰«æä»¥ä¸‹ä½ç½®çš„application.propertiesæˆ–è€…application.ymlæ–‡ä»¶ä½œä¸ºSpring bootçš„é»˜è®¤é…ç½®æ–‡ä»¶</p>
<ul>
<li>file:./config/</li>
<li>file./</li>
<li>classpath:/config/</li>
<li>classpath:/</li>
</ul>
<p>ä¼˜å…ˆçº§ä»é«˜åˆ°ä½é¡ºåºï¼Œé«˜ä¼˜å…ˆçº§ä¼šè¦†ç›–ä½ä¼˜å…ˆçº§çš„ç›¸åŒé…ç½®ï¼›äº’è¡¥é…ç½®</p>
<p>ä¹Ÿå¯ä»¥é€šè¿‡spring.config.locationæ¥æ”¹å˜é»˜è®¤é…ç½®</p>
<blockquote>
<pre><code>server.servlet.context-path=/boot03

</code></pre>
</blockquote>
<p>æ³¨ï¼šspring boot1x æ˜¯server.context.path=/boot02</p>
<figure data-type="image" tabindex="4"><img src="https://stormga.github.io//post-images/7.priority.jpg" alt="" loading="lazy"></figure>
<p>è¿˜å¯ä»¥é€šè¿‡spring.config.locationæ¥æ”¹å˜é…ç½®æ–‡ä»¶çš„ä½ç½®</p>
<p>é¡¹ç›®æ‰“åŒ…å¥½äº†ä»¥åï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°çš„å½¢å¼ï¼Œå¯åŠ¨é¡¹ç›®çš„æ—¶å€™æ¥æŒ‡å®šé…ç½®æ–‡ä»¶çš„æ–°ä½ç½®ï¼›æŒ‡å®šé…ç½®æ–‡ä»¶å’Œé»˜è®¤çš„é…ç½®æ–‡ä»¶ä¼šå…±åŒèµ·ä½œç”¨ï¼Œäº’è¡¥é…ç½®</p>
<p><code>java -jar spring-boot-config-02-0.0.1-SNAPSHOT.jar --spring.config.location=E:/work/application.properties</code></p>
<p>è¿ç»´æ¯”è¾ƒæœ‰ç”¨ï¼Œä»å¤–éƒ¨åŠ è½½ï¼Œä¸ç”¨ä¿®æ”¹åˆ«çš„æ–‡ä»¶</p>
<h2 id="7å¼•å…¥å¤–éƒ¨é…ç½®">7.å¼•å…¥å¤–éƒ¨é…ç½®</h2>
<p><strong>SpringBootä¹Ÿå¯ä»¥ä»ä»¥ä¸‹ä½ç½®åŠ è½½é…ç½®ï¼›ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼›é«˜ä¼˜å…ˆçº§è¦†ç›–ä½ä¼˜å…ˆçº§ï¼Œå¯ä»¥äº’è¡¥</strong></p>
<ol>
<li>
<p>å‘½ä»¤è¡Œå‚æ•°</p>
<p>java -jar spring-boot-config-02-0.0.1-SNAPSHOT.jar --server.port=9005 --server.context-path=/abc</p>
<p>ä¸­é—´ä¸€ä¸ªç©ºæ ¼</p>
</li>
<li>
<p>æ¥è‡ªjava:comp/envçš„JNDIå±æ€§</p>
</li>
<li>
<p>javaç³»ç»Ÿå±æ€§ï¼ˆSystem.getProperties()ï¼‰</p>
</li>
<li>
<p>æ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡</p>
</li>
<li>
<p>RandomValuePropertySourceé…ç½®çš„random.*å±æ€§å€¼</p>
<p><strong>ä¼˜å…ˆåŠ è½½profile,    ç”±jaråŒ…å¤–åˆ°jaråŒ…å†…</strong></p>
</li>
<li>
<p><strong>jaråŒ…å¤–éƒ¨çš„application-{profile}.propertiesæˆ–application.yml(å¸¦Spring.profile)é…ç½®æ–‡ä»¶</strong></p>
</li>
<li>
<p><strong>jaråŒ…å†…éƒ¨çš„application-{profile}.propertiesæˆ–application.yml(å¸¦Spring.profile)é…ç½®æ–‡ä»¶</strong></p>
</li>
<li>
<p><strong>jaråŒ…å¤–éƒ¨çš„application.propertiesæˆ–application.yml(å¸¦Spring.profile)é…ç½®æ–‡ä»¶</strong></p>
</li>
<li>
<p><strong>jaråŒ…å†…éƒ¨çš„application.propertiesæˆ–application.yml(ä¸å¸¦spring.profile)é…ç½®æ–‡ä»¶</strong></p>
</li>
<li>
<p>@Configurationæ³¨è§£ç±»çš„@PropertySource</p>
</li>
<li>
<p>é€šè¿‡SpringApplication.setDefaultPropertiesæŒ‡å®šçš„é»˜è®¤å±æ€§</p>
</li>
</ol>
<p><a href="https://docs.spring.io/spring-boot/docs/2.0.1.RELEASE/reference/htmlsingle/#boot-features-external-config">å®˜æ–¹æ–‡æ¡£</a></p>
<h2 id="8-è‡ªåŠ¨é…ç½®">8ã€è‡ªåŠ¨é…ç½®</h2>
<p>é…ç½®æ–‡ä»¶åˆ°åº•æ€ä¹ˆå†™ï¼Ÿ</p>
<p><a href="https://docs.spring.io/spring-boot/docs/2.0.1.RELEASE/reference/htmlsingle/#common-application-properties">Springçš„æ‰€æœ‰é…ç½®å‚æ•°</a></p>
<p>è‡ªåŠ¨é…ç½®åŸç†å¾ˆå…³é”®</p>
<h3 id="1-è‡ªåŠ¨é…ç½®åŸç†">1ã€è‡ªåŠ¨é…ç½®åŸç†</h3>
<p>1ï¼‰ã€SpringBootå¯åŠ¨çš„æ—¶å€™åŠ è½½ä¸»é…ç½®ç±»ï¼Œå¼€å¯è‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼Œ@EnableAutoConfiguration</p>
<p>2ï¼‰ã€@EnableAutoConfiguration ä½œç”¨ï¼š</p>
<ul>
<li>åˆ©ç”¨AutoConfigurationImportSelectorç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€äº›ç»„ä»¶ï¼Ÿ</li>
<li>å¯ä»¥æŸ¥çœ‹selectImports()æ–¹æ³•çš„å†…å®¹</li>
<li>è·å–å€™é€‰çš„é…ç½®</li>
</ul>
<pre><code class="language-java">List&lt;String&gt; configurations = this.getCandidateConfigurations(annotationMetadata, attributes);

</code></pre>
<ul>
<li>æ‰«æç±»è·¯å¾„ä¸‹çš„</li>
</ul>
<pre><code class="language-java">  SpringFactoriesLoader.loadFactoryNames(ï¼‰
  æ‰«ææ‰€æœ‰jaråŒ…ç±»è·¯å¾„ä¸‹çš„ MATA-INF/spring.factories
  æŠŠæ‰«æåˆ°çš„è¿™äº›æ–‡ä»¶çš„å†…å®¹åŒ…è£…æˆpropertieså¯¹è±¡
  ä»propertiesä¸­è·å–åˆ°EnableAutoConfiguration.classç±»ï¼ˆç±»åï¼‰å¯¹åº”çš„å€¼ï¼Œç„¶åæŠŠä»–ä»¬æ·»åŠ åˆ°å®¹å™¨ä¸­

</code></pre>
<p>å°†ç±»è·¯å¾„ä¸‹ MATE-INF/spring.factoriesé‡Œé¢é…ç½®çš„æ‰€æœ‰çš„EnableAutoConfigurationçš„å€¼åŠ å…¥åˆ°äº†å®¹å™¨ä¸­ï¼›</p>
<p>3ï¼‰ã€æ¯ä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±»è¿›è¡Œè‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼›</p>
<p>4ï¼‰ã€ä»¥<strong>HttpEncodingAutoConfiguration</strong> ä¸ºä¾‹</p>
<pre><code class="language-java">@Configuration //è¡¨ç¤ºæ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œä»¥å‰ç¼–å†™çš„é…ç½®æ–‡ä»¶ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶
@EnableConfigurationProperties({HttpEncodingProperties.class})//å¯åŠ¨æŒ‡å®šç±»çš„ConfigurationpropertiesåŠŸèƒ½ï¼›å°†é…ç½®æ–‡ä»¶ä¸­çš„å€¼å’ŒHttpEncodingPropertiesç»‘å®šèµ·æ¥äº†ï¼›å¹¶æŠŠHttpEncodingPropertiesåŠ å…¥iocå®¹å™¨ä¸­
@ConditionalOnWebApplication//æ ¹æ®ä¸åŒçš„æ¡ä»¶ï¼Œè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œæ•´ä¸ªé…ç½®ç±»é‡Œé¢çš„é…ç½®å°±ä¼šå¤±æ•ˆï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºwebåº”ç”¨ï¼›
(
    type = Type.SERVLET
)
@ConditionalOnClass({CharacterEncodingFilter.class})//åˆ¤æ–­å½“å‰é¡¹ç›®æœ‰æ²¡æœ‰è¿™ä¸ªç±»ï¼Œè§£å†³ä¹±ç çš„è¿‡æ»¤å™¨
@ConditionalOnProperty(
    prefix = &quot;spring.http.encoding&quot;,
    value = {&quot;enabled&quot;},
    matchIfMissing = true
)//åˆ¤æ–­é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨æŸä¸ªé…ç½® spring.http.encodingï¼ŒmatchIfMissing = trueå¦‚æœä¸å­˜åœ¨ä¹Ÿæ˜¯æˆç«‹ï¼Œå³ä½¿ä¸é…ç½®ä¹Ÿç”Ÿæ•ˆ
public class HttpEncodingAutoConfiguration {
   //ç»™å®¹å™¨æ·»åŠ ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶çš„å€¼éœ€è¦ä»propertieså±æ€§ä¸­è·å–
    private final HttpEncodingProperties properties;
	//åªæœ‰ä¸€ä¸ªæœ‰å‚æ•°æ„é€ å™¨æƒ…å†µä¸‹ï¼Œå‚æ•°çš„å€¼å°±ä¼šä»å®¹å™¨ä¸­æ‹¿
    public HttpEncodingAutoConfiguration(HttpEncodingProperties properties) {
        this.properties = properties;
    }

    @Bean
    @ConditionalOnMissingBean
    public CharacterEncodingFilter characterEncodingFilter() {
        CharacterEncodingFilter filter = new OrderedCharacterEncodingFilter();
        filter.setEncoding(this.properties.getCharset().name());
        filter.setForceRequestEncoding(this.properties.shouldForce(org.springframework.boot.autoconfigure.http.HttpEncodingProperties.Type.REQUEST));
        filter.setForceResponseEncoding(this.properties.shouldForce(org.springframework.boot.autoconfigure.http.HttpEncodingProperties.Type.RESPONSE));
        return filter;
    }


</code></pre>
<p>5ï¼‰ã€æ‰€æœ‰åœ¨é…ç½®æ–‡ä»¶ä¸­èƒ½é…ç½®çš„å±æ€§éƒ½æ˜¯åœ¨xxxPropertiesç±»ä¸­å°è£…ç€ï¼›é…ç½®æ–‡ä»¶èƒ½é…ç½®ä»€ä¹ˆå°±å¯ä»¥å‚ç…§æŸä¸ªåŠŸèƒ½å¯¹åº”çš„è¿™ä¸ªå±æ€§ç±»</p>
<pre><code class="language-java">@ConfigurationProperties(prefix = &quot;spring.http.encoding&quot;)//ä»é…ç½®æ–‡ä»¶ä¸­çš„å€¼è¿›è¡Œç»‘å®šå’Œbeanå±æ€§è¿›è¡Œç»‘å®š
public class HttpEncodingProperties {

</code></pre>
<p>æ ¹æ®å½“å‰ä¸åŒæ¡ä»¶åˆ¤æ–­ï¼Œå†³å®šè¿™ä¸ªé…ç½®ç±»æ˜¯å¦ç”Ÿæ•ˆï¼Ÿ</p>
<p>ä¸€æ—¦è¿™ä¸ªé…ç½®ç±»ç”Ÿæ•ˆï¼›è¿™ä¸ªé…ç½®ç±»ä¼šç»™å®¹å™¨æ·»åŠ å„ç§ç»„ä»¶ï¼›è¿™äº›ç»„ä»¶çš„å±æ€§æ˜¯ä»å¯¹åº”çš„propertiesä¸­è·å–çš„ï¼Œè¿™äº›ç±»é‡Œé¢çš„æ¯ä¸ªå±æ€§åˆæ˜¯å’Œé…ç½®æ–‡ä»¶ç»‘å®šçš„</p>
<h3 id="2-æ‰€æœ‰çš„è‡ªåŠ¨é…ç½®ç»„ä»¶">2ã€æ‰€æœ‰çš„è‡ªåŠ¨é…ç½®ç»„ä»¶</h3>
<p>æ¯ä¸€ä¸ªxxxAutoConfigurationè¿™æ ·çš„ç±»éƒ½æ˜¯å®¹å™¨ä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼Œéƒ½åŠ å…¥åˆ°å®¹å™¨ä¸­ï¼›</p>
<p>ä½œç”¨ï¼šç”¨ä»–ä»¬åšè‡ªåŠ¨é…ç½®</p>
<pre><code class="language-properties"># Auto Configure
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\
org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\
org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\
org.springframework.boot.autoconfigure.batch.BatchAutoConfiguration,\
org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration,\
org.springframework.boot.autoconfigure.cassandra.CassandraAutoConfiguration,\
org.springframework.boot.autoconfigure.cloud.CloudAutoConfiguration,\
org.springframework.boot.autoconfigure.context.ConfigurationPropertiesAutoConfiguration,\
org.springframework.boot.autoconfigure.context.MessageSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration,\
org.springframework.boot.autoconfigure.couchbase.CouchbaseAutoConfiguration,\
org.springframework.boot.autoconfigure.dao.PersistenceExceptionTranslationAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraReactiveDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraReactiveRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseReactiveDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseReactiveRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.ldap.LdapDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.ldap.LdapRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoReactiveDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoReactiveRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.neo4j.Neo4jDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.neo4j.Neo4jRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.solr.SolrRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisReactiveAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.rest.RepositoryRestMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration,\
org.springframework.boot.autoconfigure.elasticsearch.jest.JestAutoConfiguration,\
org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration,\
org.springframework.boot.autoconfigure.freemarker.FreeMarkerAutoConfiguration,\
org.springframework.boot.autoconfigure.gson.GsonAutoConfiguration,\
org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration,\
org.springframework.boot.autoconfigure.hateoas.HypermediaAutoConfiguration,\
org.springframework.boot.autoconfigure.hazelcast.HazelcastAutoConfiguration,\
org.springframework.boot.autoconfigure.hazelcast.HazelcastJpaDependencyAutoConfiguration,\
org.springframework.boot.autoconfigure.http.HttpMessageConvertersAutoConfiguration,\
org.springframework.boot.autoconfigure.http.codec.CodecsAutoConfiguration,\
org.springframework.boot.autoconfigure.influx.InfluxDbAutoConfiguration,\
org.springframework.boot.autoconfigure.info.ProjectInfoAutoConfiguration,\
org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration,\
org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.JndiDataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.XADataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.JmsAutoConfiguration,\
org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.JndiConnectionFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.activemq.ActiveMQAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.artemis.ArtemisAutoConfiguration,\
org.springframework.boot.autoconfigure.groovy.template.GroovyTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.jersey.JerseyAutoConfiguration,\
org.springframework.boot.autoconfigure.jooq.JooqAutoConfiguration,\
org.springframework.boot.autoconfigure.jsonb.JsonbAutoConfiguration,\
org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration,\
org.springframework.boot.autoconfigure.ldap.embedded.EmbeddedLdapAutoConfiguration,\
org.springframework.boot.autoconfigure.ldap.LdapAutoConfiguration,\
org.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration,\
org.springframework.boot.autoconfigure.mail.MailSenderAutoConfiguration,\
org.springframework.boot.autoconfigure.mail.MailSenderValidatorAutoConfiguration,\
org.springframework.boot.autoconfigure.mongo.embedded.EmbeddedMongoAutoConfiguration,\
org.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration,\
org.springframework.boot.autoconfigure.mongo.MongoReactiveAutoConfiguration,\
org.springframework.boot.autoconfigure.mustache.MustacheAutoConfiguration,\
org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration,\
org.springframework.boot.autoconfigure.quartz.QuartzAutoConfiguration,\
org.springframework.boot.autoconfigure.reactor.core.ReactorCoreAutoConfiguration,\
org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,\
org.springframework.boot.autoconfigure.security.servlet.UserDetailsServiceAutoConfiguration,\
org.springframework.boot.autoconfigure.security.servlet.SecurityFilterAutoConfiguration,\
org.springframework.boot.autoconfigure.security.reactive.ReactiveSecurityAutoConfiguration,\
org.springframework.boot.autoconfigure.security.reactive.ReactiveUserDetailsServiceAutoConfiguration,\
org.springframework.boot.autoconfigure.sendgrid.SendGridAutoConfiguration,\
org.springframework.boot.autoconfigure.session.SessionAutoConfiguration,\
org.springframework.boot.autoconfigure.security.oauth2.client.OAuth2ClientAutoConfiguration,\
org.springframework.boot.autoconfigure.solr.SolrAutoConfiguration,\
org.springframework.boot.autoconfigure.thymeleaf.ThymeleafAutoConfiguration,\
org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration,\
org.springframework.boot.autoconfigure.transaction.jta.JtaAutoConfiguration,\
org.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration,\
org.springframework.boot.autoconfigure.web.client.RestTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.web.embedded.EmbeddedWebServerFactoryCustomizerAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.HttpHandlerAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.ReactiveWebServerFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.WebFluxAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.error.ErrorWebFluxAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.function.client.WebClientAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.DispatcherServletAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.ServletWebServerFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.HttpEncodingAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.MultipartAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.websocket.reactive.WebSocketReactiveAutoConfiguration,\
org.springframework.boot.autoconfigure.websocket.servlet.WebSocketServletAutoConfiguration,\
org.springframework.boot.autoconfigure.websocket.servlet.WebSocketMessagingAutoConfiguration,\
org.springframework.boot.autoconfigure.webservices.WebServicesAutoConfiguration


</code></pre>
<h3 id="3-ç²¾é«“">3ã€ç²¾é«“ï¼š</h3>
<p>1ï¼‰ã€SpringBootå¯åŠ¨ä¼šåŠ è½½å¤§é‡çš„è‡ªåŠ¨é…ç½®ç±»</p>
<p>2ï¼‰ã€æˆ‘ä»¬çœ‹æˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½æœ‰æ²¡æœ‰SpringBooté»˜è®¤å†™å¥½çš„é»˜è®¤é…ç½®ç±»ï¼›</p>
<p>3ï¼‰ã€å¦‚æœæœ‰åœ¨çœ‹è¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»ä¸­é…ç½®äº†å“ªäº›ç»„ä»¶ï¼›ï¼ˆåªè¦æˆ‘ä»¬è¦ç”¨çš„ç»„ä»¶æœ‰ï¼Œæˆ‘ä»¬éœ€è¦å†æ¥é…ç½®ï¼‰</p>
<p>4ï¼‰ã€ç»™å®¹å™¨ä¸­è‡ªåŠ¨é…ç½®æ·»åŠ ç»„ä»¶çš„æ—¶å€™ï¼Œä¼šä»propertiesç±»ä¸­è·å–å±æ€§ã€‚æˆ‘ä»¬å°±å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šè¿™äº›å±æ€§çš„å€¼</p>
<p>xxxAutoConfiguration:è‡ªåŠ¨é…ç½®ç±»ï¼›</p>
<p>ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶</p>
<p>xxxProperties:å°è£…é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§ï¼›</p>
<p>è·Ÿä¹‹å‰çš„Personç±»ä¸€æ ·ï¼Œé…ç½®æ–‡ä»¶ä¸­å€¼åŠ å…¥beanä¸­</p>
<h3 id="4-ç»†èŠ‚">4ã€ç»†èŠ‚</h3>
<h4 id="1-conditionalæ´¾ç”Ÿæ³¨è§£">1ã€@Conditionalæ´¾ç”Ÿæ³¨è§£</h4>
<blockquote>
<p>åˆ©ç”¨Springæ³¨è§£ç‰ˆåŸç”Ÿçš„@Conditionalä½œç”¨</p>
</blockquote>
<p>ä½œç”¨ï¼šå¿…é¡»æ˜¯@ConditionalæŒ‡å®šçš„æ¡ä»¶æˆç«‹ï¼Œæ‰ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶ï¼Œé…ç½®é…é‡Œé¢çš„æ‰€æœ‰å†…å®¹æ‰ç”Ÿæ•ˆï¼›</p>
<table>
<thead>
<tr>
<th>@Conditionalæ´¾ç”Ÿæ³¨è§£</th>
<th>ä½œç”¨ï¼ˆåˆ¤æ–­æ˜¯å¦æ»¡è¶³å½“å‰æŒ‡å®šæ¡ä»¶ï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>@ConditionalOnJava</td>
<td>ç³»ç»Ÿçš„javaç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚</td>
</tr>
<tr>
<td>@ConditionalOnBean</td>
<td>å®¹å™¨ä¸­å­˜åœ¨æŒ‡å®šBean</td>
</tr>
<tr>
<td>@ConditionalOnMissBean</td>
<td>å®¹å™¨ä¸­ä¸å­˜åœ¨æŒ‡å®šBean</td>
</tr>
<tr>
<td>@ConditionalOnExpression</td>
<td>æ»¡è¶³spELè¡¨è¾¾å¼</td>
</tr>
<tr>
<td>@ConditionalOnClass</td>
<td>ç³»ç»Ÿä¸­æœ‰æŒ‡å®šçš„ç±»</td>
</tr>
<tr>
<td>@ConditionalOnMissClass</td>
<td>ç³»ç»Ÿä¸­æ²¡æœ‰æŒ‡å®šçš„ç±»</td>
</tr>
<tr>
<td>@ConditionalOnSingleCandidate</td>
<td>å®¹å™¨ä¸­åªæœ‰ä¸€ä¸ªæŒ‡å®šçš„Bean,æˆ–è€…è¿™ä¸ªBeanæ˜¯é¦–é€‰Bean</td>
</tr>
<tr>
<td>@ConditionalOnProperty</td>
<td>ç³»ç»Ÿä¸­æŒ‡å®šçš„å±æ€§æ˜¯å¦æœ‰æŒ‡å®šçš„å€¼</td>
</tr>
<tr>
<td>@ConditionalOnResource</td>
<td>ç±»è·¯å¾„ä¸‹æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„èµ„æºæ–‡ä»¶</td>
</tr>
<tr>
<td>@ConditionalOnWebApplication</td>
<td>å½“å‰æ˜¯webç¯å¢ƒ</td>
</tr>
<tr>
<td>@ConditionalOnNotWebApplication</td>
<td>å½“å‰ä¸æ˜¯webç¯å¢ƒ</td>
</tr>
<tr>
<td>@ConditionalOnJndi</td>
<td>JNDIå­˜åœ¨æŒ‡å®šé¡¹</td>
</tr>
</tbody>
</table>
<h4 id="2-è‡ªåŠ¨é…ç½®æŠ¥å‘Š">2ã€è‡ªåŠ¨é…ç½®æŠ¥å‘Š</h4>
<p>è‡ªåŠ¨é…ç½®ç±»å¿…é¡»åœ¨ä¸€å®šæ¡ä»¶ä¸‹ç”Ÿæ•ˆ</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯ç”¨debug=trueå±æ€§ï¼Œé…ç½®æ–‡ä»¶ï¼Œæ‰“å°è‡ªåŠ¨é…åˆæŠ¥å‘Šï¼Œè¿™æ ·å°±å¯ä»¥çŸ¥é“è‡ªåŠ¨é…ç½®ç±»ç”Ÿæ•ˆ</p>
<pre><code class="language-properties">debug=true

</code></pre>
<p>è‡ªåŠ¨é…ç½®æŠ¥å‘Š</p>
<pre><code class="language-java">============================

CONDITIONS EVALUATION REPORT
============================


Positive matches:ï¼ˆå¯åŠ¨çš„ï¼ŒåŒ¹é…æˆåŠŸçš„ï¼‰
-----------------

   CodecsAutoConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.http.codec.CodecConfigurer'; @ConditionalOnMissingClass did not find unwanted class (OnClassCondition)
        ......
        
 Negative matches:ï¼ˆæ²¡æœ‰å¯åŠ¨çš„ï¼Œæ²¡æœ‰åŒ¹é…æˆåŠŸçš„ï¼‰
-----------------

   ActiveMQAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required classes 'javax.jms.ConnectionFactory', 'org.apache.activemq.ActiveMQConnectionFactory' (OnClassCondition)
.....

</code></pre>
<h1 id="ä¸‰-æ—¥å¿—">ä¸‰ã€æ—¥å¿—</h1>
<blockquote>
<p>Spring Boot2å¯¹æ—¥å¿—æœ‰æ›´æ”¹</p>
</blockquote>
<h3 id="1-æ—¥å¿—æ¡†æ¶">1ã€æ—¥å¿—æ¡†æ¶</h3>
<p>å°å¼ ï¼šå¼€å‘ä¸€ä¸ªå¤§å‹ç³»ç»Ÿï¼›</p>
<p>1ã€System.out.println(&quot;&quot;);å°†å…³é”®æ•°æ®æ‰“å°åœ¨æ§åˆ¶å°ï¼›å»æ‰ï¼Ÿå¸è½½æ–‡ä»¶ä¸­</p>
<p>2ã€æ¡†æ¶è®°å½•ç³»ç»Ÿçš„ä¸€äº›è¿è¡Œä¿¡æ¯ï¼›æ—¥å¿—æ¡†æ¶zhanglog.jar</p>
<p>3ã€é«˜å¤§ä¸ŠåŠŸèƒ½ï¼Œå¼‚æ­¥æ¨¡å¼ï¼Ÿè‡ªåŠ¨å½’æ¡£ï¼Ÿxxx?zhanglog-good.jar?</p>
<p>4ã€å°†ä»¥å‰çš„æ¡†æ¶å¸ä¸‹æ¥ï¼Ÿæ¢ä¸Šæ–°çš„æ¡†æ¶ï¼Œé‡æ–°ä¿®æ”¹ä¹‹å‰çš„ç›¸å…³API;zhanglog-perfect.jar;</p>
<p>5ã€JDBC--æ•°æ®åº“é©±åŠ¨ï¼›</p>
<p>â€‹	å†™äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£å±‚ï¼›æ—¥å¿—é—¨é¢ï¼ˆæ—¥å¿—çš„ä¸€ä¸ªæŠ½è±¡å±‚ï¼‰ï¼›logging-abstract.jar;</p>
<p>â€‹	ç»™é¡¹ç›®ä¸­å¯¼å…¥å…·ä½“çš„æ—¥å¿—å®ç°å°±è¡Œï¼›æˆ‘ä»¬ä¹‹å‰çš„æ—¥å¿—æ¡†æ¶éƒ½æ˜¯å®ç°çš„æŠ½è±¡å±‚ï¼›</p>
<p>å¸‚é¢ä¸Šçš„æ—¥å¿—æ¡†æ¶</p>
<table>
<thead>
<tr>
<th>æ—¥å¿—æŠ½è±¡å±‚</th>
<th>æ—¥å¿—å®ç°</th>
</tr>
</thead>
<tbody>
<tr>
<td><s>JCL(Jakarta Commons Logging)</s> SLF4j(Simple Logging Facade for Java) <s>jboss-logging</s></td>
<td>Log4j <s>JUL(java.util.logging)</s> Log4j2 Logback</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>å·¦è¾¹çš„æŠ½è±¡ï¼Œå³è¾¹çš„å®ç°</p>
<p>SLF4J  -- Logback</p>
<p>Spring Boot:åº•å±‚æ˜¯Springæ¡†æ¶ï¼ŒSpringé»˜è®¤æ¡†æ¶æ˜¯JCLï¼›</p>
<p>â€‹	SpringBooté€‰ç”¨SLF4Jå’Œlogback</p>
<h3 id="2-slf4jä½¿ç”¨">2ã€SLF4Jä½¿ç”¨</h3>
<h4 id="1-å¦‚ä½•åœ¨ç³»ç»Ÿä¸­ä½¿ç”¨slf4j">1ã€å¦‚ä½•åœ¨ç³»ç»Ÿä¸­ä½¿ç”¨SLF4j</h4>
<p>ä»¥åå¼€å‘çš„æ—¶å€™ï¼Œæ—¥å¿—è®°å½•æ–¹æ³•çš„è°ƒç”¨ï¼Œä¸åº”è¯¥æ¥ç›´æ¥è°ƒç”¨æ—¥å¿—çš„å®ç°ç±»ï¼Œè€Œæ˜¯è°ƒç”¨æ—¥å¿—æŠ½è±¡å±‚é‡Œé¢çš„æ–¹æ³•ï¼›</p>
<p>åº”è¯¥ç»™ç³»ç»Ÿé‡Œé¢å¯¼å…¥slf4jçš„jaråŒ…å’Œlogbackçš„å®ç°jar</p>
<pre><code class="language-java">import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class HelloWorld {
  public static void main(String[] args) {
    Logger logger = LoggerFactory.getLogger(HelloWorld.class);
    logger.info(&quot;Hello World&quot;);
  }
}

</code></pre>
<figure data-type="image" tabindex="5"><img src="https://stormga.github.io//post-images/8.slf4j.jpg" alt="" loading="lazy"></figure>
<p>æ¯ä¸ªæ—¥å¿—æ¡†æ¶çš„å®ç°æ¡†æ¶éƒ½æœ‰è‡ªå·±çš„é…ç½®æ–‡ä»¶ã€‚ä½¿ç”¨slf4jä»¥åï¼Œ<strong>é…ç½®æ–‡ä»¶è¿˜æ˜¯åšæˆæ—¥å¿—å®ç°æ¡†æ¶æœ¬èº«çš„é…ç½®æ–‡ä»¶</strong>ï¼›</p>
<h4 id="2-é—ç•™é—®é¢˜">2ã€é—ç•™é—®é¢˜</h4>
<p>aç³»ç»Ÿ(slf4j+logback)ï¼šSpringï¼ˆcommons-loggingï¼‰ã€Hibernateï¼ˆjboss-loggingï¼‰ã€Mybatis</p>
<p>ç»Ÿä¸€æ—¥å¿—æ¡†æ¶ï¼Œå³ä½¿æ˜¯åˆ«çš„æ¡†æ¶å’Œæˆ‘ä¸€èµ·ç»Ÿä¸€ä½¿ç”¨slf4jè¿›è¡Œè¾“å‡ºï¼›</p>
<p>æ ¸å¿ƒï¼š</p>
<p>1ã€å°†ç³»ç»Ÿä¸­å…¶ä»–æ—¥å¿—æ¡†æ¶æ’é™¤å‡ºå»ï¼›</p>
<p>2ã€ç”¨ä¸­é—´åŒ…æ¥æ›¿æ¢åŸæœ‰çš„æ—¥å¿—æ¡†æ¶</p>
<p>3ã€å¯¼å…¥slf4jçš„å…¶ä»–å®ç°</p>
<h3 id="3-spingbootæ—¥å¿—æ¡†æ¶è§£æ">3ã€SpingBootæ—¥å¿—æ¡†æ¶è§£æ</h3>
<p>æ‰“å¼€IDEA ï¼Œæ‰“å¼€pomæ–‡ä»¶çš„ä¾èµ–å›¾å½¢åŒ–æ˜¾ç¤º</p>
<figure data-type="image" tabindex="6"><img src="https://stormga.github.io//post-images/9.IDEAdependencies.jpg" alt="" loading="lazy"></figure>
<p>SpringBootçš„åŸºç¡€æ¡†æ¶</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;

</code></pre>
<p>SpringBootçš„æ—¥å¿—åŠŸèƒ½</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;
    &lt;version&gt;2.0.1.RELEASE&lt;/version&gt;
    &lt;scope&gt;compile&lt;/scope&gt;
&lt;/dependency&gt;

</code></pre>
<figure data-type="image" tabindex="7"><img src="https://stormga.github.io//post-images/10.slf4jandlogback.jpg" alt="" loading="lazy"></figure>
<p>æ€»ç»“ï¼š</p>
<ol>
<li>
<p>SpringBootåº•å±‚ä¹Ÿæ˜¯ä½¿ç”¨SLF4J+log4jback</p>
</li>
<li>
<p>SpringBootä¹ŸæŠŠå…¶ä»–æ—¥å¿—æ›¿æ¢æˆäº†slf4j</p>
</li>
<li>
<p>èµ·ç€commons.loggingsçš„åå­—å…¶å®newçš„SLF4Jæ›¿æ¢ä¸­é—´åŒ…</p>
<p>SpringBoot2ä¸­æ”¹æˆäº†bridge</p>
</li>
<li>
<p>å¦‚æœè¦å¼•å…¥å…¶ä»–æ¡†æ¶ï¼Ÿä¸€å®šè¦æŠŠè¿™ä¸ªæ¡†æ¶çš„æ—¥å¿—ä¾èµ–ç§»é™¤æ‰ï¼Œè€Œä¸”åº•å±‚</p>
</li>
</ol>
<h3 id="4-æ—¥å¿—çš„ä½¿ç”¨">4ã€æ—¥å¿—çš„ä½¿ç”¨</h3>
<h4 id="1-é»˜è®¤é…ç½®">1ã€é»˜è®¤é…ç½®</h4>
<p>trace-debug-info-warn-error</p>
<p>å¯ä»¥è°ƒæ•´éœ€è¦çš„æ—¥å¿—çº§åˆ«è¿›è¡Œè¾“å‡ºï¼Œä¸ç”¨æ³¨é‡Šè¯­å¥ã€‚</p>
<pre><code class="language-java">//è®°å½•å™¨
Logger logger = LoggerFactory.getLogger(getClass());
@Test
public void contextLoads() {

    //æ—¥å¿—çš„çº§åˆ«
    //ä»ä½åˆ°é«˜
    //å¯ä»¥è°ƒæ•´è¾“å‡ºçš„æ—¥å¿—çº§åˆ«ï¼›æ—¥å¿—å°±åªä¼šåœ¨è¿™ä¸ªçº§åˆ«ä»¥åçš„é«˜çº§åˆ«ç”Ÿæ•ˆ
    logger.trace(&quot;è¿™æ˜¯traceæ—¥å¿—&quot;);
    logger.debug(&quot;è¿™æ˜¯debugä¿¡æ¯&quot;);
    //SpringBooté»˜è®¤ç»™çš„æ˜¯infoçº§åˆ«ï¼Œå¦‚æœæ²¡æŒ‡å®šå°±æ˜¯é»˜è®¤çš„rootçº§åˆ«
    logger.info(&quot;è¿™æ˜¯infoæ—¥å¿—&quot;);
    logger.warn(&quot;è¿™æ˜¯warnä¿¡æ¯&quot;);
    logger.error(&quot;è¿™æ˜¯Errorä¿¡æ¯&quot;);
}

</code></pre>
<p>è°ƒæ•´æŒ‡å®šåŒ…çš„æ—¥å¿—çº§åˆ«åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®</p>
<pre><code class="language-properties">logging.level.cn.lkhcoding=trace

</code></pre>
<p>æ—¥å¿—è¾“å‡ºæ ¼å¼</p>
<pre><code class="language-properties">#æ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—æ ¼å¼ 
#%dï¼šæ—¥æœŸ
#%threadï¼šçº¿ç¨‹å· 
#%-5levelï¼šé å·¦ çº§åˆ« 
#%logger{50}ï¼šå…¨ç±»å50å­—ç¬¦é™åˆ¶,å¦åˆ™æŒ‰ç…§å¥å·åˆ†å‰²
#%msgï¼šæ¶ˆæ¯+æ¢è¡Œ
#%nï¼šæ¢è¡Œ
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n

</code></pre>
<p>SpringBootä¿®æ”¹æ—¥å¿—çš„é»˜è®¤é…ç½®</p>
<pre><code class="language-properties">logging.level.com.wdjr=trace
#ä¸æŒ‡å®špathå°±æ˜¯å½“å‰ç›®å½•ä¸‹ç”Ÿæˆspringboot.log
#logging.file=springboot.log
#å½“å‰ç£ç›˜ä¸‹æ ¹è·¯å¾„åˆ›å»ºspringæ–‡ä»¶ä¸­logæ–‡ä»¶å¤¹ï¼Œä½¿ç”¨spring.logä½œä¸ºé»˜è®¤
logging.path=/spring/log
#æ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—æ ¼å¼ æ—¥æœŸ + çº¿ç¨‹å· + é å·¦ çº§åˆ« +å…¨ç±»å50å­—ç¬¦é™åˆ¶+æ¶ˆæ¯+æ¢è¡Œ
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n
#æŒ‡å®šæ–‡ä»¶ä¸­æ—¥å¿—è¾“å‡ºçš„æ ¼å¼
logging.pattern.file=xxx

</code></pre>
<h4 id="2-æŒ‡å®šé…ç½®">2ã€æŒ‡å®šé…ç½®</h4>
<p>ç»™ç±»è·¯å¾„ä¸‹æ”¾ä¸Šæ¯ä¸ªæ—¥å¿—æ¡†æ¶è‡ªå·±çš„é…ç½®æ¡†æ¶ï¼›SpringBootå°±ä¸ä¼šä½¿ç”¨è‡ªå·±é»˜è®¤çš„é…ç½®</p>
<table>
<thead>
<tr>
<th>logging System</th>
<th>Customization</th>
</tr>
</thead>
<tbody>
<tr>
<td>Logback</td>
<td>logback-spring.xml ,logback-spring.groovy,logback.xml or logback.groovy</td>
</tr>
<tr>
<td>Log4J2</td>
<td>log4j2-spring.xml or log4j2.xml</td>
</tr>
<tr>
<td>JDK(Java Util Logging)</td>
<td>logging.properties</td>
</tr>
</tbody>
</table>
<p>logback.xmlç›´æ¥è¢«æ—¥å¿—æ¡†æ¶è¯†åˆ« ï¼Œlogback-spring.xmlæ—¥å¿—æ¡†æ¶å°±ä¸ç›´æ¥åŠ è½½æ—¥å¿—é…ç½®é¡¹ï¼Œç”±SpringBootåŠ è½½</p>
<pre><code class="language-xml">&lt;springProfile name=&quot;dev&quot;&gt;
	&lt;!-- å¯ä»¥æŒ‡å®šæŸæ®µé…ç½®åªåœ¨æŸä¸ªç¯å¢ƒä¸‹ç”Ÿæ•ˆ --&gt;
&lt;/springProfile&gt;
&lt;springProfile name!=&quot;dev&quot;&gt;
	&lt;!-- å¯ä»¥æŒ‡å®šæŸæ®µé…ç½®åªåœ¨æŸä¸ªç¯å¢ƒä¸‹ç”Ÿæ•ˆ --&gt;
&lt;/springProfile&gt;

</code></pre>
<p>å¦‚ä½•è°ƒè¯•å¼€å‘ç¯å¢ƒ,è¾“å…¥å‘½ä»¤è¡Œå‚æ•°</p>
<p>--spring.profiles.active=dev</p>
<p>å¦‚æœä¸å¸¦åé¢çš„xx-spring.xmlå°±ä¼šæŠ¥é”™</p>
<h3 id="3-åˆ‡æ¢æ—¥å¿—æ¡†æ¶">3ã€åˆ‡æ¢æ—¥å¿—æ¡†æ¶</h3>
<p>å¯ä»¥æ ¹æ®slf4jçš„æ—¥å¿—é€‚é…å›¾ï¼Œè¿›è¡Œç›¸å…³åˆ‡æ¢ï¼›</p>
<h4 id="1-log4j">1ã€log4j</h4>
<p>slf4j+log4jçš„æ–¹å¼ï¼›</p>
<figure data-type="image" tabindex="8"><img src="https://stormga.github.io//post-images/11.log4j.jpg" alt="" loading="lazy"></figure>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
    &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
&lt;/dependency&gt;

</code></pre>
<p>ä¸æ¨èä½¿ç”¨ä»…ä½œä¸ºæ¼”ç¤º</p>
<h4 id="2-log4j2">2ã€log4j2</h4>
<p>åˆ‡æ¢ä¸ºlog4j2</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-log4j2&lt;/artifactId&gt;
&lt;/dependency&gt;

</code></pre>
<h1 id="å››-webå¼€å‘">å››ã€webå¼€å‘</h1>
<h2 id="1-ç®€ä»‹">1ã€ç®€ä»‹</h2>
<p>ä½¿ç”¨SpringBoot;</p>
<p>1)ã€åˆ›å»ºSpringBootåº”ç”¨ï¼Œé€‰ä¸­æˆ‘ä»¬éœ€è¦çš„æ¨¡å—ï¼›</p>
<p>2)ã€SpringBootå·²ç»é»˜è®¤å°†è¿™äº›åœºæ™¯é…ç½®å¥½äº†ï¼Œåªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šå°‘é‡é…ç½®å°±å¯ä»¥è¿è¡Œèµ·æ¥</p>
<p>3)ã€è‡ªå·±ç¼–å†™ä¸šåŠ¡ä»£ç </p>
<p><strong>è‡ªåŠ¨é…ç½®åŸç†ï¼Ÿ</strong></p>
<p>è¿™ä¸ªåœºæ™¯çš„SpringBootå¸®æˆ‘ä»¬é…ç½®äº†ä»€ä¹ˆï¼Ÿèƒ½ä¸èƒ½ä¿®æ”¹ï¼Ÿèƒ½ä¿®æ”¹é‚£äº›é…ç½®ï¼Ÿèƒ½ä¸èƒ½æ‰©å±•ï¼Ÿxxx</p>
<pre><code class="language-java">xxxAutoConfiguration:å¸®æˆ‘ä»¬ç»™å®¹å™¨ä¸­è‡ªåŠ¨é…ç½®ç»„ä»¶
xxxProperties:é…ç½®ç±»æ¥å°è£…é…ç½®æ–‡ä»¶çš„å†…å®¹

</code></pre>
<h2 id="2-é™æ€èµ„æºæ–‡ä»¶æ˜ å°„è§„åˆ™">2ã€é™æ€èµ„æºæ–‡ä»¶æ˜ å°„è§„åˆ™</h2>
<pre><code class="language-java">@ConfigurationProperties(prefix = &quot;spring.resources&quot;, ignoreUnknownFields = false)
public class ResourceProperties implements ResourceLoaderAware, InitializingBean {
    //å¯ä»¥è®¾ç½®å’Œé™æ€èµ„æºç›¸å…³çš„å‚æ•°ï¼Œç¼“å­˜æ—¶é—´ç­‰

</code></pre>
<pre><code class="language-java">@Override
public void addResourceHandlers(ResourceHandlerRegistry registry) {
   if (!this.resourceProperties.isAddMappings()) {
      logger.debug(&quot;Default resource handling disabled&quot;);
      return;
   }
   Integer cachePeriod = this.resourceProperties.getCachePeriod();
   if (!registry.hasMappingForPattern(&quot;/webjars/**&quot;)) {
      customizeResourceHandlerRegistration(registry
            .addResourceHandler(&quot;/webjars/**&quot;)
            .addResourceLocations(&quot;classpath:/META-INF/resources/webjars/&quot;)
            .setCachePeriod(cachePeriod));
   }
   String staticPathPattern = this.mvcProperties.getStaticPathPattern();
   if (!registry.hasMappingForPattern(staticPathPattern)) {
      customizeResourceHandlerRegistration(
            registry.addResourceHandler(staticPathPattern)
                  .addResourceLocations(
                        this.resourceProperties.getStaticLocations())
                  .setCachePeriod(cachePeriod));
   }
}

</code></pre>
<h3 id="1-webjar">1ã€webjar</h3>
<p>1)ã€æ‰€æœ‰çš„/webjars/**ï¼Œéƒ½å»classpath:/META-INF/resources/webjars/æ‰¾èµ„æºï¼›</p>
<p>â€‹	webjarsï¼šä»¥jaråŒ…çš„æ–¹å¼å¼•å…¥é™æ€èµ„æº</p>
<p>http://www.webjars.org/</p>
<figure data-type="image" tabindex="9"><img src="https://stormga.github.io//post-images/12.jquery.jpg" alt="" loading="lazy"></figure>
<p>localhost:8080/webjars/jquery/3.3.1/jquery.js</p>
<h3 id="2-æœ¬åœ°èµ„æº">2ã€æœ¬åœ°èµ„æº</h3>
<pre><code>private String staticPathPattern = &quot;/**&quot;;

</code></pre>
<p>è®¿é—®ä»»ä½•èµ„æº</p>
<p>2ã€ä¼šåœ¨è¿™å‡ æ–‡ä»¶å¤¹ä¸‹å»æ‰¾é™æ€è·¯å¾„ï¼ˆé™æ€èµ„æºæ–‡ä»¶å¤¹ï¼‰</p>
<pre><code>&quot;classpath:/META-INF/resources/&quot;, 
&quot;classpath:/resources/&quot;,
&quot;classpath:/static/&quot;, 
&quot;classpath:/public/&quot;,
&quot;/&quot;;å½“å‰é¡¹ç›®çš„æ ¹è·¯å¾„

</code></pre>
<figure data-type="image" tabindex="10"><img src="https://stormga.github.io//post-images/13.static.jpg" alt="" loading="lazy"></figure>
<p>localhost:8080/abc ==&gt;å»é™æ€èµ„æºæ–‡ä»¶å¤¹ä¸­æ‰¾abc</p>
<figure data-type="image" tabindex="11"><img src="https://stormga.github.io//post-images/14.static-css.jpg" alt="" loading="lazy"></figure>
<p>3ã€indexé¡µé¢æ¬¢è¿é¡µï¼Œé™æ€èµ„æºæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰çš„index.htmlé¡µé¢ï¼›è¢«â€œ/**â€æ˜ å°„ï¼›</p>
<p>localhost:8080/  --&gt;indexé¡µé¢</p>
<pre><code class="language-JAVA">@Bean
public WelcomePageHandlerMapping welcomePageHandlerMapping(
      ResourceProperties resourceProperties) {
   return new WelcomePageHandlerMapping(resourceProperties.getWelcomePage(),
         this.mvcProperties.getStaticPathPattern());
}

</code></pre>
<p>4ã€å–œæ¬¢çš„å›¾æ ‡ï¼Œå³ç½‘ç«™titleçš„å›¾æ ‡favicon</p>
<pre><code class="language-java">@Configuration
@ConditionalOnProperty(value = &quot;spring.mvc.favicon.enabled&quot;, matchIfMissing = true)
public static class FaviconConfiguration {

   private final ResourceProperties resourceProperties;

   public FaviconConfiguration(ResourceProperties resourceProperties) {
      this.resourceProperties = resourceProperties;
   }

   @Bean
   public SimpleUrlHandlerMapping faviconHandlerMapping() {
      SimpleUrlHandlerMapping mapping = new SimpleUrlHandlerMapping();
      mapping.setOrder(Ordered.HIGHEST_PRECEDENCE + 1);
       //æŠŠä»»ä½•faviconçš„å›¾æ ‡éƒ½åœ¨é™æ€æ–‡ä»¶å¤¹ä¸‹æ‰¾
      mapping.setUrlMap(Collections.singletonMap(&quot;**/favicon.ico&quot;,
            faviconRequestHandler()));
      return mapping;
   }

   @Bean
   public ResourceHttpRequestHandler faviconRequestHandler() {
      ResourceHttpRequestHandler requestHandler = new ResourceHttpRequestHandler();
      requestHandler
            .setLocations(this.resourceProperties.getFaviconLocations());
      return requestHandler;
   }

}

</code></pre>
<p>å¯ä»¥åœ¨é…ç½®æ–‡ä»¶é…ç½®é™æ€èµ„æºæ–‡ä»¶å¤¹</p>
<pre><code class="language-properties">spring.resources.static-locations=classpath:xxxx

</code></pre>
<h2 id="3-æ¨¡æ¿å¼•æ“">3ã€æ¨¡æ¿å¼•æ“</h2>
<p>å°†htmlå’Œæ•°æ® ç»“åˆåˆ°ä¸€èµ· è¾“å‡ºç»„è£…å¤„ç†å¥½çš„æ–°æ–‡ä»¶</p>
<p>SpringBootæ¨èThymeleaf;è¯­æ³•ç®€å•ï¼ŒåŠŸèƒ½å¼ºå¤§</p>
<h3 id="1-å¼•å…¥thymeleaf-3">1ã€å¼•å…¥thymeleaf 3</h3>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;
&lt;/dependency&gt;

</code></pre>
<p>é»˜è®¤å¯¼å…¥thymeleaf2ï¼Œç‰ˆæœ¬å¤ªä½ æ‰€ä»¥ä½¿ç”¨thymeleaf3.</p>
<p><a href="https://docs.spring.io/spring-boot/docs/1.5.12.RELEASE/reference/htmlsingle/#howto-use-thymeleaf-3">å®˜æ–¹å¯¼å…¥åŠæ³•</a></p>
<pre><code class="language-xml">&lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
    &lt;java.version&gt;1.8&lt;/java.version&gt;
    &lt;!--thymeleaf 3çš„å¯¼å…¥--&gt;
    &lt;thymeleaf.version&gt;3.0.9.RELEASE&lt;/thymeleaf.version&gt;
    &lt;!--å¸ƒå±€åŠŸèƒ½æ”¯æŒ åŒæ—¶æ”¯æŒthymeleaf3ä¸»ç¨‹åº layout2.0ä»¥ä¸Šç‰ˆæœ¬  --&gt;
    &lt;!--å¸ƒå±€åŠŸèƒ½æ”¯æŒ åŒæ—¶æ”¯æŒthymeleaf2ä¸»ç¨‹åº layout1.0ä»¥ä¸Šç‰ˆæœ¬  --&gt;
    &lt;thymeleaf-layout-dialect.version&gt;2.2.2&lt;/thymeleaf-layout-dialect.version&gt;
&lt;/properties&gt;

</code></pre>
<h3 id="2-thymeleafä½¿ç”¨å’Œè¯­æ³•">2ã€Thymeleafä½¿ç”¨å’Œè¯­æ³•</h3>
<pre><code class="language-java">@ConfigurationProperties(prefix = &quot;spring.thymeleaf&quot;)
public class ThymeleafProperties {

   private static final Charset DEFAULT_ENCODING = Charset.forName(&quot;UTF-8&quot;);

   private static final MimeType DEFAULT_CONTENT_TYPE = MimeType.valueOf(&quot;text/html&quot;);

   public static final String DEFAULT_PREFIX = &quot;classpath:/templates/&quot;;

   public static final String DEFAULT_SUFFIX = &quot;.html&quot;;
   //åªè¦æŠŠHTMLæ–‡ä»¶æ–¹æ³•ç±»è·¯å¾„ä¸‹çš„templateæ–‡ä»¶å¤¹ä¸‹ï¼Œå°±ä¼šè‡ªåŠ¨å¯¼å…¥

</code></pre>
<p>åªè¦æŠŠHTMLé¡µé¢æ”¾åˆ°classpath:/templates/,thymeleafå°±èƒ½è‡ªåŠ¨æ¸²æŸ“ï¼›</p>
<p>ä½¿ç”¨ï¼š</p>
<p>1ã€å¯¼å…¥thymeleafçš„åç§°ç©ºé—´</p>
<pre><code class="language-html">&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;    

</code></pre>
<p>2ã€ä½¿ç”¨thymeleafè¯­æ³•ï¼›</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;  xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot; /&gt;
    &lt;title&gt;success&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;success&lt;/h1&gt;
&lt;!--th:text å°†divé‡Œé¢çš„æ–‡æœ¬å†…å®¹è®¾ç½®ä¸º--&gt;
&lt;div th:text=&quot;${Lion}&quot;&gt;
å‰ç«¯æ•°æ®
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;

</code></pre>
<p>3ã€è¯­æ³•è§„åˆ™</p>
<p>1ï¼‰ã€th:text=&quot;${hello}&quot;å¯ä»¥ä½¿ç”¨ä»»æ„æ ‡ç­¾ æ›¿æ¢åŸç”Ÿçš„ä»»ä½•å±æ€§</p>
<p><strong>åœ¨SpringBootçš„ç¯å¢ƒä¸‹</strong></p>
<pre><code class="language-html">&lt;div id=&quot;testid&quot; class=&quot;testcalss&quot; th:id=&quot;${Lion}&quot; th:class=&quot;${Lion}&quot; th:text=&quot;${Lion}&quot;&gt;
	å‰ç«¯æ•°æ®
&lt;/div&gt;

</code></pre>
<figure data-type="image" tabindex="12"><img src="https://stormga.github.io//post-images/15.thtmeleaf-th01.jpg" alt="" loading="lazy"></figure>
<p><strong>ç›´æ¥è®¿é—®HTMLé¡µé¢</strong></p>
<figure data-type="image" tabindex="13"><img src="https://stormga.github.io//post-images/15.thtmeleaf-th02.jpg" alt="" loading="lazy"></figure>
<p><strong>2)ã€å†…è”å†™æ³•æ³¨æ„éœ€è¦åœ¨bodyä¸ŠåŠ ä¸Š th:inline=&quot;text&quot;æ•²é»‘æ¿</strong></p>
<p>ä¸ç„¶ä¸èµ·ä½œç”¨</p>
<pre><code class="language-html">&lt;body class=&quot;text-center&quot; th:inline=&quot;text&quot;&gt;&lt;/body&gt;

</code></pre>
<p>thæ ‡ç­¾çš„è®¿é—®ä¼˜å…ˆçº§</p>
<p>Order Feature Attributes</p>
<h3 id="3-è¯­æ³•è§„åˆ™">3ã€è¯­æ³•è§„åˆ™</h3>
<table>
<thead>
<tr>
<th></th>
<th>åŠŸèƒ½</th>
<th>æ ‡ç­¾</th>
<th>åŠŸèƒ½å’Œjspå¯¹æ¯”</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Fragment inclusion</td>
<td>th:insert th:replace</td>
<td>include(ç‰‡æ®µåŒ…å«)</td>
</tr>
<tr>
<td>2</td>
<td>Fragment iteration</td>
<td>th:each</td>
<td>c:forEach(éå†)</td>
</tr>
<tr>
<td>3</td>
<td>Conditional evaluation</td>
<td>th:if th:unless th:switch th:case</td>
<td>c:if(æ¡ä»¶åˆ¤æ–­)</td>
</tr>
<tr>
<td>4</td>
<td>Local variable definition</td>
<td>th:object  th:with</td>
<td>c:set(å£°æ˜å˜é‡)</td>
</tr>
<tr>
<td>5</td>
<td>General attribute modification</td>
<td>th:attr th:attrprepend th:attrappend</td>
<td>å±æ€§ä¿®æ”¹æ”¯æŒå‰é¢å’Œåé¢è¿½åŠ å†…å®¹</td>
</tr>
<tr>
<td>6</td>
<td>Specific attribute modification</td>
<td>th:value th:href th:src ...</td>
<td>ä¿®æ”¹ä»»æ„å±æ€§å€¼</td>
</tr>
<tr>
<td>7</td>
<td>Text (tag body modification)</td>
<td>th:text th:utext</td>
<td>ä¿®æ”¹æ ‡ç­¾ä½“å†…å®¹utextï¼šä¸è½¬ä¹‰å­—ç¬¦<h1>å¤§æ ‡é¢˜</td>
</tr>
<tr>
<td>8</td>
<td>Fragment specification</td>
<td>th:fragment</td>
<td>å£°æ˜ç‰‡æ®µ</td>
</tr>
<tr>
<td>9</td>
<td>Fragment removal</td>
<td>th:remove</td>
<td></td>
</tr>
</tbody>
</table>
<pre><code class="language-properties">Simple expressions:(è¡¨è¾¾å¼è¯­æ³•)
    Variable Expressions: ${...}
    	1ã€è·å–å¯¹è±¡å±æ€§ã€è°ƒç”¨æ–¹æ³•
    	2ã€ä½¿ç”¨å†…ç½®åŸºæœ¬å¯¹è±¡ï¼š
    	    #ctx : the context object.
            #vars: the context variables.
            #locale : the context locale.
            #request : (only in Web Contexts) the HttpServletRequest object.
            #response : (only in Web Contexts) the HttpServletResponse object.
            #session : (only in Web Contexts) the HttpSession object.
            #servletContext : (only in Web Contexts) the ServletContext object.
         3ã€å†…ç½®ä¸€äº›å·¥å…·å¯¹è±¡
        	#execInfo : information about the template being processed.
        	#messages : methods for obtaining externalized messages inside variables expressions, in the same way as they
            would be obtained using #{â€¦} syntax.
            #uris : methods for escaping parts of URLs/URIs
            #conversions : methods for executing the configured conversion service (if any).
            #dates : methods for java.util.Date objects: formatting, component extraction, etc.
            #calendars : analogous to #dates , but for java.util.Calendar objects.
            #numbers : methods for formatting numeric objects.
            #strings : methods for String objects: contains, startsWith, prepending/appending, etc.
            #objects : methods for objects in general.
            #bools : methods for boolean evaluation.
            #arrays : methods for arrays.
            #lists : methods for lists.
            #sets : methods for sets.
            #maps : methods for maps.
            #aggregates : methods for creating aggregates on arrays or collections.
            #ids : methods for dealing with id attributes that might be repeated (for example, as a result of an iteration).
    Selection Variable Expressions: *{...} //é€‰æ‹©è¡¨è¾¾å¼ï¼šå’Œ${}åŠŸèƒ½ä¸€æ ·ï¼Œè¡¥å……åŠŸèƒ½
   # é…åˆth:objectä½¿ç”¨ï¼Œobject=${object} ä»¥åè·å–å°±å¯ä»¥ä½¿ç”¨*{a}  ç›¸å½“äº${object.a}
  	    &lt;div th:object=&quot;${session.user}&quot;&gt;
            &lt;p&gt;Name: &lt;span th:text=&quot;*{firstName}&quot;&gt;Sebastian&lt;/span&gt;.&lt;/p&gt;
            &lt;p&gt;Surname: &lt;span th:text=&quot;*{lastName}&quot;&gt;Pepper&lt;/span&gt;.&lt;/p&gt;
            &lt;p&gt;Nationality: &lt;span th:text=&quot;*{nationality}&quot;&gt;Saturn&lt;/span&gt;.&lt;/p&gt;
		&lt;/div&gt;
    Message Expressions: #{...} //è·å–å›½é™…åŒ–å†…å®¹
    Link URL Expressions: @{...} //å®šä¹‰URLé“¾æ¥
    	#&lt;a href=&quot;details.html&quot; th:href=&quot;@{/order/details(orderId=${o.id})}&quot;&gt;view&lt;/a&gt;
    Fragment Expressions: ~{...}//ç‰‡æ®µæ–‡æ¡£
    
Literalsï¼ˆå­—é¢é‡ï¼‰
    Text literals: 'one text' , 'Another one!' ,â€¦
    Number literals: 0 , 34 , 3.0 , 12.3 ,â€¦
    Boolean literals: true , false
    Null literal: null
    Literal tokens: one , sometext , main ,â€¦
Text operations:(æ–‡æœ¬æ“ä½œ)
    String concatenation: +
    Literal substitutions: |The name is ${name}|
Arithmetic operations:ï¼ˆæ•°å­¦è¿ç®—ï¼‰
    Binary operators: + , - , * , / , %
    Minus sign (unary operator): -
Boolean operations:ï¼ˆå¸ƒå°”è¿ç®—ï¼‰
    Binary operators: and , or
    Boolean negation (unary operator): ! , not
Comparisons and equality:ï¼ˆæ¯”è¾ƒè¿ç®—ï¼‰
    Comparators: &gt; , &lt; , &gt;= , &lt;= ( gt , lt , ge , le )
    Equality operators: == , != ( eq , ne )
Conditional operators:ï¼ˆæ¡ä»¶è¿ç®—ï¼‰
    If-then: (if) ? (then)
    If-then-else: (if) ? (then) : (else)
    Default: (value) ?: (defaultvalue)
Special tokens:ï¼ˆç©ºæ“ä½œï¼‰
	No-Operation: _

</code></pre>
<p>inlineå†™æ³•</p>
<pre><code class="language-html">[[]] --&gt;th:text
[()] --&gt;th:utext

</code></pre>
<h2 id="4-springmvcè‡ªåŠ¨é…ç½®">4ã€SpringMVCè‡ªåŠ¨é…ç½®</h2>
<h3 id="1-springmvcçš„è‡ªåŠ¨å¯¼å…¥">1ã€SpringMVCçš„è‡ªåŠ¨å¯¼å…¥</h3>
<p><a href="https://docs.spring.io/spring-boot/docs/1.5.12.RELEASE/reference/htmlsingle/#boot-features-developing-web-applications">Springæ¡†æ¶</a></p>
<p>è‡ªåŠ¨é…ç½®å¥½äº†mvcï¼š</p>
<p>ä»¥ä¸‹æ˜¯SpringBootå¯¹SpringMVCçš„é»˜è®¤</p>
<p>Spring Boot provides auto-configuration for Spring MVC that works well with most applications.</p>
<p>The auto-configuration adds the following features on top of Springâ€™s defaults:</p>
<ul>
<li>
<p>Inclusion of <code>ContentNegotiatingViewResolver</code> and <code>BeanNameViewResolver</code> beans.</p>
<ul>
<li>è‡ªåŠ¨é…ç½®äº†ViewResolver(è§†å›¾è§£æå™¨ï¼šæ ¹æ®æ–¹æ³•çš„è¿”å›å€¼å¾—åˆ°è§†å›¾å¯¹è±¡ï¼ˆViewï¼‰,è§†å›¾å¯¹è±¡å†³å®šå¦‚ä½•æ¸²æŸ“ï¼ˆè½¬å‘ï¼Ÿé‡å®šå‘ï¼Ÿï¼‰)</li>
<li><code>ContentNegotiatingViewResolver</code>ç»„åˆæ‰€æœ‰è§†å›¾è§£æå™¨</li>
<li>å¦‚ä½•å®šåˆ¶ï¼šæˆ‘ä»¬å¯ä»¥è‡ªå·±ç»™å®¹å™¨ä¸­æ·»åŠ ä¸€ä¸ªè§†å›¾è§£æå™¨ï¼›è‡ªåŠ¨å°†å…¶æ•´åˆè¿›æ¥</li>
</ul>
</li>
<li>
<p>Support for serving static resources, including support for WebJars (see below).é™æ€èµ„æº</p>
</li>
<li>
<p>Static <code>index.html</code> support.</p>
</li>
<li>
<p>Custom <code>Favicon</code> support (see below).</p>
</li>
<li>
<p>è‡ªåŠ¨æ³¨å†Œ äº†<code>Converter</code>, <code>GenericConverter</code>, <code>Formatter</code> beans.</p>
<ul>
<li>
<p><code>Converter</code>ï¼šç±»å‹è½¬æ¢ æ–‡æœ¬è½¬ä¸ºå­—é¢é‡</p>
</li>
<li>
<p><code>Formatter</code> ï¼šæ ¼å¼åŒ–å™¨ è½¬æ¢åæ ¼å¼è½¬æ¢</p>
<pre><code class="language-java">@Bean
@ConditionalOnProperty(prefix = &quot;spring.mvc&quot;, name = &quot;date-format&quot;)//åœ¨æ–‡ä»¶é…ç½®å…¥èŒæ ¼å¼åŒ–çš„è§„åˆ™
public Formatter&lt;Date&gt; dateFormatter() {
   return new DateFormatter(this.mvcProperties.getDateFormat());//æ—¥æœŸæ ¼å¼åŒ–ç»„ä»¶
}

</code></pre>
<p>è‡ªå·±æ·»åŠ çš„æ ¼å¼åŒ–è½¬æ¢å™¨ï¼Œåªéœ€è¦æ”¾åœ¨å®¹å™¨ä¸­å³å¯</p>
</li>
</ul>
</li>
<li>
<p>Support for <code>HttpMessageConverters</code> (see below).</p>
<ul>
<li>
<p><code>HttpMessageConverters</code> ï¼šè½¬æ¢HTTPè½¬æ¢å’Œå“åº”ï¼šUser - json</p>
</li>
<li>
<p><code>HttpMessageConverters</code> ï¼šæ˜¯ä»å®¹å™¨ä¸­ç¡®å®šï¼›è·å–æ‰€æœ‰çš„<code>HttpMessageConverters</code>  ï¼Œå°†è‡ªå·±çš„ç»„ä»¶æ³¨å†Œåœ¨å®¹å™¨ä¸­@Bean</p>
</li>
<li>
<p>If you need to add or customize converters you can use Spring Bootâ€™s <code>HttpMessageConverters</code> class:</p>
<pre><code class="language-java">import org.springframework.boot.autoconfigure.web.HttpMessageConverters;
import org.springframework.context.annotation.*;
import org.springframework.http.converter.*;

@Configuration
public class MyConfiguration {

    @Bean
    public HttpMessageConverters customConverters() {
        HttpMessageConverter&lt;?&gt; additional = ...
        HttpMessageConverter&lt;?&gt; another = ...
        return new HttpMessageConverters(additional, another);
    }

}

</code></pre>
</li>
</ul>
</li>
<li>
<p>Automatic registration of <code>MessageCodesResolver</code> (see below).</p>
<ul>
<li>å®šä¹‰é”™è¯¯ä»£ç ç”Ÿæˆè§„åˆ™</li>
</ul>
</li>
<li>
<p>Automatic use of a <code>ConfigurableWebBindingInitializer</code> bean (see below).</p>
<ul>
<li>
<pre><code class="language-java">@Override
protected ConfigurableWebBindingInitializer getConfigurableWebBindingInitializer() {
   try {
      return this.beanFactory.getBean(ConfigurableWebBindingInitializer.class);
   }
   catch (NoSuchBeanDefinitionException ex) {
      return super.getConfigurableWebBindingInitializer();
   }
}

</code></pre>
<p>åœ¨beanFactoryï¼šä¸­å¯ä»¥è‡ªå·±åˆ›å»ºä¸€ä¸ªï¼Œåˆå§‹åŒ–webDataBinder</p>
<p>è¯·æ±‚æ•°æ® ==ã€‹javaBean</p>
</li>
</ul>
</li>
</ul>
<p>If you want to keep Spring Boot MVC features, and you just want to add additional <a href="https://docs.spring.io/spring/docs/4.3.16.RELEASE/spring-framework-reference/htmlsingle#mvc">MVC configuration</a> (interceptors, formatters, view controllers etc.) you can add your own <code>@Configuration</code> class of type <code>WebMvcConfigurerAdapter</code>, but <strong>without</strong> <code>@EnableWebMvc</code>. If you wish to provide custom instances of <code>RequestMappingHandlerMapping</code>, <code>RequestMappingHandlerAdapter</code> or <code>ExceptionHandlerExceptionResolver</code> you can declare a <code>WebMvcRegistrationsAdapter</code> instance providing such components.</p>
<p>If you want to take complete control of Spring MVC, you can add your own <code>@Configuration</code> annotated with <code>@EnableWebMvc</code>.</p>
<p>æ€æƒ³ï¼šä¿®æ”¹é»˜è®¤é…ç½®</p>
<h3 id="2-æ‰©å±•springmvc">2ã€æ‰©å±•SpringMVC</h3>
<p>ç¼–å†™ä¸€ä¸ªé…ç½®ç±»ï¼Œç±»å‹æ˜¯WebMvcConfigurerAdapter(ç»§æ‰¿)ï¼Œä½¿ç”¨WebMvcConfigurerAdapterå¯ä»¥æ‰©å±•ï¼Œä¸èƒ½æ ‡æ³¨@EnableWebMvc;æ—¢ä¿ç•™äº†é…ç½®ï¼Œä¹Ÿèƒ½æ‹“å±•æˆ‘ä»¬è‡ªå·±çš„åº”ç”¨</p>
<pre><code class="language-java">@Configuration
public class MyMvcConfig extends WebMvcConfigurerAdapter {

    @Override
    public void addViewControllers(ViewControllerRegistry registry) {
//        super.addViewControllers(registry);
        //æµè§ˆå™¨å‘é€wdjrè¯·æ±‚ï¼Œä¹Ÿæ¥åˆ°successé¡µé¢
        registry.addViewController(&quot;/wdjr&quot;).setViewName(&quot;success&quot;);
    }
}

</code></pre>
<p>åŸç†ï¼š</p>
<p>1ï¼‰ã€WebMvcAutoConfigurationæ˜¯SpringMVCçš„è‡ªåŠ¨é…ç½®</p>
<p>2ï¼‰ã€åœ¨åšå…¶ä»–è‡ªåŠ¨é…ç½®æ—¶ä¼šå¯¼å…¥ï¼›@Import(EnableWebMvcConfiguration.class)</p>
<pre><code class="language-java">@Configuration
public static class EnableWebMvcConfiguration extends DelegatingWebMvcConfiguration {
    private final WebMvcConfigurerComposite configurers = new WebMvcConfigurerComposite();

	//ä»å®¹å™¨ä¸­è·å–æ‰€æœ‰webMVCconfigurer
	@Autowired(required = false)
	public void setConfigurers(List&lt;WebMvcConfigurer&gt; configurers) {
		if (!CollectionUtils.isEmpty(configurers)) {
			this.configurers.addWebMvcConfigurers(configurers);
            
            	@Override
                protected void addViewControllers(ViewControllerRegistry registry) {
                    this.configurers.addViewControllers(registry);
                }
            //ä¸€ä¸ªå‚è€ƒå®ç°,å°†æ‰€æœ‰çš„webMVCconfigurerç›¸å…³é…ç½®ä¸€èµ·è°ƒç”¨ï¼ˆåŒ…æ‹¬è‡ªå·±çš„é…ç½®ç±»ï¼‰
            	@Override
               // public void addViewControllers(ViewControllerRegistry registry) {
                   // for (WebMvcConfigurer delegate : this.delegates) {
				 //delegate.addViewControllers(registry);
                    //}
                }
		}
	}
    

</code></pre>
<p>3ï¼‰ã€è‡ªå·±çš„é…ç½®è¢«è°ƒç”¨</p>
<p>æ•ˆæœï¼šSpringMVCçš„è‡ªåŠ¨é…ç½®å’Œæˆ‘ä»¬çš„æ‰©å±•é…ç½®éƒ½ä¼šèµ·ä½œç”¨</p>
<h3 id="3-å…¨é¢æ¥ç®¡mvc">3ã€å…¨é¢æ¥ç®¡mvc</h3>
<p>ä¸éœ€è¦SpringBootå¯¹SpringMVCçš„è‡ªåŠ¨é…ç½®ã€‚</p>
<pre><code class="language-java">@EnableWebMvc
@Configuration
public class MyMvcConfig extends WebMvcConfigurerAdapter {

@Override
public void addViewControllers(ViewControllerRegistry registry) {


//        super.addViewControllers(registry);
        //æµè§ˆå™¨å‘é€wdjrè¯·æ±‚ï¼Œä¹Ÿæ¥åˆ°successé¡µé¢
        registry.addViewController(&quot;/wdjr&quot;).setViewName(&quot;success&quot;);
    }
}

</code></pre>
<p>ä¾‹å¦‚é™æ€èµ„æºè®¿é—®ï¼Œä¸æ¨èå…¨é¢æ¥ç®¡</p>
<p>åŸç†ï¼š</p>
<p>ä¸ºä»€ä¹ˆ@EnableWebMvcæ³¨è§£ï¼ŒSpringBootå¯¹SpringMVCçš„æ§åˆ¶å°±å¤±æ•ˆäº†</p>
<p>1ï¼‰ã€æ ¸å¿ƒé…ç½®</p>
<pre><code class="language-java">@Import(DelegatingWebMvcConfiguration.class)
public @interface EnableWebMvc {
}

</code></pre>
<p>2ï¼‰ã€DelegatingWebMvcConfiguration</p>
<pre><code class="language-java">@Configuration
public class DelegatingWebMvcConfiguration extends WebMvcConfigurationSupport {

</code></pre>
<p>3ï¼‰ã€WebMvcAutoConfiguration</p>
<pre><code class="language-java">@Configuration
@ConditionalOnWebApplication
@ConditionalOnClass({ Servlet.class, DispatcherServlet.class,
      WebMvcConfigurerAdapter.class })
//å®¹å™¨æ²¡æœ‰è¿™ä¸ªç»„ä»¶çš„æ—¶å€™ï¼Œè¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»æ‰ç”Ÿæ•ˆ
@ConditionalOnMissingBean(WebMvcConfigurationSupport.class)
@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE + 10)
@AutoConfigureAfter({ DispatcherServletAutoConfiguration.class,
      ValidationAutoConfiguration.class })
public class WebMvcAutoConfiguration {

</code></pre>
<p>4ï¼‰ã€@EnableWebMvcå°†WebMvcConfigurationSupportå¯¼å…¥è¿›æ¥äº†ï¼›</p>
<p>5ï¼‰ã€å¯¼å…¥çš„WebMvcConfigurationSupportåªæ˜¯SpringMVCæœ€åŸºæœ¬çš„åŠŸèƒ½</p>
<h2 id="5-ä¿®æ”¹springmvcé»˜è®¤é…ç½®">5ã€ä¿®æ”¹SpringMVCé»˜è®¤é…ç½®</h2>
<p>æ¨¡å¼:</p>
<p>â€‹	1ï¼‰ã€SpringBootåœ¨è‡ªåŠ¨é…ç½®å¾ˆå¤šç»„ä»¶çš„æ—¶å€™ï¼Œå…ˆçœ‹å®¹å™¨ä¸­æœ‰æ²¡æœ‰ç”¨æˆ·è‡ªå·±é…ç½®çš„ï¼ˆ@Beanã€@Componentï¼‰å¦‚æœæœ‰å°±ç”¨ç”¨æˆ·é…ç½®çš„ï¼Œå¦‚æœæ²¡æœ‰ï¼Œæ‰è‡ªåŠ¨é…ç½®ï¼›å¦‚æœæœ‰äº›ç»„ä»¶å¯ä»¥æœ‰å¤šä¸ªï¼ˆViewResolverï¼‰å°†ç”¨æˆ·é…ç½®çš„å’Œè‡ªå·±é»˜è®¤çš„ç»„åˆèµ·æ¥ï¼›</p>
<p>â€‹	2ï¼‰ã€åœ¨SpringBootä¸­ä¼šæœ‰ xxxConfigurerå¸®åŠ©æˆ‘ä»¬æ‰©å±•é…ç½®ã€‚</p>
<h2 id="6-restfulcrud">6ã€RestfulCRUD</h2>
<h3 id="1-é»˜è®¤è®¿é—®é¦–é¡µ">1ã€é»˜è®¤è®¿é—®é¦–é¡µ</h3>
<p>åœ¨config/MyConfig.javaä¸­ç¼–å†™é…ç½®ç±»</p>
<pre><code class="language-java">//æ‰€æœ‰çš„webMvcConfigurerAdapterç»„ä»¶ä¼šä¸€èµ·èµ·ä½œç”¨
@Bean //è¨»å†Šåˆ°å®¹å™¨å»
public WebMvcConfigurerAdapter webMvcConfigurerAdapter(){
    WebMvcConfigurerAdapter adapter = new WebMvcConfigurerAdapter() {
        @Override
        public void addViewControllers(ViewControllerRegistry registry) {
            registry.addViewController(&quot;/&quot;).setViewName(&quot;login&quot;);
            registry.addViewController(&quot;/login.html&quot;).setViewName(&quot;login&quot;);
        }
    };
    return adapter;
}

</code></pre>
<p>é™æ€èµ„æºå¼•ç”¨</p>
<pre><code class="language-html">&lt;link href=&quot;#&quot; th:href=&quot;@{/css/signin.css}&quot; rel=&quot;stylesheet&quot; /&gt;

</code></pre>
<h3 id="2-å›½é™…åŒ–">2ã€å›½é™…åŒ–</h3>
<p>1ã€ç¼–å†™å›½é™…åŒ–é…ç½®æ–‡ä»¶</p>
<p>2ã€ä½¿ç”¨ResourceBundleMessageSourceç®¡ç†å›½é™…åŒ–èµ„æºæ–‡ä»¶</p>
<p>3ã€åœ¨é¡µé¢ä¸­ä½¿ç”¨fmt:messageï¼Œå–å‡ºå›½é™…åŒ–å†…å®¹</p>
<h4 id="1-æµè§ˆå™¨åˆ‡æ¢å›½é™…åŒ–">1ã€æµè§ˆå™¨åˆ‡æ¢å›½é™…åŒ–</h4>
<p>æ­¥éª¤</p>
<p>1ã€ç¼–å†™å›½é™…åŒ–é…ç½®æ–‡ä»¶ï¼ŒæŠ½å–é¡µé¢éœ€è¦çš„æ˜¾ç¤ºçš„å›½é™…åŒ–æ¶ˆæ¯</p>
<figure data-type="image" tabindex="14"><img src="https://stormga.github.io//post-images/16.national.jpg" alt="" loading="lazy"></figure>
<p>2ã€SpringBootè‡ªåŠ¨é…ç½®å¥½äº†å›½é™…åŒ–é…ç½®çš„èµ„æºæ–‡ä»¶</p>
<pre><code class="language-java">@ConfigurationProperties(prefix = &quot;spring.messages&quot;)
public class MessageSourceAutoConfiguration {
    //æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶å¯ä»¥ç›´æ¥æ”¾åœ¨ç±»è·¯å¾„ä¸‹å«messages.properties
    private String basename = &quot;messages&quot;;
    @Bean
	public MessageSource messageSource() {
		ResourceBundleMessageSource messageSource = new ResourceBundleMessageSource();
		if (StringUtils.hasText(this.basename)) {
            //è®¾ç½®å›½é™…åŒ–æ–‡ä»¶çš„åŸºç¡€åï¼Œå»æ‰è¯­è¨€å›½å®¶ä»£ç 
			messageSource.setBasenames(StringUtils.commaDelimitedListToStringArray(
					StringUtils.trimAllWhitespace(this.basename)));
		}
		if (this.encoding != null) {
			messageSource.setDefaultEncoding(this.encoding.name());
		}
		messageSource.setFallbackToSystemLocale(this.fallbackToSystemLocale);
		messageSource.setCacheSeconds(this.cacheSeconds);
		messageSource.setAlwaysUseMessageFormat(this.alwaysUseMessageFormat);
		return messageSource;
	}

</code></pre>
<p>3ã€å¯¹IDEAçš„ç¼–ç è¿›è¡Œè®¾ç½®</p>
<figure data-type="image" tabindex="15"><img src="https://stormga.github.io//post-images/17.encoding.jpg" alt="" loading="lazy"></figure>
<p>4ã€loginè¿›è¡Œæ ‡ç­¾æ’å…¥</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;!-- saved from url=(0051)https://getbootstrap.com/docs/4.1/examples/sign-in/ --&gt;
&lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
&lt;head&gt;
    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
    
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot; /&gt;
    &lt;meta name=&quot;description&quot; content=&quot;&quot; /&gt;
    &lt;meta name=&quot;author&quot; content=&quot;&quot; /&gt;
    &lt;link rel=&quot;icon&quot; href=&quot;https://getbootstrap.com/favicon.ico&quot; /&gt;

    &lt;title&gt;ç™»å½•é¡µé¢&lt;/title&gt;

    &lt;!-- Bootstrap core CSS --&gt;
    &lt;link href=&quot;#&quot; th:href=&quot;@{/css/bootstrap.min.css}&quot; rel=&quot;stylesheet&quot; /&gt;

    &lt;!-- Custom styles for this template --&gt;
    &lt;link href=&quot;./login_files/signin.css&quot; th:href=&quot;@{/css/signin.css}&quot; rel=&quot;stylesheet&quot; /&gt;
  &lt;/head&gt;

  &lt;body class=&quot;text-center&quot;&gt;
    &lt;form class=&quot;form-signin&quot;&gt;
      &lt;img class=&quot;mb-4&quot; src=&quot;./login_files/bootstrap-solid.svg&quot; th:src=&quot;@{/img/bootstrap-solid.svg}&quot; alt=&quot;&quot; width=&quot;72&quot; height=&quot;72&quot; /&gt;
      &lt;h1 class=&quot;h3 mb-3 font-weight-normal&quot; th:text=&quot;#{login.tip}&quot;&gt;Please sign in&lt;/h1&gt;
      &lt;label  class=&quot;sr-only&quot; th:text=&quot;#{login.username}&quot;&gt;Username&lt;/label&gt;
      &lt;input type=&quot;text&quot;  name=&quot;username&quot; class=&quot;form-control&quot; placeholder=&quot;Username&quot; th:placeholder=&quot;#{login.username}&quot; required=&quot;&quot; autofocus=&quot;&quot;/&gt;
      &lt;label for=&quot;inputPassword&quot; class=&quot;sr-only&quot; th:text=&quot;#{login.password}&quot;&gt;Password&lt;/label&gt;
      &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;inputPassword&quot; class=&quot;form-control&quot; placeholder=&quot;Password&quot; th:placeholder=&quot;#{login.password}&quot; required=&quot;&quot; /&gt;
      &lt;div class=&quot;checkbox mb-3&quot;&gt;
        &lt;label&gt;
          &lt;input type=&quot;checkbox&quot; value=&quot;remember-me&quot; /&gt; [[#{login.remember}]]
        &lt;/label&gt;
      &lt;/div&gt;
      &lt;button class=&quot;btn btn-lg btn-primary btn-block&quot; type=&quot;submit&quot; th:text=&quot;#{login.btn}&quot;&gt;Sign in&lt;/button&gt;
      &lt;p class=&quot;mt-5 mb-3 text-muted&quot;&gt;Â© 2017-2018&lt;/p&gt;
    &lt;/form&gt;
  

&lt;/body&gt;&lt;/html&gt;

</code></pre>
<p>æ•ˆæœæ ¹æ®æµè§ˆå™¨è¯­è¨€çš„ä¿¡æ¯åˆ‡æ¢å›½é™…åŒ–</p>
<p>åŸç†ï¼š</p>
<p>å›½é™…åŒ–localeï¼ˆåŒºåŸŸä¿¡æ¯å¯¹è±¡ï¼‰ï¼›LocaleResolver(è·å–åŒºåŸŸå¯¹è±¡)ï¼›</p>
<pre><code class="language-java">@Bean
@ConditionalOnMissingBean
@ConditionalOnProperty(prefix = &quot;spring.mvc&quot;, name = &quot;locale&quot;)
public LocaleResolver localeResolver() {
    if (this.mvcProperties
        .getLocaleResolver() == WebMvcProperties.LocaleResolver.FIXED) {
        return new FixedLocaleResolver(this.mvcProperties.getLocale());
    }
    AcceptHeaderLocaleResolver localeResolver = new AcceptHeaderLocaleResolver();
    localeResolver.setDefaultLocale(this.mvcProperties.getLocale());
    return localeResolver;
}            


</code></pre>
<p>é»˜è®¤çš„å°±æ˜¯æ ¹æ®è¯·æ±‚å¤´å¸¦æ¥çš„åŒºåŸŸä¿¡æ¯è·å–localå›½é™…åŒ–ä¿¡æ¯ï¼ˆæˆªå›¾å°±æ˜¯è¿™ä¹ˆçŠ€åˆ©ï¼‰</p>
<figure data-type="image" tabindex="16"><img src="https://stormga.github.io//post-images/18.accept-language.jpg" alt="" loading="lazy"></figure>
<h4 id="2-ç‚¹å‡»é“¾æ¥åˆ‡æ¢å›½é™…åŒ–">2ã€ç‚¹å‡»é“¾æ¥åˆ‡æ¢å›½é™…åŒ–</h4>
<p>è‡ªå·±ç¼–å†™localResolverï¼ŒåŠ åˆ°å®¹å™¨ä¸­</p>
<p>1ã€æ›´æ”¹HTMLä»£ç </p>
<pre><code class="language-html">&lt;p class=&quot;mt-5 mb-3 text-muted&quot;&gt;Â© 2017-2018&lt;/p&gt;
  &lt;a href=&quot;#&quot; class=&quot;btn btn-sm&quot; th:href=&quot;@{/index.html?lg=zh_CN}&quot;&gt;ä¸­æ–‡&lt;/a&gt;
  &lt;a href=&quot;#&quot; class=&quot;btn btn-sm&quot; th:href=&quot;@{/index.html?lg=en_US}&quot;&gt;English&lt;/a&gt;

</code></pre>
<p>2ã€æ–°å»ºä¸€ä¸ªMyLocaleResolver.class</p>
<pre><code class="language-java">public class MyLocaleResolver implements LocaleResolver {

    //è§£æåŒºåŸŸä¿¡æ¯
    @Override
    public Locale resolveLocale(HttpServletRequest request) {
        String l = request.getParameter(&quot;lg&quot;);
        Locale locale = Locale.getDefault();
        if(!StringUtils.isEmpty(l)){
            String[] split = l.split(&quot;_&quot;);
            locale = new Locale(split[0], split[1]);
        }
        return locale;
    }

    @Override
    public void setLocale(HttpServletRequest request, HttpServletResponse response, Locale locale) {

    }
}

</code></pre>
<p>3ã€å°†MyLocaleResolveråŠ å…¥åˆ°å®¹å™¨ä¸­</p>
<pre><code class="language-java">@Bean
public LocaleResolver localeResolver(){
    return new MyLocalResolver();
}

</code></pre>
<p>4ã€å¯åŠ¨æ¼”ç¤º</p>
<h3 id="3-ç™»å½•æ‹¦æˆªå™¨">3ã€ç™»å½•æ‹¦æˆªå™¨</h3>
<h4 id="1-ç™»å½•">1ã€ç™»å½•</h4>
<p>å¼€å‘æŠ€å·§</p>
<p>â€‹	1ã€æ¸…é™¤æ¨¡æ¿ç¼“å­˜</p>
<p>â€‹	2ã€Ctrl+F9åˆ·æ–°</p>
<p>1ã€æ–°å»ºä¸€ä¸ªLoginController</p>
<pre><code class="language-java">@Controller
public class LoginController {

    @PostMapping(value =&quot;/user/login&quot;)
    public String login(@RequestParam(&quot;username&quot;)String username,
                        @RequestParam(&quot;password&quot;)String password,
                        Map&lt;String,Object&gt; map){
        if(!StringUtils.isEmpty(username) &amp;&amp; &quot;123456&quot;.equals(password)){
            //ç™»å½•æˆåŠŸ
            return &quot;list&quot;;
        }else{
            map.put(&quot;msg&quot;, &quot;ç”¨æˆ·åå¯†ç é”™è¯¯&quot;);
            return &quot;login&quot;;
        }

    }
}

</code></pre>
<p>2ã€ç™»å½•é”™è¯¯æ¶ˆæ¯æ˜¾ç¤º</p>
<pre><code class="language-html">&lt;!--åˆ¤æ–­--&gt;
&lt;p style=&quot;color: red&quot; th:text=&quot;${msg}&quot; th:if=&quot;${not #strings.isEmpty(msg)}&quot;&gt;&lt;/p&gt;

</code></pre>
<p>3ã€è¡¨å•é‡å¤æäº¤</p>
<p>è¡¨å•é‡å¤æäº¤äº‹ä»¶ --ã€‹é‡å®šå‘æ¥åˆ°æˆåŠŸé¡µé¢--ã€‹æ¨¡æ¿å¼•æ“è§£æ</p>
<pre><code class="language-java">if(!StringUtils.isEmpty(username) &amp;&amp; &quot;123456&quot;.equals(password)){
    //ç™»å½•æˆåŠŸ,é˜²æ­¢é‡å¤æäº¤
    return &quot;redirect:/main.html&quot;;
}else{
    map.put(&quot;msg&quot;, &quot;ç”¨æˆ·åå¯†ç é”™è¯¯&quot;);
    return &quot;login&quot;;
}

</code></pre>
<p>æ¨¡æ¿å¼•æ“è§£æ</p>
<pre><code class="language-java">@Override
public void addViewControllers(ViewControllerRegistry registry) {
    registry.addViewController(&quot;/&quot;).setViewName(&quot;login&quot;);
    registry.addViewController(&quot;/index.html&quot;).setViewName(&quot;login&quot;);
    registry.addViewController(&quot;/main.html&quot;).setViewName(&quot;Dashboard&quot;);
}

</code></pre>
<h3 id="4-æ‹¦æˆªå™¨">4ã€æ‹¦æˆªå™¨</h3>
<p>ä½œç”¨ï¼šå®ç°æƒé™æ§åˆ¶ï¼Œæ¯ä¸ªé¡µé¢è¯·æ±‚å‰ä¸­åï¼Œéƒ½ä¼šè¿›å…¥åˆ°æ‹¦æˆªå™¨è¿›è¡Œå¤„ç†ï¼ˆç™»å½•æƒé™ï¼‰</p>
<p>1ã€åœ¨componentä¸‹æ–°å»ºä¸€ä¸ªLoginHandlerInterceptoræ‹¦æˆªå™¨</p>
<pre><code class="language-java">public class LoginHandlerInterceptor implements HandlerInterceptor {

    //ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
        Object user = request.getSession().getAttribute(&quot;loginUser&quot;);
        if(user!=null){
            //å·²ç»ç™»å½•
            return true;
        }
        //æœªç»è¿‡éªŒè¯
        request.setAttribute(&quot;msg&quot;, &quot;æ²¡æƒé™è¯·å…ˆç™»å½•&quot;);
        request.getRequestDispatcher(&quot;/index.html&quot;).forward(request, response);

        return false;
    }

    @Override
    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {

    }

    @Override
    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {

    }
}

</code></pre>
<p>2ã€åœ¨MyMvcConfigé…ç½®ä¸­é‡å†™æ‹¦æˆªå™¨æ–¹æ³•ï¼ŒåŠ å…¥åˆ°å®¹å™¨ä¸­</p>
<pre><code class="language-java">//æ‰€æœ‰çš„webMvcConfigurerAdapterç»„ä»¶ä¼šä¸€èµ·èµ·ä½œç”¨
@Bean //è¨»å†Šåˆ°å®¹å™¨å»
public WebMvcConfigurerAdapter webMvcConfigurerAdapter(){
    WebMvcConfigurerAdapter adapter = new WebMvcConfigurerAdapter() {
        @Override
        public void addViewControllers(ViewControllerRegistry registry) {
            registry.addViewController(&quot;/&quot;).setViewName(&quot;login&quot;);
            registry.addViewController(&quot;/index.html&quot;).setViewName(&quot;login&quot;);
            registry.addViewController(&quot;/main.html&quot;).setViewName(&quot;Dashboard&quot;);
        }
        //æ³¨å†Œæ‹¦æˆªå™¨
        @Override
        public void addInterceptors(InterceptorRegistry registry) {
            //é™æ€èµ„æº css js img å·²ç»åšå¥½äº†é™æ€èµ„æºæ˜ å°„
            registry.addInterceptor(new LoginHandlerInterceptor()).addPathPatterns(&quot;/**&quot;).
                    excludePathPatterns(&quot;/index.html&quot;,&quot;/&quot;,&quot;/user/login&quot;);
        }
    };
    return adapter;
}

</code></pre>
<p>3ã€åœ¨LoginHandlerä¸­æ·»åŠ ç™»å½•æˆåŠŸå†™å…¥session</p>
<pre><code class="language-java">@Controller
public class LoginController {

    @PostMapping(value =&quot;/user/login&quot;)
    public String login(@RequestParam(&quot;username&quot;)String username,
                        @RequestParam(&quot;password&quot;)String password,
                        Map&lt;String,Object&gt; map,
                        HttpSession session){
        if(!StringUtils.isEmpty(username) &amp;&amp; &quot;123456&quot;.equals(password)){
            //ç™»å½•æˆåŠŸ,é˜²æ­¢é‡å¤æäº¤
            session.setAttribute(&quot;loginUser&quot;, username);
            return &quot;redirect:/main.html&quot;;
        }else{
            map.put(&quot;msg&quot;, &quot;ç”¨æˆ·åå¯†ç é”™è¯¯&quot;);
            return &quot;login&quot;;
        }

    }
}

</code></pre>
<h3 id="5-crud-å‘˜å·¥åˆ—è¡¨">5ã€CRUD-å‘˜å·¥åˆ—è¡¨</h3>
<p>å®éªŒè¦æ±‚ï¼š</p>
<p>1ï¼‰ã€RestfulCRUDï¼šCRUDæ»¡è¶³Resté£æ ¼</p>
<p>URI:/èµ„æºåç§°/èµ„æºæ ‡è¯†+HTTPæ“ä½œ</p>
<table>
<thead>
<tr>
<th></th>
<th>æ™®é€šCRUD</th>
<th>RestfulCRUD</th>
</tr>
</thead>
<tbody>
<tr>
<td>æŸ¥è¯¢</td>
<td>getEmp</td>
<td>emp -- GET</td>
</tr>
<tr>
<td>æ·»åŠ </td>
<td>addEmp?xxx</td>
<td>emp --POST</td>
</tr>
<tr>
<td>ä¿®æ”¹</td>
<td>updateEmp?id=xxx&amp;xxx=xx</td>
<td>emp/{id} -- PUT</td>
</tr>
<tr>
<td>åˆ é™¤</td>
<td>deleteEmp?id=1</td>
<td>emp/{id} --DELETE</td>
</tr>
</tbody>
</table>
<p>2ã€å®éªŒçš„è¯·æ±‚æ¶æ„</p>
<table>
<thead>
<tr>
<th></th>
<th>è¯·æ±‚URI</th>
<th>è¯·æ±‚æ–¹å¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥</td>
<td>emps</td>
<td>GET</td>
</tr>
<tr>
<td>æŸ¥è¯¢æŸä¸ªå‘˜å·¥</td>
<td>emp/{id}</td>
<td>GET</td>
</tr>
<tr>
<td>æ·»åŠ é¡µé¢</td>
<td>emp</td>
<td>GET</td>
</tr>
<tr>
<td>æ·»åŠ å‘˜å·¥</td>
<td>emp</td>
<td>POST</td>
</tr>
<tr>
<td>ä¿®æ”¹é¡µé¢(å›æ˜¾)</td>
<td>emp/{id}</td>
<td>GET</td>
</tr>
<tr>
<td>ä¿®æ”¹å‘˜å·¥</td>
<td>emp/{id}</td>
<td>PUT</td>
</tr>
<tr>
<td>åˆ é™¤å‘˜å·¥</td>
<td>emp/{id}</td>
<td>DELETE</td>
</tr>
</tbody>
</table>
<p>3ã€å‘˜å·¥åˆ—è¡¨</p>
<h4 id="1-å…¬å…±é¡µé¢æŠ½å–">1ã€å…¬å…±é¡µé¢æŠ½å–</h4>
<p>ä½¿ç”¨æ–¹æ³•</p>
<pre><code class="language-html">1ã€æŠ½å–å…¬å…±ç‰‡æ®µ
&lt;!--footer.html--&gt;
&lt;div id=&quot;footid&quot; th:fragment=&quot;copy&quot;&gt;xxx&lt;/div&gt;
2ã€å¼•å…¥å…¬å…±ç‰‡æ®µ
&lt;!--test.html--&gt;
&lt;div th:insert=~{footer::copy}&gt;&lt;/div&gt;
~{templatename::selector} æ¨¡æ¿å::é€‰æ‹©å™¨  footer::#footid
~{templatename::fragmentname} æ¨¡æ¿å::ç‰‡æ®µåç§° footer::copy
è¡Œå†…å†™æ³•å¯ä»¥åŠ ~{xx::xx} æ ‡ç­¾ä½“å¯ä»¥ xx::xx

</code></pre>
<p><strong>ä¸‰ç§å¼•ç”¨æ–¹å¼</strong></p>
<p><strong>th:insert</strong> :åŠ ä¸ªå¤–å±‚æ ‡ç­¾ +1</p>
<p><strong>th:replace</strong> :å®Œå…¨æ›¿æ¢ 1</p>
<p><strong>th:include</strong>ï¼šå°±æ›¿æ¢é‡Œé¢çš„å†…å®¹ -1</p>
<p>å…¬å…±é¡µé¢</p>
<pre><code class="language-html">&lt;body&gt;
	...
    &lt;div th:insert=&quot;footer :: copy&quot;&gt;&lt;/div&gt;
    &lt;div th:replace=&quot;footer :: copy&quot;&gt;&lt;/div&gt;
    &lt;div th:include=&quot;footer :: copy&quot;&gt;&lt;/div&gt;
&lt;/body&gt;

</code></pre>
<p>ç»“æœ</p>
<pre><code class="language-html">&lt;body&gt;
...
    &lt;!-- th:insert --&gt;
    &lt;div&gt;
        &lt;footer&gt;
            &amp;copy; 2011 The Good Thymes Virtual Grocery
        &lt;/footer&gt;
    &lt;/div&gt;
    &lt;!--th:replace--&gt;
    &lt;footer&gt;
   		&amp;copy; 2011 The Good Thymes Virtual Grocery
    &lt;/footer&gt;
    &lt;!--th:include--&gt;
    &lt;div&gt;
        &amp;copy; 2011 The Good Thymes Virtual Grocery
    &lt;/div&gt;
&lt;/body&gt;

</code></pre>
<p>ç”¨æ­¤ç§æ–¹æ³•å°†å…¬å…±é¡µé¢å¼•å…¥</p>
<h4 id="2-åˆ—è¡¨é«˜äº®">2ã€åˆ—è¡¨é«˜äº®</h4>
<p>å¼•å…¥ç‰‡æ®µçš„æ—¶å€™ä¼ å…¥å‚æ•°ï¼Œæ–°å»ºä¸€ä¸ªcommonsæ–‡ä»¶å¤¹å­˜å‚¨å…¬å…±é¡µé¢bar.html</p>
<p>æ¨¡æ¿å¼•å…¥å˜é‡å</p>
<p>dashboard</p>
<pre><code class="language-html">&lt;a class=&quot;nav-link active&quot;
   th:class=&quot;${activeUri}=='main.html'?'nav-link active':'nav-link'&quot;
   href=&quot;https://getbootstrap.com/docs/4.1/examples/dashboard/#&quot; th:href=&quot;@{/main.html}&quot;&gt;
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; class=&quot;feather feather-home&quot;&gt;&lt;path d=&quot;M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z&quot;&gt;&lt;/path&gt;&lt;polyline points=&quot;9 22 9 12 15 12 15 22&quot;&gt;&lt;/polyline&gt;&lt;/svg&gt;
    Dashboard &lt;span class=&quot;sr-only&quot;&gt;(current)&lt;/span&gt;
&lt;/a&gt;

</code></pre>
<p>å‘˜å·¥ç®¡ç†</p>
<pre><code class="language-html">&lt;li class=&quot;nav-item&quot;&gt;
    &lt;a class=&quot;nav-link&quot;
       th:class=&quot;${activeUri}=='emps'?'nav-link active':'nav-link'&quot;
       href=&quot;https://getbootstrap.com/docs/4.1/examples/dashboard/#&quot; th:href=&quot;@{/emps}&quot;&gt;
        &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; class=&quot;feather feather-users&quot;&gt;&lt;path d=&quot;M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2&quot;&gt;&lt;/path&gt;&lt;circle cx=&quot;9&quot; cy=&quot;7&quot; r=&quot;4&quot;&gt;&lt;/circle&gt;&lt;path d=&quot;M23 21v-2a4 4 0 0 0-3-3.87&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M16 3.13a4 4 0 0 1 0 7.75&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
        å‘˜å·¥ç®¡ç†
    &lt;/a&gt;

</code></pre>
<p>å¼•å…¥æ¨¡æ¿çš„æ—¶å€™ä¼ å…¥å‚æ•°</p>
<p>dashboard.htmlå¼•å…¥</p>
<pre><code class="language-html">&lt;!--å¼•å…¥ä¾§è¾¹æ --&gt;
   &lt;div th:replace=&quot;commons/bar :: sidebar(activeUri='main.html')&quot;&gt;&lt;/div&gt;

</code></pre>
<p>list.htmlå¼•å…¥</p>
<pre><code class="language-html">&lt;!--å¼•å…¥ä¾§è¾¹æ --&gt;
&lt;div th:replace=&quot;commons/bar::sidebar(activeUri='emps')&quot;&gt;&lt;/div&gt;

</code></pre>
<h3 id="6-åˆ—è¡¨æ•°æ®æ˜¾ç¤ºæŸ¥">6ã€åˆ—è¡¨æ•°æ®æ˜¾ç¤ºï¼ˆæŸ¥ï¼‰</h3>
<h4 id="1-ä¼ å…¥å‘˜å·¥å¯¹è±¡">1ã€ä¼ å…¥å‘˜å·¥å¯¹è±¡</h4>
<p>EmployeeControllerç±»,ä¼ å…¥å‘˜å·¥å¯¹è±¡</p>
<pre><code class="language-java">@Controller
public class EmployeeController {

    @Autowired
    EmployeeDao employeeDao;
    /**
     * æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥è¿”å›åˆ—è¡¨é¡µé¢
     */
    @GetMapping(value = &quot;/emps&quot;)
    public String list(Model model){

        Collection&lt;Employee&gt; employees = employeeDao.getAll();
        model.addAttribute(&quot;emps&quot;,employees);
        return &quot;emp/list&quot;;
    }
}

</code></pre>
<h4 id="2-éå†å¯¹è±¡">2ã€ éå†å¯¹è±¡</h4>
<p>list.htmlä¸­ ä½¿ç”¨æ¨¡æ¿çš„ <code>th:each</code>æ–¹æ³•</p>
<pre><code class="language-html">table class=&quot;table table-striped table-sm&quot;&gt;
    &lt;thead&gt;
    &lt;tr&gt;
        &lt;th&gt;#&lt;/th&gt;
        &lt;th&gt;lastName&lt;/th&gt;
        &lt;th&gt;email&lt;/th&gt;
        &lt;th&gt;gender&lt;/th&gt;
        &lt;th&gt;department&lt;/th&gt;
        &lt;th&gt;birth&lt;/th&gt;
        &lt;th&gt;æ“ä½œ&lt;/th&gt;
    &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
        &lt;tr th:each=&quot;emp:${emps}&quot;&gt;
            &lt;td th:text=&quot;${emp.id}&quot;&gt;1&lt;/td&gt;
            &lt;td th:text=&quot;${emp.lastName}&quot;&gt;1&lt;/td&gt;
            &lt;td th:text=&quot;${emp.email}&quot;&gt;1&lt;/td&gt;
            &lt;td th:text=&quot;${emp.gender}&quot;&gt;1&lt;/td&gt;
            &lt;td th:text=&quot;${emp.department.departmentName}&quot;&gt;1&lt;/td&gt;
            &lt;td th:text=&quot;${#dates.format(emp.birth,'yyyy-MM-dd HH:mm:ss')}&quot;&gt;1&lt;/td&gt;
            &lt;td&gt;
                &lt;button class=&quot;btn btn-sm btn-primary&quot;&gt;ç¼–è¾‘&lt;/button&gt;
                &lt;button class=&quot;btn btn-sm btn-danger&quot;&gt;åˆ é™¤&lt;/button&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;

</code></pre>
<h4 id="3-æ•ˆæœæ˜¾ç¤º">3ã€æ•ˆæœæ˜¾ç¤º</h4>
<p>![](https://stormga.github.io//post-images/19.table list.jpg)</p>
<h3 id="7-å‘˜å·¥æ·»åŠ å¢">7ã€å‘˜å·¥æ·»åŠ ï¼ˆå¢ï¼‰</h3>
<p>åŠŸèƒ½ï¼šç‚¹å‡»æ·»åŠ æŒ‰é’®ï¼Œå‡ºç°æ–°å¢é¡µé¢</p>
<h4 id="1-æ–°å¢é¡µé¢">1ã€æ–°å¢é¡µé¢</h4>
<pre><code class="language-html">&lt;form&gt;
    &lt;!-- LastName --&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label for=&quot;LastName&quot;&gt;LastName&lt;/label&gt;
        &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;LastName&quot;  placeholder=&quot;LastName&quot;&gt;
    &lt;/div&gt;
    &lt;!-- Email --&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label for=&quot;Email&quot;&gt;Email&lt;/label&gt;
        &lt;input type=&quot;email&quot; class=&quot;form-control&quot; id=&quot;Email&quot;  placeholder=&quot;zhangsan@163.com&quot;&gt;
    &lt;/div&gt;
    &lt;!--gender--&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label &gt;Gender&lt;/label&gt;&lt;br/&gt;
        &lt;div class=&quot;form-check form-check-inline&quot;&gt;
            &lt;input class=&quot;form-check-input&quot; type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;1&quot;&gt;
            &lt;label class=&quot;form-check-label&quot; &gt;ç”·&lt;/label&gt;
        &lt;/div&gt;
        &lt;div class=&quot;form-check form-check-inline&quot;&gt;
            &lt;input class=&quot;form-check-input&quot; type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;0&quot;&gt;
            &lt;label class=&quot;form-check-label&quot; &gt;å¥³&lt;/label&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;!-- department --&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label for=&quot;exampleFormControlSelect1&quot;&gt;department&lt;/label&gt;
        &lt;select class=&quot;form-control&quot; id=&quot;exampleFormControlSelect1&quot;&gt;
            &lt;option th:each=&quot;dept:${depts}&quot; th:value=&quot;${dept.id}&quot; th:text=&quot;${dept.departmentName}&quot;&gt;&lt;/option&gt;
        &lt;/select&gt;
    &lt;/div&gt;
    &lt;!--Birth--&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label for=&quot;birthDate&quot;&gt;Birth&lt;/label&gt;
        &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;birthDate&quot; placeholder=&quot;2012-12-12&quot;&gt;
    &lt;/div&gt;
    &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;æ·» åŠ &lt;/button&gt;
&lt;/form&gt;

</code></pre>
<h4 id="2-é¡µé¢è·³è½¬">2ã€é¡µé¢è·³è½¬</h4>
<p>åœ¨EmployeeControllerä¸­æ·»åŠ addEmpPageæ–¹æ³•</p>
<pre><code class="language-java">/**
 * æ·»åŠ å‘˜å·¥
 */
@GetMapping(value = &quot;/emp&quot;)
public String toAddPage(Model model){
    //æ¥åˆ°æ·»åŠ é¡µé¢,æŸ¥å‡ºæ‰€æœ‰éƒ¨é—¨æ˜¾ç¤º
    Collection&lt;Department&gt; depts = departmentDao.getDepartments();
    model.addAttribute(&quot;depts&quot;,depts);
    return &quot;emp/add&quot;;
}

</code></pre>
<p>å…³é”®ç‚¹ï¼šåœ¨æ·»åŠ éƒ¨é—¨é¡µé¢è¦éå†éƒ¨é—¨ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨æ–¹æ³•ä¸­å‡ºå…¥éƒ¨é—¨ä¿¡æ¯</p>
<h4 id="3-æ·»åŠ åŠŸèƒ½å®Œæˆ">3ã€æ·»åŠ åŠŸèƒ½å®Œæˆ</h4>
<p>æ–°å»ºä¸€ä¸ªPostMapping</p>
<blockquote>
<p>ThymeleafViewResolver æŸ¥çœ‹redirectå’Œforward,åŸç”Ÿçš„sendredirectæ–¹æ³•ï¼›</p>
</blockquote>
<p>1ã€æ–°å»ºä¸€ä¸ªpostMappingçš„æ–¹æ³•ç”¨æ¥æ¥å—é¡µé¢çš„æ·»åŠ POSTè¯·æ±‚</p>
<pre><code class="language-java">/**
 * å‘˜å·¥æ·»åŠ 
 */
@PostMapping(value = &quot;/emp&quot;)
public String addEmp(Employee employee){

    employeeDao.save(employee);
    //æ¥åˆ°å‘˜å·¥åˆ—è¡¨é¡µé¢ã€redirect:é‡å®šå‘åˆ°ä¸€ä¸ªåœ°å€ï¼Œforwardè½¬å‘åˆ°ä¸€ä¸ªåœ°å€
    return &quot;redirect:/emps&quot;;
}

</code></pre>
<p>2ã€ä¿®æ”¹æ·»åŠ é¡µé¢ï¼Œæ·»åŠ nameå±æ€§</p>
<pre><code class="language-html">&lt;form th:action=&quot;@{/emp}&quot; method=&quot;post&quot;&gt;
    &lt;!-- LastName --&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label for=&quot;LastName&quot;&gt;LastName&lt;/label&gt;
        &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;LastName&quot; name=&quot;lastName&quot; placeholder=&quot;LastName&quot;&gt;
    &lt;/div&gt;
    &lt;!-- Email --&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label for=&quot;Email&quot;&gt;Email&lt;/label&gt;
        &lt;input type=&quot;email&quot; class=&quot;form-control&quot; id=&quot;Email&quot;  name=&quot;email&quot; placeholder=&quot;zhangsan@163.com&quot;&gt;
    &lt;/div&gt;
    &lt;!--gender--&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label &gt;Gender&lt;/label&gt;&lt;br/&gt;
        &lt;div class=&quot;form-check form-check-inline&quot;&gt;
            &lt;input class=&quot;form-check-input&quot; type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;1&quot;&gt;
            &lt;label class=&quot;form-check-label&quot; &gt;ç”·&lt;/label&gt;
        &lt;/div&gt;
        &lt;div class=&quot;form-check form-check-inline&quot;&gt;
            &lt;input class=&quot;form-check-input&quot; type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;0&quot;&gt;
            &lt;label class=&quot;form-check-label&quot; &gt;å¥³&lt;/label&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;!-- department --&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label &gt;department&lt;/label&gt;
        &lt;select class=&quot;form-control&quot;  name=&quot;department.id&quot;&gt;
            &lt;option th:each=&quot;dept:${depts}&quot; th:value=&quot;${dept.id}&quot; th:text=&quot;${dept.departmentName}&quot;&gt;&lt;/option&gt;
        &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label for=&quot;birthDate&quot;&gt;Birth&lt;/label&gt;
        &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;birthDate&quot; placeholder=&quot;2012-12-12&quot; name=&quot;birth&quot;&gt;
    &lt;/div&gt;
    &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;æ·» åŠ &lt;/button&gt;
&lt;/form&gt;

</code></pre>
<p>1ã€éƒ¨é—¨å¯¹è±¡é—®é¢˜ï¼Ÿ</p>
<pre><code class="language-html">&lt;select class=&quot;form-control&quot;  name=&quot;department.id&quot;&gt;

</code></pre>
<p>2ã€æ—¥æœŸæ ¼å¼åŒ–ï¼Ÿ</p>
<p>å±æ€§ä¸­æ·»åŠ  date-formate é»˜è®¤æ˜¯ /</p>
<pre><code class="language-java">@Bean
@ConditionalOnProperty(prefix = &quot;spring.mvc&quot;, name = &quot;date-format&quot;)
public Formatter&lt;Date&gt; dateFormatter() {
   return new DateFormatter(this.mvcProperties.getDateFormat());
}

@Override
public MessageCodesResolver getMessageCodesResolver() {
   if (this.mvcProperties.getMessageCodesResolverFormat() != null) {
      DefaultMessageCodesResolver resolver = new DefaultMessageCodesResolver();
      resolver.setMessageCodeFormatter(
            this.mvcProperties.getMessageCodesResolverFormat());
      return resolver;
   }
   return null;
}

</code></pre>
<pre><code class="language-properties">spring.mvc.date-format=yyyy-MM-dd

</code></pre>
<h3 id="8-å‘˜å·¥ç¼–è¾‘æ”¹">8ã€å‘˜å·¥ç¼–è¾‘ï¼ˆæ”¹ï¼‰</h3>
<p>æ€è·¯ä½¿ç”¨addé¡µé¢ï¼Œå¹¶ä¸”æ•°æ®å›æ˜¾ï¼Œç„¶ååŒºåˆ†æ·»åŠ ï¼ŒPUTè¯·æ±‚</p>
<h4 id="1-ä¿®æ”¹æŒ‰é’®">1ã€ä¿®æ”¹æŒ‰é’®</h4>
<p>åœ¨list.htmlçš„<code>ç¼–è¾‘</code>æŒ‰é’®åŠ ä¸Šé“¾æ¥</p>
<pre><code class="language-html">&lt;td&gt;
    &lt;a  href=&quot;#&quot; th:href=&quot;@{/emp/}+${emp.id}&quot; class=&quot;btn btn-sm btn-primary&quot;&gt;ç¼–è¾‘&lt;/a&gt;
    &lt;button class=&quot;btn btn-sm btn-danger&quot;&gt;åˆ é™¤&lt;/button&gt;
&lt;/td&gt;

</code></pre>
<h4 id="2-ç¼–å†™è·³è½¬é¡µé¢">2ã€ç¼–å†™è·³è½¬é¡µé¢</h4>
<p>è·³è½¬åˆ°å‘˜å·¥ç¼–è¾‘é¡µé¢çš„Controller</p>
<pre><code class="language-java">/**
 * å‘˜å·¥ç¼–è¾‘é¡µé¢
 */
@GetMapping(value = &quot;/emp/{id}&quot;)
public String toEditPage(@PathVariable(&quot;id&quot;) Integer id ,Model model){
    Employee emp = employeeDao.getEmpById(id);
    Collection&lt;Department&gt; departments = departmentDao.getDepartments();
    model.addAttribute(&quot;emp&quot;,emp);
    model.addAttribute(&quot;depts&quot;,departments);
    return &quot;emp/add&quot;;
}
   

</code></pre>
<h4 id="3-å¯¹é¡µé¢ä¿®æ”¹">3ã€å¯¹é¡µé¢ä¿®æ”¹</h4>
<p>å¯¹addé¡µé¢è¿›è¡Œä¿®æ”¹</p>
<p>1ï¼‰ã€æ·»åŠ å›æ˜¾</p>
<p>2ï¼‰ã€æ·»åŠ åˆ¤æ–­æ˜¯å¦emp!=nullï¼ˆåŒºåˆ†add or editï¼‰</p>
<p>3ï¼‰ã€æ·»åŠ putè¯·æ±‚ --ä¸¤ä¸ªinputçš„hiddenæ ‡ç­¾</p>
<pre><code class="language-html"> &lt;form th:action=&quot;@{/emp}&quot; method=&quot;post&quot;&gt;
        &lt;!--å‘é€putè¯·æ±‚--&gt;
        &lt;!--1.SpringMVCé…ç½®HiddenHttpMethodFilter
            2.é¡µé¢åˆ›å»ºä¸€ä¸ªpostè¡¨å•
            3.åˆ›å»ºä¸€ä¸ª input name_method å€¼å°±æ˜¯æˆ‘ä»¬è¯·æ±‚çš„æ–¹å¼--&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;put&quot; th:if=&quot;${emp!=null}&quot;&gt;

        &lt;input type=&quot;hidden&quot; name=&quot;id&quot; th:value=&quot;${emp.id}&quot; th:if=&quot;${emp!=null}&quot;&gt;
        &lt;!-- LastName --&gt;
        &lt;div class=&quot;form-group&quot;&gt;
            &lt;label for=&quot;LastName&quot;&gt;LastName&lt;/label&gt;
            &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;LastName&quot; name=&quot;lastName&quot; placeholder=&quot;LastName&quot; th:value=&quot;${emp!=null}?${emp.lastName}&quot;&gt;
        &lt;/div&gt;
        &lt;!-- Email --&gt;
        &lt;div class=&quot;form-group&quot;&gt;
            &lt;label for=&quot;Email&quot;&gt;Email&lt;/label&gt;
            &lt;input type=&quot;email&quot; class=&quot;form-control&quot; id=&quot;Email&quot;  name=&quot;email&quot; placeholder=&quot;zhangsan@163.com&quot; th:value=&quot;${emp!=null}?${emp.email}&quot;&gt;
        &lt;/div&gt;
        &lt;!--gender--&gt;
        &lt;div class=&quot;form-group&quot;&gt;
            &lt;label &gt;Gender&lt;/label&gt;&lt;br/&gt;
            &lt;div class=&quot;form-check form-check-inline&quot;&gt;
                &lt;input class=&quot;form-check-input&quot; type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;1&quot; th:checked=&quot;${emp!=null}?${emp.gender}==1&quot;&gt;
                &lt;label class=&quot;form-check-label&quot; &gt;ç”·&lt;/label&gt;
            &lt;/div&gt;
            &lt;div class=&quot;form-check form-check-inline&quot;&gt;
                &lt;input class=&quot;form-check-input&quot; type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;0&quot; th:checked=&quot;${emp!=null}?${emp.gender}==0&quot;&gt;
                &lt;label class=&quot;form-check-label&quot; &gt;å¥³&lt;/label&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;!-- department --&gt;
        &lt;div class=&quot;form-group&quot;&gt;
            &lt;label &gt;department&lt;/label&gt;
            &lt;select class=&quot;form-control&quot;  name=&quot;department.id&quot; &gt;
                &lt;option th:selected=&quot;${emp!=null}?${dept.id == emp.department.id}&quot; th:each=&quot;dept:${depts}&quot; th:value=&quot;${dept.id}&quot; th:text=&quot;${dept.departmentName}&quot;&gt;&lt;/option&gt;
            &lt;/select&gt;
        &lt;/div&gt;
        &lt;div class=&quot;form-group&quot;&gt;
            &lt;label for=&quot;birthDate&quot;&gt;Birth&lt;/label&gt;
            &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;birthDate&quot; placeholder=&quot;2012-12-12&quot; name=&quot;birth&quot; th:value=&quot;${emp!=null}?${#dates.format(emp.birth,'yyyy-MM-dd HH:mm:ss')}&quot;&gt;
        &lt;/div&gt;
        &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot; th:text=&quot;${emp!=null}?'ä¿®æ”¹':'æ·»åŠ '&quot;&gt;æ·» åŠ &lt;/button&gt;
    &lt;/form&gt;
&lt;/main&gt;

</code></pre>
<h3 id="9-å‘˜å·¥åˆ é™¤åˆ ">9ã€å‘˜å·¥åˆ é™¤ï¼ˆåˆ ï¼‰</h3>
<h4 id="1-æ–°å»ºcontoller">1ã€æ–°å»ºContoller</h4>
<pre><code class="language-java">/**
 * å‘˜å·¥åˆ é™¤
 */
@DeleteMapping(value = &quot;/emp/{id}&quot;)
public String deleteEmp(@PathVariable(&quot;id&quot;) Integer id){
    employeeDao.deleteEmpById(id);
    return &quot;redirect:/emps&quot;;
}

</code></pre>
<h4 id="2-ä¿®æ”¹åˆ é™¤æ ‡ç­¾">2ã€ä¿®æ”¹åˆ é™¤æ ‡ç­¾</h4>
<pre><code class="language-html">&lt;button th:attr=&quot;del_uri=@{/emp/}+${emp.id}&quot;  class=&quot;btn btn-sm btn-danger deleteBtn&quot;&gt;
    åˆ é™¤
&lt;/button&gt;

</code></pre>
<h4 id="3-å†™formè¡¨å•">3ã€å†™Formè¡¨å•</h4>
<p>formè¡¨å•å¸è½½å¤–é¢ï¼Œinput ä¸­ name=&quot;_method&quot; value=&quot;delete&quot; æ¨¡æ‹Ÿdeleteè¯·æ±‚</p>
<pre><code class="language-html">                &lt;/tbody&gt;
            &lt;/table&gt;
        &lt;/div&gt;
    &lt;/main&gt;
    &lt;form id=&quot;deleteEmpForm&quot; method=&quot;post&quot;&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;delete&quot;&gt;
    &lt;/form&gt;
&lt;/div&gt;

</code></pre>
<h4 id="4-å†™jsæäº¤">4ã€å†™JSæäº¤</h4>
<pre><code class="language-javascript">&lt;script&gt;
    $(&quot;.deleteBtn&quot;).click(function () {
        $(&quot;#deleteEmpForm&quot;).attr(&quot;action&quot;,$(this).attr(&quot;del_uri&quot;)).submit();
        return false;
    })
&lt;/script&gt;

</code></pre>
<blockquote>
<p>return false;ç¦ç”¨btnæäº¤æ•ˆæœ</p>
</blockquote>
<h2 id="7-é”™è¯¯æœºåˆ¶çš„å¤„ç†">7ã€é”™è¯¯æœºåˆ¶çš„å¤„ç†</h2>
<h3 id="1-é»˜è®¤çš„é”™è¯¯å¤„ç†æœºåˆ¶">1ã€é»˜è®¤çš„é”™è¯¯å¤„ç†æœºåˆ¶</h3>
<p>é»˜è®¤é”™è¯¯é¡µé¢</p>
<figure data-type="image" tabindex="17"><img src="https://stormga.github.io//post-images/20.error.jpg" alt="" loading="lazy"></figure>
<p>åŸç†å‚ç…§</p>
<p>ErrorMvcAutoConfiguration:é”™è¯¯å¤„ç†çš„è‡ªåŠ¨é…ç½®</p>
<pre><code>org\springframework\boot\spring-boot-autoconfigure\1.5.12.RELEASE\spring-boot-autoconfigure-1.5.12.RELEASE.jar!\org\springframework\boot\autoconfigure\web\ErrorMvcAutoConfiguration.class


</code></pre>
<ul>
<li>
<p>DefaultErrorAttributes</p>
<p>å¸®æˆ‘ä»¬åœ¨é¡µé¢å…±äº«ä¿¡æ¯</p>
<pre><code class="language-java">@Override
public Map&lt;String, Object&gt; getErrorAttributes(RequestAttributes requestAttributes,
      boolean includeStackTrace) {
   Map&lt;String, Object&gt; errorAttributes = new LinkedHashMap&lt;String, Object&gt;();
   errorAttributes.put(&quot;timestamp&quot;, new Date());
   addStatus(errorAttributes, requestAttributes);
   addErrorDetails(errorAttributes, requestAttributes, includeStackTrace);
   addPath(errorAttributes, requestAttributes);
   return errorAttributes;
}

</code></pre>
</li>
<li>
<p>BasicErrorController</p>
<pre><code class="language-java">@Controller
@RequestMapping(&quot;${server.error.path:${error.path:/error}}&quot;)
public class BasicErrorController extends AbstractErrorController {
    //äº§ç”ŸHTMLæ•°æ®
    @RequestMapping(produces = &quot;text/html&quot;)
	public ModelAndView errorHtml(HttpServletRequest request,
			HttpServletResponse response) {
		HttpStatus status = getStatus(request);
		Map&lt;String, Object&gt; model = Collections.unmodifiableMap(getErrorAttributes(
				request, isIncludeStackTrace(request, MediaType.TEXT_HTML)));
		response.setStatus(status.value());
		ModelAndView modelAndView = resolveErrorView(request, response, status, model);
		return (modelAndView == null ? new ModelAndView(&quot;error&quot;, model) : modelAndView);
	}
	//äº§ç”ŸJsonæ•°æ®
	@RequestMapping
	@ResponseBody
	public ResponseEntity&lt;Map&lt;String, Object&gt;&gt; error(HttpServletRequest request) {
		Map&lt;String, Object&gt; body = getErrorAttributes(request,
				isIncludeStackTrace(request, MediaType.ALL));
		HttpStatus status = getStatus(request);
		return new ResponseEntity&lt;Map&lt;String, Object&gt;&gt;(body, status);
	}

</code></pre>
</li>
<li>
<p>ErrorPageCustomizer</p>
<pre><code class="language-java">@Value(&quot;${error.path:/error}&quot;)
private String path = &quot;/error&quot;;//ç³»ç»Ÿå‡ºç°é”™è¯¯ä»¥åæ¥åˆ°errorè¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œ(web.xml)

</code></pre>
</li>
<li>
<p>DefaultErrorViewResolver</p>
<pre><code class="language-java">@Override
public ModelAndView resolveErrorView(HttpServletRequest request, HttpStatus status,
      Map&lt;String, Object&gt; model) {
   ModelAndView modelAndView = resolve(String.valueOf(status), model);
   if (modelAndView == null &amp;&amp; SERIES_VIEWS.containsKey(status.series())) {
      modelAndView = resolve(SERIES_VIEWS.get(status.series()), model);
   }
   return modelAndView;
}

private ModelAndView resolve(String viewName, Map&lt;String, Object&gt; model) {
    //é»˜è®¤SpringBootå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªé¡µé¢ï¼Ÿerror/çŠ¶æ€ç 
   String errorViewName = &quot;error/&quot; + viewName;
    //å¦‚æœæ¨¡æ¿å¼•æ“å¯ä»¥è§£æåœ°å€ï¼Œå°±è¿”å›æ¨¡æ¿å¼•æ“è§£æ
   TemplateAvailabilityProvider provider = this.templateAvailabilityProviders
         .getProvider(errorViewName, this.applicationContext);
   if (provider != null) {
       //æœ‰æ¨¡æ¿å¼•æ“å°±è¿”å›åˆ°errorViewNameæŒ‡å®šçš„è§†å›¾åœ°å€
      return new ModelAndView(errorViewName, model);
   }
    //è‡ªå·±çš„æ–‡ä»¶ å°±åœ¨é™æ€æ–‡ä»¶å¤¹ä¸‹æ‰¾é™æ€æ–‡ä»¶ /é™æ€èµ„æºæ–‡ä»¶å¤¹/404.html
   return resolveResource(errorViewName, model);
}

</code></pre>
</li>
</ul>
<p>ä¸€æ—¦ç³»ç»Ÿå‡ºç°4xxæˆ–è€…5xxé”™è¯¯ ErrorPageCustomizerå°±å›æ¥å®šåˆ¶é”™è¯¯çš„å“åº”è§„åˆ™,å°±ä¼šæ¥åˆ° /errorè¯·æ±‚,BasicErrorControllerå¤„ç†ï¼Œå°±æ˜¯ä¸€ä¸ªController</p>
<p>1.å“åº”é¡µé¢,å»å“ªä¸ªé¡µé¢æ˜¯ç”± DefaultErrorViewResolver æ‹¿åˆ°æ‰€æœ‰çš„é”™è¯¯è§†å›¾</p>
<pre><code class="language-java">protected ModelAndView resolveErrorView(HttpServletRequest request,
      HttpServletResponse response, HttpStatus status, Map&lt;String, Object&gt; model) {
   for (ErrorViewResolver resolver : this.errorViewResolvers) {
      ModelAndView modelAndView = resolver.resolveErrorView(request, status, model);
      if (modelAndView != null) {
         return modelAndView;
      }
   }
   return null;
}

</code></pre>
<p>læµè§ˆå™¨å‘é€è¯·æ±‚ accpt:text/html</p>
<p>å®¢æˆ·ç«¯è¯·æ±‚ï¼šaccept:/*</p>
<h3 id="2-å¦‚ä½•å®šåˆ¶é”™è¯¯å“åº”">2ã€å¦‚ä½•å®šåˆ¶é”™è¯¯å“åº”</h3>
<p>â€‹	1ï¼‰ã€å¦‚ä½•å®šåˆ¶é”™è¯¯çš„é¡µé¢</p>
<p>â€‹		1.æœ‰æ¨¡æ¿å¼•æ“ï¼šé™æ€èµ„æº/404.html,ä»€ä¹ˆé”™è¯¯ä»€ä¹ˆé¡µé¢ï¼›æ‰€æœ‰ä»¥4å¼€å¤´çš„ 4xx.html 5å¼€å¤´çš„5xx.html</p>
<p>â€‹		æœ‰ç²¾ç¡®çš„404å’Œ4xxä¼˜å…ˆé€‰æ‹©404</p>
<p>â€‹		é¡µé¢è·å¾—çš„æ•°æ®</p>
<p>â€‹			timestampï¼šæ—¶é—´æˆ³</p>
<p>â€‹			statusï¼šçŠ¶æ€ç </p>
<p>â€‹			errorï¼šé”™è¯¯æç¤º</p>
<p>â€‹			exceptionï¼šå¼‚å¸¸å¯¹è±¡</p>
<p>â€‹			messageï¼šå¼‚å¸¸ä¿¡æ¯</p>
<p>â€‹			errors:JSR303æœ‰å…³</p>
<p>â€‹		2.æ²¡æœ‰æ”¾åœ¨æ¨¡æ¿å¼•æ“ï¼Œæ”¾åœ¨é™æ€æ–‡ä»¶å¤¹ï¼Œä¹Ÿå¯ä»¥æ˜¾ç¤ºï¼Œå°±æ˜¯æ²¡æ³•ä½¿ç”¨æ¨¡æ¿å–å€¼</p>
<p>â€‹		3.æ²¡æœ‰æ”¾æ¨¡æ¿å¼•æ“ï¼Œæ²¡æ”¾é™æ€ï¼Œä¼šæ˜¾ç¤ºé»˜è®¤çš„é”™è¯¯</p>
<p>â€‹	2ï¼‰ã€å¦‚ä½•å®šä¹‰é”™è¯¯çš„æ•°æ®</p>
<p>ä¸¾ä¾‹å­ï¼šæ–°å»º4xxå’Œ5xxæ–‡ä»¶</p>
<figure data-type="image" tabindex="18"><img src="https://stormga.github.io//post-images/21.error-static.jpg" alt="" loading="lazy"></figure>
<pre><code class="language-html">&lt;body &gt;
    &lt;p&gt;status: [[${status}]]&lt;/p&gt;
    &lt;p&gt;timestamp: [[${timestamp}]]&lt;/p&gt;
    &lt;p&gt;error: [[${error}]]&lt;/p&gt;
    &lt;p&gt;message: [[${message}]]&lt;/p&gt;
    &lt;p&gt;exception: [[${exception}]]&lt;/p&gt;
&lt;/body&gt;

</code></pre>
<figure data-type="image" tabindex="19"><img src="https://stormga.github.io//post-images/22.4xxhtml.jpg" alt="" loading="lazy"></figure>
<h3 id="3-å¦‚ä½•å®šåˆ¶jsonæ•°æ®">3ã€å¦‚ä½•å®šåˆ¶Jsonæ•°æ®</h3>
<h4 id="1-ä»…å‘é€jsonæ•°æ®">1ã€ä»…å‘é€jsonæ•°æ®</h4>
<pre><code class="language-java">public class UserNotExitsException extends  RuntimeException {
    public UserNotExitsException(){
        super(&quot;ç”¨æˆ·ä¸å­˜åœ¨&quot;);
    }
}

</code></pre>
<pre><code class="language-java">/**
 * å¼‚å¸¸å¤„ç†å™¨
 */
@ControllerAdvice
public class MyExceptionHandler {

    @ResponseBody
    @ExceptionHandler(UserNotExitsException.class)
    public Map&lt;String ,Object&gt; handlerException(Exception e){
        Map&lt;String ,Object&gt; map =new HashMap&lt;&gt;();
        map.put(&quot;code&quot;, &quot;user not exist&quot;);
        map.put(&quot;message&quot;, e.getMessage());
        return map;
    }
}

</code></pre>
<p>æ— æ³•è‡ªé€‚åº” éƒ½æ˜¯è¿”å›çš„jsonæ•°æ®</p>
<h4 id="2-è½¬å‘åˆ°errorè‡ªé€‚åº”å¤„ç†">2ã€è½¬å‘åˆ°errorè‡ªé€‚åº”å¤„ç†</h4>
<pre><code class="language-java">@ExceptionHandler(UserNotExitsException.class)
public String handlerException(Exception e, HttpServletRequest request){
    Map&lt;String ,Object&gt; map =new HashMap&lt;&gt;();
    //ä¼ å…¥è‡ªå·±çš„çŠ¶æ€ç 
    request.setAttribute(&quot;javax.servlet.error.status_code&quot;, 432);
    map.put(&quot;code&quot;, &quot;user not exist&quot;);
    map.put(&quot;message&quot;, e.getMessage());
    //è½¬å‘åˆ°error
    return &quot;forward:/error&quot;;
}

</code></pre>
<p>ç¨‹åºé»˜è®¤è·å–çŠ¶æ€ç </p>
<pre><code class="language-java">protected HttpStatus getStatus(HttpServletRequest request) {
   Integer statusCode = (Integer) request
         .getAttribute(&quot;javax.servlet.error.status_code&quot;);
   if (statusCode == null) {
      return HttpStatus.INTERNAL_SERVER_ERROR;
   }
   try {
      return HttpStatus.valueOf(statusCode);
   }
   catch (Exception ex) {
      return HttpStatus.INTERNAL_SERVER_ERROR;
   }

</code></pre>
<p>æ²¡æœ‰è‡ªå·±å†™çš„è‡ªå®šä¹‰å¼‚å¸¸æ•°æ®</p>
<h4 id="3-è‡ªé€‚åº”å’Œå®šåˆ¶æ•°æ®ä¼ å…¥">3ã€è‡ªé€‚åº”å’Œå®šåˆ¶æ•°æ®ä¼ å…¥</h4>
<p>Spring é»˜è®¤çš„åŸç†ï¼Œå‡ºç°é”™è¯¯åå›æ¥åˆ°errorè¯·æ±‚ï¼Œä¼šè¢«BasicErrorControllerå¤„ç†,å“åº”å‡ºå»çš„æ•°æ®æ˜¯ç”±BasicErrorControllerçš„çˆ¶ç±»AbstractErrorController(ErrorController)è§„å®šçš„æ–¹æ³•getAttributeså¾—åˆ°çš„ï¼›</p>
<p>1ã€ç¼–å†™ä¸€ä¸ªErrorControllerçš„å®ç°ç±»ã€æˆ–è€…AbstractErrorControllerçš„å­ç±»ã€‘ï¼Œæ”¾åœ¨å®¹å™¨ä¸­ï¼›</p>
<p>2ã€é¡µé¢ä¸Šèƒ½ç”¨çš„æ•°æ®ï¼Œæˆ–è€…æ˜¯jsonæ•°æ®è¿”å›èƒ½ç”¨çš„æ•°æ®éƒ½æ˜¯é€šè¿‡errorAttributes.getErrorAttributeså¾—åˆ°ï¼›</p>
<p>å®¹å™¨ä¸­çš„DefaultErrorAtrributes.getErrorAtrributees();é»˜è®¤è¿›è¡Œæ•°æ®å¤„ç†</p>
<pre><code class="language-java">public class MyErrorAttributes extends DefaultErrorAttributes {
    @Override
    public Map&lt;String, Object&gt; getErrorAttributes(RequestAttributes requestAttributes, boolean includeStackTrace) {
        Map&lt;String, Object&gt; map = super.getErrorAttributes(requestAttributes, includeStackTrace);
        map.put(&quot;company&quot;, &quot;wdjr&quot;);
        return map;
    }
}

</code></pre>
<p>å¼‚å¸¸å¤„ç†ï¼šæŠŠmapæ–¹æ³•è¯·æ±‚åŸŸä¸­</p>
<pre><code class="language-java">    @ExceptionHandler(UserNotExitsException.class)
    public String handlerException(Exception e, HttpServletRequest request){
        Map&lt;String ,Object&gt; map =new HashMap&lt;&gt;();
        //ä¼ å…¥è‡ªå·±çš„çŠ¶æ€ç 
        request.setAttribute(&quot;javax.servlet.error.status_code&quot;, 432);
        map.put(&quot;code&quot;, &quot;user not exist&quot;);
        map.put(&quot;message&quot;, e.getMessage());
        request.setAttribute(&quot;ext&quot;, map);
        //è½¬å‘åˆ°error
        return &quot;forward:/error&quot;;
    }
}

</code></pre>
<p>åœ¨ä¸Šé¢çš„MyErrorAttributesç±»ä¸­åŠ ä¸Š</p>
<pre><code class="language-java">//æˆ‘ä»¬çš„å¼‚å¸¸å¤„ç†å™¨
Map&lt;String,Object&gt; ext = (Map&lt;String, Object&gt;) requestAttributes.getAttribute(&quot;ext&quot;, 0);
map.put(&quot;ext&quot;, ext);

</code></pre>
<h2 id="8-é…ç½®åµŒå…¥å¼servletå®¹å™¨">8ã€é…ç½®åµŒå…¥å¼servletå®¹å™¨</h2>
<h3 id="1-å®šåˆ¶å’Œä¿®æ”¹servletå®¹å™¨">1ã€å®šåˆ¶å’Œä¿®æ”¹Servletå®¹å™¨</h3>
<p>SpringBooté»˜è®¤ä½¿ç”¨Tomcatä½œä¸ºåµŒå…¥å¼çš„Servletå®¹å™¨ï¼›</p>
<p>![](https://stormga.github.io//post-images/23.tomcat emd.jpg)</p>
<p>é—®é¢˜ï¼Ÿ</p>
<p>1ï¼‰ã€å¦‚ä½•å®šåˆ¶å’Œä¿®æ”¹Servletå®¹å™¨ï¼›</p>
<p>1ã€ ä¿®æ”¹Serverç›¸å…³çš„é…ç½®æ–‡ä»¶ application.properties</p>
<pre><code class="language-properties">#é€šç”¨çš„servletå®¹å™¨é…ç½®
server.xxx
#tomcatçš„é…ç½®
server.tomcat.xxxx

</code></pre>
<p>2ã€ç¼–å†™ä¸€ä¸ªEmbeddedServletContainerCustomizer;åµŒå…¥å¼çš„Servletå®¹å™¨çš„å®šåˆ¶å™¨ï¼›æ¥ä¿®æ”¹Servletçš„å®¹å™¨é…ç½®</p>
<pre><code class="language-java">@Bean
public EmbeddedServletContainerCustomizer embeddedServletContainerCustomizer(){
    return new EmbeddedServletContainerCustomizer() {
        //å®šåˆ¶åµŒå…¥å¼Servletçš„å®¹å™¨ç›¸å…³è§„åˆ™
        @Override
        public void customize(ConfigurableEmbeddedServletContainer container) {
            container.setPort(8999);
        }
    };
}

</code></pre>
<p>å…¶å®åŒç†ï¼Œéƒ½æ˜¯å®ç°EmbeddedServletContainerCustomizer</p>
<h3 id="2-æ³¨å†Œservletä¸‰å¤§ç»„ä»¶">2ã€æ³¨å†ŒServletä¸‰å¤§ç»„ä»¶</h3>
<p>ä¸‰å¤§ç»„ä»¶ Servlet Filter Listener</p>
<p>ç”±äºSprringBooté»˜è®¤æ˜¯ä»¥jaråŒ…å¯åŠ¨åµŒå…¥å¼çš„Servletå®¹å™¨æ¥å¯åŠ¨SpringBootçš„webåº”ç”¨ï¼Œæ²¡æœ‰web.xml</p>
<p>æ³¨å†Œä¸‰å¤§ç»„ä»¶</p>
<h4 id="servletregistrationbean">ServletRegistrationBean</h4>
<pre><code class="language-java">@Bean
public ServletRegistrationBean myServlet(){
    ServletRegistrationBean servletRegistrationBean = new ServletRegistrationBean(new MyServlet(),&quot;/servlet&quot;);
    return servletRegistrationBean;
}

</code></pre>
<p>MyServlet</p>
<pre><code class="language-java">public class MyServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        resp.getWriter().write(&quot;Hello Servlet&quot;);
    }
}

</code></pre>
<h4 id="filterregistrationbean">FilterRegistrationBean</h4>
<pre><code class="language-java">@Bean
public FilterRegistrationBean myFilter(){
    FilterRegistrationBean filterRegistrationBean = new FilterRegistrationBean();
    filterRegistrationBean.setFilter(new MyFilter());
    filterRegistrationBean.setUrlPatterns(Arrays.asList(&quot;/hello&quot;,&quot;/myServlet&quot;));
    return filterRegistrationBean;
}

</code></pre>
<p>MyFilter</p>
<pre><code class="language-java">public class MyFilter implements Filter {
    @Override
    public void init(FilterConfig filterConfig) throws ServletException {

    }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        System.out.println(&quot;MyFilter process&quot;);
        chain.doFilter(request, response);
    }

    @Override
    public void destroy() {

    }
}

</code></pre>
<h4 id="servletlistenerregistrationbean">ServletListenerRegistrationBean</h4>
<pre><code class="language-java">@Bean
public ServletListenerRegistrationBean myListener(){
    ServletListenerRegistrationBean&lt;MyListener&gt; registrationBean = new ServletListenerRegistrationBean&lt;&gt;(new MyListener());
    return registrationBean;
}

</code></pre>
<p>MyListener</p>
<pre><code class="language-java">public class MyListener implements ServletContextListener {
    @Override
    public void contextInitialized(ServletContextEvent sce) {
        System.out.println(&quot;.........webåº”ç”¨å¯åŠ¨..........&quot;);
    }

    @Override
    public void contextDestroyed(ServletContextEvent sce) {
        System.out.println(&quot;.........webåº”ç”¨é”€æ¯..........&quot;);
    }
}

</code></pre>
<p>SpringBootå¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨é…ç½®SpringMVCçš„æ—¶å€™ï¼Œè‡ªåŠ¨æ³¨å†ŒSpringMVCçš„å‰ç«¯æ§åˆ¶å™¨ï¼›DispatcherServlet;</p>
<pre><code class="language-java">@Bean(name = DEFAULT_DISPATCHER_SERVLET_REGISTRATION_BEAN_NAME)
@ConditionalOnBean(value = DispatcherServlet.class, name = DEFAULT_DISPATCHER_SERVLET_BEAN_NAME)
   public ServletRegistrationBean dispatcherServletRegistration(
         DispatcherServlet dispatcherServlet) {
      ServletRegistrationBean registration = new ServletRegistrationBean(
            dispatcherServlet, this.serverProperties.getServletMapping());
       //é»˜è®¤æ‹¦æˆª /æ‰€æœ‰è¯·æ±‚ åŒ…æ‹¬é™æ€èµ„æº ä¸åŒ…æ‹¬jsp
       //å¯ä»¥é€šè¿‡server.servletPathæ¥ä¿®æ”¹SpringMVCå‰ç«¯æ§åˆ¶å™¨é»˜è®¤æ‹¦æˆªçš„è¯·æ±‚è·¯å¾„
      registration.setName(DEFAULT_DISPATCHER_SERVLET_BEAN_NAME);
      registration.setLoadOnStartup(
            this.webMvcProperties.getServlet().getLoadOnStartup());
      if (this.multipartConfig != null) {
         registration.setMultipartConfig(this.multipartConfig);
      }
      return registration;
   }

}

</code></pre>
<h3 id="3-åˆ‡æ¢å…¶ä»–çš„servletå®¹å™¨">3ã€åˆ‡æ¢å…¶ä»–çš„Servletå®¹å™¨</h3>
<p>åœ¨ServerPropertiesä¸­</p>
<pre><code class="language-java">private final Tomcat tomcat = new Tomcat();

private final Jetty jetty = new Jetty();

private final Undertow undertow = new Undertow();

</code></pre>
<p>tomcat(é»˜è®¤æ”¯æŒ)</p>
<p>jettyï¼ˆé•¿è¿æ¥ï¼‰</p>
<p>undertowï¼ˆå¤šå¹¶å‘ï¼‰</p>
<p>åˆ‡æ¢å®¹å™¨ ä»…ä»…éœ€è¦ä¿®æ”¹pomæ–‡ä»¶çš„ä¾èµ–å°±å¯ä»¥</p>
<pre><code class="language-xml">        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
            &lt;exclusions&gt;
                &lt;exclusion&gt;
                    &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
                    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-jetty&lt;/artifactId&gt;
        &lt;/dependency&gt;
&lt;!--        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-undertow&lt;/artifactId&gt;
        &lt;/dependency&gt;--&gt;

</code></pre>
<h3 id="4-åµŒå…¥å¼servletå®¹å™¨è‡ªåŠ¨é…ç½®åŸç†">4ã€åµŒå…¥å¼Servletå®¹å™¨è‡ªåŠ¨é…ç½®åŸç†</h3>
<pre><code class="language-java">@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE)
@Configuration
@ConditionalOnWebApplication
@Import(BeanPostProcessorsRegistrar.class)
//ç»™å®¹å™¨å¯¼å…¥ç»„ä»¶ åç½®å¤„ç†å™¨ åœ¨Beanåˆå§‹åŒ–å‰åæ‰§è¡Œå‰ç½®åç½®çš„é€»è¾‘ åˆ›å»ºå®Œå¯¹è±¡è¿˜æ²¡å±æ€§èµ‹å€¼è¿›è¡Œåˆå§‹åŒ–å·¥ä½œ
public class EmbeddedServletContainerAutoConfiguration {
    @Configuration
	@ConditionalOnClass({ Servlet.class, Tomcat.class })//å½“å‰æ˜¯å¦å¼•å…¥tomcatä¾èµ–
    //åˆ¤æ–­å½“å‰å®¹å™¨æ²¡æœ‰ç”¨æˆ·è‡ªå®šä¹‰EmbeddedServletContainerFactoryï¼Œå°±ä¼šåˆ›å»ºé»˜è®¤çš„åµŒå…¥å¼å®¹å™¨
	@ConditionalOnMissingBean(value = EmbeddedServletContainerFactory.class, search = SearchStrategy.CURRENT)
	public static class EmbeddedTomcat {

		@Bean
		public TomcatEmbeddedServletContainerFactory tomcatEmbeddedServletContainerFactory() {
			return new TomcatEmbeddedServletContainerFactory();
		}

</code></pre>
<p>1ï¼‰ã€EmbeddedServletContainerFactoryï¼ˆåµŒå…¥å¼Servletå®¹å™¨å·¥å‚ï¼‰</p>
<pre><code class="language-java">public interface EmbeddedServletContainerFactory {
	//è·å–åµŒå…¥å¼çš„Servletå®¹å™¨
   EmbeddedServletContainer getEmbeddedServletContainer(
         ServletContextInitializer... initializers);

}

</code></pre>
<p>ç»§æ‰¿å…³ç³»</p>
<figure data-type="image" tabindex="20"><img src="https://stormga.github.io//post-images/24.EmdServletFactory.jpg" alt="" loading="lazy"></figure>
<p>2ï¼‰ã€EmbeddedServletContainer:(åµŒå…¥å¼çš„Servletå®¹å™¨)</p>
<figure data-type="image" tabindex="21"><img src="https://stormga.github.io//post-images/25.EmdServletContainer.jpg" alt="" loading="lazy"></figure>
<p>3ï¼‰ã€TomcatEmbeddedServletContainerFactoryä¸ºä¾‹</p>
<pre><code class="language-java">@Override
public EmbeddedServletContainer getEmbeddedServletContainer(
      ServletContextInitializer... initializers) {
   Tomcat tomcat = new Tomcat();
    //é…ç½®tomcatçš„åŸºæœ¬ç¯èŠ‚
   File baseDir = (this.baseDirectory != null ? this.baseDirectory
         : createTempDir(&quot;tomcat&quot;));
   tomcat.setBaseDir(baseDir.getAbsolutePath());
   Connector connector = new Connector(this.protocol);
   tomcat.getService().addConnector(connector);
   customizeConnector(connector);
   tomcat.setConnector(connector);
   tomcat.getHost().setAutoDeploy(false);
   configureEngine(tomcat.getEngine());
   for (Connector additionalConnector : this.additionalTomcatConnectors) {
      tomcat.getService().addConnector(additionalConnector);
   }
   prepareContext(tomcat.getHost(), initializers);
    //å°†é…ç½®å¥½çš„tomcatä¼ å…¥è¿›å»ï¼›å¹¶ä¸”å¯åŠ¨tomcatå®¹å™¨
   return getTomcatEmbeddedServletContainer(tomcat);
}

</code></pre>
<p>4ï¼‰ã€åµŒå…¥å¼é…ç½®ä¿®æ”¹</p>
<pre><code>ServerPropertiesã€EmbeddedServletContainerCustomizer

</code></pre>
<p>EmbeddedServletContainerCustomizer:å®šåˆ¶å™¨å¸®æˆ‘ä»¬ä¿®æ”¹äº†Servletå®¹å™¨é…ç½®ï¼Ÿ</p>
<p>æ€ä¹ˆä¿®æ”¹ï¼Ÿ</p>
<p>5ï¼‰ã€å®¹å™¨ä¸­å¯¼å…¥äº†<strong>EmbeddedServletContainerCustomizerBeanPostProcessor</strong></p>
<pre><code class="language-java">@Override
public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata,
      BeanDefinitionRegistry registry) {
   if (this.beanFactory == null) {
      return;
   }
   registerSyntheticBeanIfMissing(registry,
         &quot;embeddedServletContainerCustomizerBeanPostProcessor&quot;,
         EmbeddedServletContainerCustomizerBeanPostProcessor.class);
   registerSyntheticBeanIfMissing(registry,
         &quot;errorPageRegistrarBeanPostProcessor&quot;,
         ErrorPageRegistrarBeanPostProcessor.class);
}

</code></pre>
<pre><code class="language-java">@Override
public Object postProcessBeforeInitialization(Object bean, String beanName)
      throws BeansException {
    //å¦‚æœå½“å‰åˆå§‹åŒ–çš„æ˜¯ä¸€ä¸ªConfigurableEmbeddedServletContainer
   if (bean instanceof ConfigurableEmbeddedServletContainer) {
      postProcessBeforeInitialization((ConfigurableEmbeddedServletContainer) bean);
   }
   return bean;
}

private void postProcessBeforeInitialization(
    ConfigurableEmbeddedServletContainer bean) {
    //è·å–æ‰€æœ‰çš„å®šåˆ¶å™¨ï¼Œè°ƒç”¨æ¯ä¸ªå®šåˆ¶å™¨çš„customeræ–¹æ³•ç»™Servletå®¹å™¨è¿›è¡Œèµ‹å€¼
    for (EmbeddedServletContainerCustomizer customizer : getCustomizers()) {
        customizer.customize(bean);
    }
}

private Collection&lt;EmbeddedServletContainerCustomizer&gt; getCustomizers() {
    if (this.customizers == null) {
        // Look up does not include the parent context
        this.customizers = new ArrayList&lt;EmbeddedServletContainerCustomizer&gt;(
            this.beanFactory
            //ä»å®¹å™¨ä¸­è·å–æ‰€æœ‰çš„è¿™ä¸ªç±»å‹çš„ç»„ä»¶ï¼šEmbeddedServletContainerCustomizer
            //å®šåˆ¶Servlet,ç»™å®¹å™¨ä¸­å¯ä»¥æ·»åŠ ä¸€ä¸ªEmbeddedServletContainerCustomizerç±»å‹çš„ç»„ä»¶
            .getBeansOfType(EmbeddedServletContainerCustomizer.class,
                            false, false)
            .values());
        Collections.sort(this.customizers, AnnotationAwareOrderComparator.INSTANCE);
        this.customizers = Collections.unmodifiableList(this.customizers);
    }
    return this.customizers;
}

</code></pre>
<p>ServerPropertiesä¹Ÿæ˜¯EmbeddedServletContainerCustomizerå®šåˆ¶å™¨</p>
<p>æ­¥éª¤ï¼š</p>
<p>1ï¼‰ã€SpringBootæ ¹æ®å¯¼å…¥çš„ä¾èµ–æƒ…å†µï¼Œç»™å®¹å™¨ä¸­æ·»åŠ å“åº”çš„å®¹å™¨å·¥å‚ ä¾‹ï¼štomcat</p>
<p>EmbeddedServletContainerFactoryã€TomcatEmbeddedServletContainerFactoryã€‘</p>
<p>2ï¼‰ã€å®¹å™¨ä¸­æŸä¸ªç»„ä»¶è¦åˆ›å»ºå¯¹è±¡å°±è¦é€šè¿‡åç½®å¤„ç†å™¨ï¼›</p>
<pre><code class="language-java">EmbeddedServletContainerCustomizerBeanPostProcessor

</code></pre>
<p>åªè¦æ˜¯åµŒå…¥å¼çš„Servletå®¹å™¨å·¥å‚ï¼Œåç½®å¤„ç†å™¨å°±å·¥ä½œï¼›</p>
<p>3ï¼‰ã€åç½®å¤„ç†å™¨ï¼Œä»å®¹å™¨ä¸­è·å–çš„æ‰€æœ‰çš„EmbeddedServletContainerCustomizerï¼Œè°ƒç”¨å®šåˆ¶å™¨çš„å®šåˆ¶æ–¹æ³•</p>
<h3 id="5-åµŒå…¥å¼servletå®¹å™¨å¯åŠ¨åŸç†">5ã€åµŒå…¥å¼Servletå®¹å™¨å¯åŠ¨åŸç†</h3>
<p>ä»€ä¹ˆæ—¶å€™åˆ›å»ºåµŒå…¥å¼çš„Servletçš„å®¹å™¨å·¥å‚ï¼Ÿä»€ä¹ˆæ—¶å€™è·å–åµŒå…¥å¼çš„Servletå®¹å™¨å¹¶å¯åŠ¨Tomcat;</p>
<p>è·å–åµŒå…¥å¼çš„å®¹å™¨å·¥å‚</p>
<p>1ï¼‰ã€SpringBootåº”ç”¨å¯åŠ¨Runæ–¹æ³•</p>
<p>2ï¼‰ã€åˆ·æ–°IOCå®¹å™¨å¯¹è±¡ã€åˆ›å»ºIOCå®¹å™¨å¯¹è±¡ï¼Œå¹¶åˆå§‹åŒ–å®¹å™¨ï¼Œåˆ›å»ºå®¹å™¨çš„æ¯ä¸€ä¸ªç»„ä»¶ã€‘ï¼›å¦‚æœæ˜¯webç¯å¢ƒAnnotationConfigEmbeddedWebApplicationContext,å¦‚æœä¸æ˜¯AnnotationConfigApplicationContext</p>
<pre><code class="language-JAVA">if (contextClass == null) {
   try {
      contextClass = Class.forName(this.webEnvironment
            ? DEFAULT_WEB_CONTEXT_CLASS : DEFAULT_CONTEXT_CLASS);
   }

</code></pre>
<p>3ï¼‰ã€refresh(context);åˆ·æ–°åˆ›å»ºå¥½çš„IOCå®¹å™¨</p>
<pre><code class="language-java">try {
   // Allows post-processing of the bean factory in context subclasses.
   postProcessBeanFactory(beanFactory);

   // Invoke factory processors registered as beans in the context.
   invokeBeanFactoryPostProcessors(beanFactory);

   // Register bean processors that intercept bean creation.
   registerBeanPostProcessors(beanFactory);

   // Initialize message source for this context.
   initMessageSource();

   // Initialize event multicaster for this context.
   initApplicationEventMulticaster();

   // Initialize other special beans in specific context subclasses.
   onRefresh();

   // Check for listener beans and register them.
   registerListeners();

   // Instantiate all remaining (non-lazy-init) singletons.
   finishBeanFactoryInitialization(beanFactory);

   // Last step: publish corresponding event.
   finishRefresh();
}

</code></pre>
<p>4ï¼‰ã€ onRefresh();webçš„iocå®¹å™¨é‡å†™äº†onRefreshæ–¹æ³•</p>
<p>5ï¼‰ã€webiocä¼šåˆ›å»ºåµŒå…¥å¼çš„Servletå®¹å™¨ï¼›createEmbeddedServletContainer</p>
<p>6ï¼‰ã€è·å–åµŒå…¥å¼çš„Servletå®¹å™¨å·¥å‚ï¼›</p>
<pre><code class="language-java">EmbeddedServletContainerFactory containerFactory = getEmbeddedServletContainerFactory();

</code></pre>
<p>ä»iocå®¹å™¨ä¸­è·å–EmbeddedServletContainerFactoryç»„ä»¶ï¼›</p>
<pre><code class="language-java">@Bean
public TomcatEmbeddedServletContainerFactory tomcatEmbeddedServletContainerFactory() {
return new TomcatEmbeddedServletContainerFactory();
}

</code></pre>
<p>TomcatEmbeddedServletContainerFactoryåˆ›å»ºå¯¹è±¡ï¼Œåç½®å¤„ç†å™¨çœ‹è¿™ä¸ªå¯¹è±¡ï¼Œå°±æ¥è·å–æ‰€æœ‰çš„å®šåˆ¶å™¨æ¥å®šåˆ¶Servletå®¹å™¨çš„ç›¸å…³é…ç½®ï¼›</p>
<p>7ï¼‰ã€ä½¿ç”¨å®¹å™¨å·¥å‚è·å–åµŒå…¥å¼çš„Servletå®¹å™¨</p>
<p>8ï¼‰ã€åµŒå…¥å¼çš„Servletå®¹å™¨åˆ›å»ºå¯¹è±¡å¹¶å¯åŠ¨Servletå®¹å™¨ï¼›</p>
<p>å…ˆå¯åŠ¨åµŒå…¥å¼çš„Servletå®¹å™¨ï¼Œåœ¨å°†iocå®¹å™¨ä¸­å‰©ä¸‹çš„æ²¡æœ‰åˆ›å»ºå‡ºçš„å¯¹è±¡è·å–å‡ºæ¥</p>
<p>iocå¯åŠ¨åˆ›å»ºServletå®¹å™¨</p>
<h2 id="9-ä½¿ç”¨å¤–ç½®çš„servletå®¹å™¨">9ã€ä½¿ç”¨å¤–ç½®çš„Servletå®¹å™¨</h2>
<p>åµŒå…¥å¼çš„Servletå®¹å™¨ï¼šåº”ç”¨è¾¾æˆjaråŒ…</p>
<p>â€‹	ä¼˜ç‚¹ï¼šç®€å•ã€ä¾¿æº</p>
<p>â€‹	ç¼ºç‚¹ï¼šé»˜è®¤ä¸æ”¯æŒJSPã€ä¼˜åŒ–å®šåˆ¶æ¯”è¾ƒå¤æ‚ï¼ˆä½¿ç”¨å®šåˆ¶å™¨ã€ServerPropertiesã€è‡ªå®šä¹‰å®šåˆ¶å™¨ã€‘ï¼Œè‡ªå·±æ¥ç¼–å†™åµŒå…¥å¼çš„å®¹å™¨å·¥å‚ï¼‰</p>
<p>å¤–ç½®çš„Servletå®¹å™¨ï¼šå¤–é¢å®‰è£…Tomcatæ˜¯ä»¥waråŒ…çš„æ–¹å¼æ‰“åŒ…ã€‚</p>
<h3 id="1-ideaæ“ä½œå¤–éƒ¨servlet">1ã€IDEAæ“ä½œå¤–éƒ¨Servlet</h3>
<p>1ã€åˆ›å»ºç¨‹åºä¸ºwarç¨‹åº</p>
<figure data-type="image" tabindex="22"><img src="https://stormga.github.io//post-images/26.tomcat1.jpg" alt="" loading="lazy"></figure>
<p>2ã€é€‰æ‹©ç‰ˆæœ¬</p>
<figure data-type="image" tabindex="23"><img src="https://stormga.github.io//post-images/27.tomcat2.jpg" alt="" loading="lazy"></figure>
<p>3ã€æ·»åŠ tomcat</p>
<figure data-type="image" tabindex="24"><img src="https://stormga.github.io//post-images/28.tomcat3.jpg" alt="" loading="lazy"></figure>
<p>4ã€é€‰æ‹©tomcat</p>
<figure data-type="image" tabindex="25"><img src="https://stormga.github.io//post-images/30.tomcat4.jpg" alt="" loading="lazy"></figure>
<p>5ã€é€‰æ‹©æœ¬åœ°çš„Tomcat</p>
<figure data-type="image" tabindex="26"><img src="https://stormga.github.io//post-images/31.tomcat5.jpg" alt="" loading="lazy"></figure>
<p>6ã€é…ç½®tomcatè·¯å¾„</p>
<figure data-type="image" tabindex="27"><img src="https://stormga.github.io//post-images/32.tomcat6.jpg" alt="" loading="lazy"></figure>
<p>7ã€æ·»åŠ æœåŠ¡å™¨</p>
<figure data-type="image" tabindex="28"><img src="https://stormga.github.io//post-images/33.tomcat7.jpg" alt="" loading="lazy"></figure>
<p>8ã€æ·»åŠ explodedçš„waré…ç½®ï¼Œåº”ç”¨OK tomcaté…ç½®å®Œæˆ</p>
<figure data-type="image" tabindex="29"><img src="https://stormga.github.io//post-images/34.tomcat8.jpg" alt="" loading="lazy"></figure>
<p>äºŒã€é…ç½®webappæ–‡ä»¶å¤¹</p>
<p>1ã€ç‚¹å‡»é…ç½®</p>
<figure data-type="image" tabindex="30"><img src="https://stormga.github.io//post-images/35.tomcat9.jpg" alt="" loading="lazy"></figure>
<p>2ã€æ·»åŠ webappç›®å½•</p>
<figure data-type="image" tabindex="31"><img src="https://stormga.github.io//post-images/36.tomcat10.jpg" alt="" loading="lazy"></figure>
<p>3ã€é»˜è®¤é…ç½®å°±å¯ä»¥</p>
<figure data-type="image" tabindex="32"><img src="https://stormga.github.io//post-images/37.tomcat11.jpg" alt="" loading="lazy"></figure>
<p>4ã€é…ç½®web.xmlæ–‡ä»¶</p>
<figure data-type="image" tabindex="33"><img src="https://stormga.github.io//post-images/38.tomcat12.jpg" alt="" loading="lazy"></figure>
<p>5ã€æ–‡æ¡£ç›®å½•ç»“æ„</p>
<figure data-type="image" tabindex="34"><img src="https://stormga.github.io//post-images/39.tomcat13.jpg" alt="" loading="lazy"></figure>
<h3 id="2-è¿è¡Œä¸€ä¸ªç¤ºä¾‹">2ã€è¿è¡Œä¸€ä¸ªç¤ºä¾‹</h3>
<p>1ã€é¡¹ç›®ç›®å½•</p>
<figure data-type="image" tabindex="35"><img src="https://stormga.github.io//post-images/40.demo1.jpg" alt="" loading="lazy"></figure>
<p>2ã€é…ç½®æ–‡ä»¶å†™è§†å›¾è§£æå‰åç¼€</p>
<pre><code class="language-properties">spring.mvc.view.prefix=/WEB-INF/jsp/

spring.mvc.view.suffix=.jsp

</code></pre>
<p>3ã€HelloController</p>
<pre><code class="language-java">@Controller
public class HelloController {
    @GetMapping(&quot;/hello&quot;)
    public String hello(Model model){
        model.addAttribute(&quot;message&quot;,&quot;è¿™æ˜¯Controllerä¼ è¿‡æ¥çš„message&quot;);
        return &quot;success&quot;;
    }
}

</code></pre>
<p>4ã€success.jsp</p>
<pre><code class="language-jsp">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Success&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Success&lt;/h1&gt;
message:${message}
&lt;/body&gt;
&lt;/html&gt;

</code></pre>
<p>5ã€è¿è¡Œç»“æœ</p>
<figure data-type="image" tabindex="36"><img src="https://stormga.github.io//post-images/41.demo2.jpg" alt="" loading="lazy"></figure>
<p>æ­¥éª¤</p>
<p>1ã€å¿…é¡»åˆ›å»ºä¸€ä¸ªwaré¡¹ç›®ï¼›</p>
<p>2ã€å°†åµŒå…¥å¼çš„TomcatæŒ‡å®šä¸ºprovided</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;

</code></pre>
<p>3ã€å¿…é¡»ç¼–å†™ä¸€ä¸ªSpringBootServletInitializerçš„å­ç±»ï¼Œå¹¶è°ƒç”¨configureæ–¹æ³•é‡Œé¢çš„å›ºå®šå†™æ³•</p>
<pre><code class="language-java">public class ServletInitializer extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        //ä¼ å…¥SpringBootçš„ä¸»ç¨‹åºï¼Œ
        return application.sources(SpringBoot04WebJspApplication.class);
    }

}

</code></pre>
<p>4ã€å¯åŠ¨æœåŠ¡å™¨å°±å¯ä»¥ï¼›</p>
<h3 id="3-åŸç†">3ã€åŸç†</h3>
<p>jaråŒ…ï¼šæ‰§è¡ŒSpringBootä¸»ç±»çš„mainæ–¹æ³•ï¼Œå¯åŠ¨iocå®¹å™¨ï¼Œåˆ›å»ºåµŒå…¥å¼çš„Servletçš„å®¹å™¨ï¼›</p>
<p>waråŒ…ï¼šå¯åŠ¨æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å¯åŠ¨SpringBootåº”ç”¨ï¼Œã€SpringBootServletInitializerã€‘å¯åŠ¨iocå®¹å™¨</p>
<p>servlet3.0è§„èŒƒ</p>
<p>8.2.4 å…±äº«åº“å’Œè¿è¡Œæ—¶æ’ä»¶</p>
<p>è§„åˆ™ï¼š</p>
<p>1ã€æœåŠ¡å™¨å¯åŠ¨ï¼ˆwebåº”ç”¨å¯åŠ¨ï¼‰ï¼Œä¼šåˆ›å»ºå½“å‰çš„webåº”ç”¨é‡Œé¢æ¯ä¸€ä¸ªjaråŒ…é‡Œé¢ServletContrainerInitializerçš„å®ç°ç±»çš„å®ä¾‹</p>
<p>2ã€SpringBootServletInitializerè¿™ä¸ªç±»çš„å®ç°éœ€è¦æ”¾åœ¨jaråŒ…ä¸‹çš„META-INF/servicesæ–‡ä»¶å¤¹ä¸‹ï¼Œæœ‰ä¸€ä¸ªå‘½åä¸ºjavax.servlet.ServletContainerInitalizerçš„æ–‡ä»¶ï¼Œå†…å®¹å°±æ˜¯ServletContainerInitializerçš„å®ç°ç±»å…¨ç±»å</p>
<p>3ã€è¿˜å¯ä»¥ä½¿ç”¨@HandlerTypesæ³¨è§£ï¼Œåœ¨åº”ç”¨å¯åŠ¨çš„æ—¶å€™å¯ä»¥å¯åŠ¨æˆ‘ä»¬æ„Ÿå…´è¶£çš„ç±»</p>
<p>æµç¨‹ï¼š</p>
<p>1ã€å¯åŠ¨TomcatæœåŠ¡å™¨</p>
<p>2ã€spring webæ¨¡å—é‡Œæœ‰è¿™ä¸ªæ–‡ä»¶</p>
<figure data-type="image" tabindex="37"><img src="https://stormga.github.io//post-images/42.servletContainerInit.jpg" alt="" loading="lazy"></figure>
<pre><code class="language-java">org.springframework.web.SpringServletContainerInitializer

</code></pre>
<p>3ã€SpringServletContainerInitializerå°†handlerTypesæ ‡æ³¨çš„æ‰€æœ‰ç±»å‹çš„ç±»ä¼ å…¥åˆ°onStartipæ–¹æ³•çš„Set&lt;Class&lt;?&gt;&gt;;ä¸ºè¿™äº›æ„Ÿå…´è¶£ç±»åˆ›å»ºå®ä¾‹</p>
<p>4ã€æ¯ä¸ªåˆ›å»ºå¥½çš„WebApplicationInitializerè°ƒç”¨è‡ªå·±çš„onStratup</p>
<p>5ã€ç›¸å½“äºæˆ‘ä»¬çš„SpringBootServletInitializerçš„ç±»ä¼šè¢«åˆ›å»ºå¯¹è±¡ï¼Œå¹¶æ‰§è¡ŒonStartupæ–¹æ³•</p>
<p>6ã€SpringBootServletInitializeræ‰§è¡ŒonStartupæ–¹æ³•ä¼šåˆ›å»ºcreateRootApplicationContext</p>
<pre><code class="language-java">protected WebApplicationContext createRootApplicationContext(ServletContext servletContext) {
    SpringApplicationBuilder builder = this.createSpringApplicationBuilder();
    //ç¯å¢ƒæ„å»ºå™¨
    StandardServletEnvironment environment = new StandardServletEnvironment();
    environment.initPropertySources(servletContext, (ServletConfig)null);
    builder.environment(environment);
    builder.main(this.getClass());
    ApplicationContext parent = this.getExistingRootWebApplicationContext(servletContext);
    if (parent != null) {
        this.logger.info(&quot;Root context already created (using as parent).&quot;);
        servletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, (Object)null);
        builder.initializers(new ApplicationContextInitializer[]{new ParentContextApplicationContextInitializer(parent)});
    }
	
    builder.initializers(new ApplicationContextInitializer[]{new ServletContextApplicationContextInitializer(servletContext)});
    builder.contextClass(AnnotationConfigEmbeddedWebApplicationContext.class);
    //è°ƒç”¨Configure,å­ç±»é‡å†™äº†è¿™ä¸ªæ–¹æ³•ï¼Œå°†SpringBootçš„ä¸»ç¨‹åºç±»ä¼ å…¥è¿›æ¥
    builder = this.configure(builder);
    //åˆ›å»ºä¸€ä¸ªspringåº”ç”¨
    SpringApplication application = builder.build();
    if (application.getSources().isEmpty() &amp;&amp; AnnotationUtils.findAnnotation(this.getClass(), Configuration.class) != null) {
        application.getSources().add(this.getClass());
    }

    Assert.state(!application.getSources().isEmpty(), &quot;No SpringApplication sources have been defined. Either override the configure method or add an @Configuration annotation&quot;);
    if (this.registerErrorPageFilter) {
        application.getSources().add(ErrorPageFilterConfiguration.class);
    }
	//æœ€åå¯åŠ¨Springå®¹å™¨
    return this.run(application);
}

</code></pre>
<p>7ã€Springçš„åº”ç”¨å°±å¯åŠ¨å®Œäº†å¹¶ä¸”åˆ›å»ºIOCå®¹å™¨ï¼›</p>
<pre><code class="language-java">public ConfigurableApplicationContext run(String... args) {
   StopWatch stopWatch = new StopWatch();
   stopWatch.start();
   ConfigurableApplicationContext context = null;
   FailureAnalyzers analyzers = null;
   configureHeadlessProperty();
   SpringApplicationRunListeners listeners = getRunListeners(args);
   listeners.starting();
   try {
      ApplicationArguments applicationArguments = new DefaultApplicationArguments(
            args);
      ConfigurableEnvironment environment = prepareEnvironment(listeners,
            applicationArguments);
      Banner printedBanner = printBanner(environment);
      context = createApplicationContext();
      analyzers = new FailureAnalyzers(context);
      prepareContext(context, environment, listeners, applicationArguments,
            printedBanner);
      refreshContext(context);
      afterRefresh(context, applicationArguments);
      listeners.finished(context, null);
      stopWatch.stop();
      if (this.logStartupInfo) {
         new StartupInfoLogger(this.mainApplicationClass)
               .logStarted(getApplicationLog(), stopWatch);
      }
      return context;
   }
   catch (Throwable ex) {
      handleRunFailure(context, listeners, analyzers, ex);
      throw new IllegalStateException(ex);
   }
}

</code></pre>
<h1 id="äº”-docker">äº”ã€Docker</h1>
<h2 id="1-ç®€ä»‹-2">1ã€ç®€ä»‹</h2>
<p>Dockeræ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“</p>
<p>å°†è½¯ä»¶ç¼–è¯‘æˆä¸€ä¸ªé•œåƒï¼›ç„¶ååœ¨é•œåƒé‡Œå„ç§è½¯ä»¶åšå¥½é…ç½®ï¼Œå°†é•œåƒå‘å¸ƒå‡ºå»ï¼Œå…¶ä»–çš„ä½¿ç”¨è¿™å°±å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªé•œåƒã€‚è¿è¡Œä¸­çš„è¿™ä¸ªé•œåƒå«åšå®¹å™¨ï¼Œå®¹å™¨å¯åŠ¨é€Ÿåº¦å¿«ï¼Œç±»ä¼¼ghostæ“ä½œç³»ç»Ÿï¼Œå®‰è£…å¥½äº†ä»€ä¹ˆéƒ½æœ‰äº†ï¼›</p>
<h2 id="2-dockerçš„æ ¸å¿ƒæ¦‚å¿µ">2ã€Dockerçš„æ ¸å¿ƒæ¦‚å¿µ</h2>
<p>dockerä¸»æœºï¼ˆHOSTï¼‰:å®‰è£…äº†Dockerç¨‹åºçš„æœºå™¨ï¼ˆDockerç›´æ¥å®‰è£…åœ¨æ“ä½œç³»ç»Ÿä¸Šçš„ï¼‰</p>
<p>dockerå®¢æˆ·ç«¯ï¼ˆClientï¼‰:æ“ä½œdockerä¸»æœº</p>
<p>dockerä»“åº“ï¼ˆRegistryï¼‰ï¼šç”¨æ¥ä¿å­˜æ‰“åŒ…å¥½çš„è½¯ä»¶é•œåƒ</p>
<p>dockeré•œåƒï¼ˆImageï¼‰:è½¯ä»¶æ‰“å¥½åŒ…çš„é•œåƒï¼Œæ”¾åˆ°dockerçš„ä»“åº“ä¸­</p>
<p>dockerå®¹å™¨ï¼ˆContainerï¼‰:é•œåƒå¯åŠ¨åçš„å®ä¾‹ï¼ˆ5ä¸ªå®¹å™¨å¯åŠ¨5æ¬¡é•œåƒï¼‰</p>
<p>dockerçš„æ­¥éª¤ï¼š</p>
<p>â€‹	1ã€å®‰è£…Docker</p>
<p>â€‹	2ã€å»Dockerä»“åº“æ‰¾åˆ°è¿™ä¸ªè½¯ä»¶å¯¹åº”çš„é•œåƒï¼›</p>
<p>â€‹	3ã€ä½¿ç”¨Dockerè¿è¡Œçš„è¿™ä¸ªé•œåƒï¼Œé•œåƒå°±ä¼šç”Ÿæˆä¸€ä¸ªå®¹å™¨</p>
<p>â€‹	4ã€å¯¹å®¹å™¨çš„å¯åŠ¨åœæ­¢ï¼Œå°±æ˜¯å¯¹è½¯ä»¶çš„å¯åŠ¨å’Œåœæ­¢</p>
<h2 id="3-å®‰è£…docker">3ã€å®‰è£…Docker</h2>
<h3 id="1-å®‰è£…linux">1ã€å®‰è£…Linux</h3>
<p><a href="http://note.youdao.com/noteshare?id=06ccb673d253fea78fe35430465758e1">å®‰è£…vxboxå¹¶ä¸”å®‰è£…ubuntu</a></p>
<h3 id="2-åœ¨linuxä¸Šå®‰è£…docker">2ã€åœ¨linuxä¸Šå®‰è£…docker</h3>
<pre><code class="language-shell">1ã€æŸ¥çœ‹centosç‰ˆæœ¬
# uname -r
3.10.0-693.el7.x86_64
è¦æ±‚ï¼šå¤§äº3.10
å¦‚æœå°äºçš„è¯å‡çº§*ï¼ˆé€‰åšï¼‰
# yum update
2ã€å®‰è£…docker
# yum install docker
3ã€å¯åŠ¨docker
# systemctl start docker
# docker -v
4ã€å¼€æœºå¯åŠ¨docker
# systemctl enable docker
5ã€åœæ­¢docker
# systemctl stop docker

</code></pre>
<h2 id="4-dockerçš„å¸¸ç”¨æ“ä½œ">4ã€dockerçš„å¸¸ç”¨æ“ä½œ</h2>
<h3 id="1-é•œåƒæ“ä½œ">1ã€é•œåƒæ“ä½œ</h3>
<p>1ã€æœç´¢</p>
<pre><code class="language-shell">docker search mysql

</code></pre>
<p>é»˜è®¤å»docker hubç½‘ç«™æŸ¥æ‰¾ <img src="https://stormga.github.io//post-images/44.docker1.jpg" alt="" loading="lazy"></p>
<p>2ã€æ‹‰å–</p>
<pre><code class="language-shell">é»˜è®¤æœ€æ–°ç‰ˆæœ¬
# docekr pull mysql
å®‰è£…æŒ‡å®šç‰ˆæœ¬
# docker pull mysql:5.5

</code></pre>
<p>3ã€æŸ¥çœ‹</p>
<pre><code class="language-shell">docker images

</code></pre>
<p>4ã€åˆ é™¤</p>
<pre><code>docker rmi imageid

</code></pre>
<h3 id="2-å®¹å™¨æ“ä½œ">2ã€å®¹å™¨æ“ä½œ</h3>
<p>è½¯ä»¶çš„é•œåƒï¼ˆqq.exeï¼‰ -- è¿è¡Œé•œåƒ -- äº§ç”Ÿä¸€ä¸ªå®¹å™¨ï¼ˆæ­£åœ¨è¿è¡Œçš„è½¯ä»¶ï¼‰</p>
<pre><code class="language-shell">1ã€æœç´¢é•œåƒ
# docker search tomcat
2ã€æ‹‰å–é•œåƒ
# docker pull tomcat
3ã€æ ¹æ®é•œåƒå¯åŠ¨å®¹å™¨
[root@lion ~]# docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
docker.io/tomcat    latest              d3d38d61e402        35 hours ago        549 MB
[root@lion ~]# docker run --name mytomcat -d tomcat:latest
2f0348702f5f2a2777082198795d8059d83e5ee38f430d2d44199939cc63e249
4ã€æŸ¥çœ‹é‚£ä¸ªè¿›ç¨‹æ­£åœ¨è¿›è¡Œ
[root@lion ~]# docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
2f0348702f5f        tomcat:latest       &quot;catalina.sh run&quot;   41 seconds ago      Up 39 seconds       8080/tcp            mytomcat
5ã€åœæ­¢è¿è¡Œä¸­å®¹å™¨
[root@lion ~]# docker stop 2f0348702f5f
2f0348702f5f
6ã€æŸ¥çœ‹æ‰€æœ‰å®¹å™¨
[root@lion ~]# docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                       PORTS               NAMES
2f0348702f5f        tomcat:latest       &quot;catalina.sh run&quot;   52 minutes ago      Exited (143) 2 minutes ago                       mytomcat
7ã€å¯åŠ¨å®¹å™¨
[root@lion ~]# docker start 2f0348702f5f
8ã€åˆ é™¤dockerå®¹å™¨
[root@lion ~]# docker rm 2f0348702f5f
2f0348702f5f
9ã€ç«¯å£æ˜ å°„
[root@lion ~]# docker run --name mytomcat -d -p 8888:8080 tomcat
692c408c220128014df32ecb6324fb388427d1ecd0ec56325580135c58f63b29
è™šæ‹Ÿæœº:8888
å®¹å™¨çš„:8080
-d:åå°è¿è¡Œ
-p:ä¸»æœºç«¯å£æ˜ å°„åˆ°å®¹å™¨ç«¯å£
æµè§ˆå™¨ï¼š192.168.179.129:8888
10ã€dockerçš„æ—¥å¿—
[root@lion ~]# docker logs 692c408c2201
11ã€å¤šä¸ªå¯åŠ¨
[root@lion ~]# docker run -d -p 9000:8080 --name mytomcat2 tomcat
æµè§ˆå™¨ï¼š192.168.179.129:9000

</code></pre>
<p>æ›´å¤šå‘½ä»¤å‚è€ƒdockeré•œåƒæ–‡æ¡£</p>
<h3 id="3-å®‰è£…mysql">3ã€å®‰è£…Mysql</h3>
<pre><code class="language-shell">docker pull mysql
docker run --name mysql001 -e MYSQL_ROOT_PASSWORD -d -p 3307:3306 mysql

</code></pre>
<h1 id="å…­-æ•°æ®è®¿é—®">å…­ã€æ•°æ®è®¿é—®</h1>
<h2 id="1-æ•´åˆjdbcæ•°æ®æº">1ã€æ•´åˆJDBCæ•°æ®æº</h2>
<p>1ã€æ–°å»ºé¡¹ç›® spring-boot-06-data-jdbc</p>
<ul>
<li>WEB</li>
<li>Mysql</li>
<li>JDBC</li>
<li>SpringBoot1.5</li>
</ul>
<p>2ã€ç¼–å†™é…ç½®æ–‡ä»¶appliction.yml</p>
<pre><code class="language-yaml">spring:
  datasource:
    username: root
    password: Welcome_1
    url: jdbc:mysql://192.168.179.131:3306/jdbc
    driver-class-name: com.mysql.jdbc.Driver

</code></pre>
<p>3ã€ç¼–å†™æµ‹è¯•ç±»æµ‹è¯•</p>
<pre><code class="language-java">@RunWith(SpringRunner.class)
@SpringBootTest
public class SpringBoot06DataJdbcApplicationTests {

    @Autowired
    DataSource dataSource;

    @Test
    public void contextLoads() throws SQLException {
        System.out.println(dataSource.getClass());

        Connection connection = dataSource.getConnection();
        System.out.println(connection);
        connection.close();
    }

}

</code></pre>
<p>4ã€æµ‹è¯•ç»“æœ</p>
<pre><code>class org.apache.tomcat.jdbc.pool.DataSource
ProxyConnection[PooledConnection[com.mysql.jdbc.JDBC4Connection@c35af2a]]

</code></pre>
<p>æ•°æ®æºç›¸å…³é…ç½®éƒ½åœ¨DataSourcePropertieså±æ€§é‡Œ</p>
<p>è‡ªåŠ¨é…ç½®åŸç†</p>
<p>E:\Develop\Maven_Repo\org\springframework\boot\spring-boot-autoconfigure\1.5.13.RELEASE\spring-boot-autoconfigure-1.5.13.RELEASE.jar!\org\springframework\boot\autoconfigure\jdbc</p>
<h3 id="1-datasource">1ã€DataSource</h3>
<p>å‚è€ƒDataSourceConfiguration,æ ¹æ®é…ç½®åˆ›å»ºæ•°æ®æºï¼Œé»˜è®¤æ˜¯ä½¿ç”¨tomcatè¿æ¥æ± ï¼Œå¯ä»¥ä½¿ç”¨spring.datasource.typeæŒ‡å®šè‡ªå®šä¹‰çš„æ•°æ®æº</p>
<h3 id="2-springbooté»˜è®¤æ”¯æŒ">2ã€SpringBooté»˜è®¤æ”¯æŒ</h3>
<pre><code>Tomcatæ•°æ®æº
HikariDataSource
dbcp.BasicDataSource
dbcp2.BasicDataSource

</code></pre>
<h3 id="3-è‡ªå®šä¹‰æ•°æ®æº">3ã€è‡ªå®šä¹‰æ•°æ®æº</h3>
<pre><code class="language-java"> */
@ConditionalOnMissingBean(DataSource.class)
@ConditionalOnProperty(name = &quot;spring.datasource.type&quot;)
static class Generic {

   @Bean
   public DataSource dataSource(DataSourceProperties properties) {
       //ä½¿ç”¨builderåˆ›å»ºæ•°æ®æºï¼Œåˆ©ç”¨åå°„åˆ›å»ºç›¸åº”çš„typeæ•°æ®æºï¼Œå¹¶ç»‘å®šæ•°æ®æº
      return properties.initializeDataSourceBuilder().build();
   }

}

</code></pre>
<h3 id="4-è¿è¡Œsqlå»ºè¡¨">4ã€è¿è¡Œsqlå»ºè¡¨</h3>
<p>åœ¨DataSourceAutoConfigurationä¸­<strong>DataSourceInitializer</strong>ç±»</p>
<p>ç›‘å¬å™¨</p>
<p>ä½œç”¨ï¼š</p>
<p>1ï¼‰ã€postConstruct -ã€‹runSchemaScript è¿è¡Œå»ºè¡¨sqlæ–‡ä»¶</p>
<p>2ï¼‰ã€runDataScriptè¿è¡Œæ’å…¥æ•°æ®çš„sqlè¯­å¥ï¼›</p>
<p>é»˜è®¤åªéœ€è¦å°†æ–‡ä»¶å‘½åä¸ºï¼š</p>
<pre><code class="language-sql">schema-*.sql data-*.sql
é»˜è®¤è§„åˆ™ï¼šschema.sql ,schema-all.sql;

</code></pre>
<p><strong>ä¸¾ä¸ªæ —å­</strong></p>
<p>åˆ›å»ºdepartmentè¡¨</p>
<p>1ã€department.sql</p>
<pre><code class="language-sql">/*
Navicat MySQL Data Transfer

Source Server         : 192.168.179.131
Source Server Version : 50719
Source Host           : 192.168.179.131:3306
Source Database       : jdbc

Target Server Type    : MYSQL
Target Server Version : 50719
File Encoding         : 65001

Date: 2018-05-14 14:28:52
*/

SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for department
-- ----------------------------
DROP TABLE IF EXISTS `department`;
CREATE TABLE `department` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `departmentName` varchar(255) DEFAULT '',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


</code></pre>
<p>2ã€å°†department.sqlå‘½åä¸ºschema-all.sql</p>
<figure data-type="image" tabindex="38"><img src="https://stormga.github.io//post-images/45.schema-all.jpg" alt="" loading="lazy"></figure>
<p>3ã€è¿è¡Œæµ‹è¯•ç±»</p>
<p>è‡ªå®šä¹‰sqlçš„æ–‡ä»¶åï¼Œdepartment.sqlåœ¨é…ç½®æ–‡ä»¶ä¸­</p>
<pre><code class="language-yaml">schema:
  - classpath:department.sql

</code></pre>
<hr>
<h3 id="5-æ“ä½œjdbctemplate">5ã€æ“ä½œJdbcTemplate</h3>
<p><strong>FBI warning</strong>:å°†department.sqlåˆ é™¤æˆ–è€…æ”¹åï¼Œå› ä¸ºè¿è¡Œæ–‡ä»¶ä¼šå°†è¡¨ä¸­æ•°æ®æ¸…é™¤</p>
<p>1ã€æ–°å»ºä¸€ä¸ªController</p>
<pre><code class="language-java">@Controller
public class HelloController {

    @Autowired
    JdbcTemplate jdbcTemplate;

    @ResponseBody
    @GetMapping(&quot;/hello&quot;)
    public Map&lt;String ,Object&gt; hello(){

        List&lt;Map&lt;String, Object&gt;&gt; list = jdbcTemplate.queryForList(&quot;select * from department&quot;);
        return list.get(0);
    }
}

</code></pre>
<p>2ã€è¡¨ä¸­æ·»åŠ æ•°æ®</p>
<figure data-type="image" tabindex="39"><img src="https://stormga.github.io//post-images/46.department.jpg" alt="" loading="lazy"></figure>
<p>3ã€è®¿é—®è¯·æ±‚æŸ¥è¯¢æ•°æ®</p>
<figure data-type="image" tabindex="40"><img src="https://stormga.github.io//post-images/47.hello.jpg" alt="" loading="lazy"></figure>
<h2 id="2-è‡ªå®šä¹‰æ•°æ®æº">2ã€è‡ªå®šä¹‰æ•°æ®æº</h2>
<p>1ã€å¯¼å…¥Druidçš„ä¾èµ–</p>
<pre><code class="language-xml">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
    &lt;artifactId&gt;druid&lt;/artifactId&gt;
    &lt;version&gt;1.1.9&lt;/version&gt;
&lt;/dependency&gt;


</code></pre>
<p>2ã€ä¿®æ”¹é…ç½®æ–‡ä»¶</p>
<pre><code class="language-yaml">spring:
  datasource:
    username: root
    password: Welcome_1
    url: jdbc:mysql://192.168.179.131:3306/jdbc
    driver-class-name: com.mysql.jdbc.Driver
    type: com.alibaba.druid.pool.DruidDataSource
#    schema:
#      - classpath:department.sql
server:
  port: 9000

</code></pre>
<p>å·²ç»æ›¿æ¢äº†åŸæ¥çš„tomcatæ•°æ®æº</p>
<p>3ã€é…ç½®Druidæ•°æ®æºé…ç½®</p>
<pre><code class="language-yaml">spring:
  datasource:
    username: root
    password: Welcome_1
    url: jdbc:mysql://192.168.179.131:3306/jdbc
    driver-class-name: com.mysql.jdbc.Driver
    type: com.alibaba.druid.pool.DruidDataSource
	# åˆå§‹åŒ–å¤§å°ï¼Œæœ€å°ï¼Œæœ€å¤§  
    initialSize: 5
    minIdle: 5
    maxActive: 20
    # é…ç½®è·å–è¿æ¥ç­‰å¾…è¶…æ—¶çš„æ—¶é—´  
    maxWait: 60000
    # é…ç½®é—´éš”å¤šä¹…æ‰è¿›è¡Œä¸€æ¬¡æ£€æµ‹ï¼Œæ£€æµ‹éœ€è¦å…³é—­çš„ç©ºé—²è¿æ¥ï¼Œå•ä½æ˜¯æ¯«ç§’ 
    timeBetweenEvictionRunsMillis: 60000
    # é…ç½®ä¸€ä¸ªè¿æ¥åœ¨æ± ä¸­æœ€å°ç”Ÿå­˜çš„æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ 
    minEvictableIdleTimeMillis: 300000
    validationQuery: SELECT 1 FROM DUAL
    testWhileIdle: true
    testOnBorrow: false
    testOnReturn: false
    poolPreparedStatements: true
    # é…ç½®ç›‘æ§ç»Ÿè®¡æ‹¦æˆªçš„filters,å»æ‰ç›‘æ§ç•Œé¢sqlæ— æ³•ç»Ÿè®¡ï¼Œâ€˜wallâ€™ç”¨äºé˜²ç«å¢™
    filters: stat,wall,log4j
    maxPoolPreparedStatementPerConnectionSize: 20
    userGlobalDataSourceStat: true
    # é€šè¿‡connectPropertieså±æ€§æ¥æ‰“å¼€mergeSqlåŠŸèƒ½ï¼›æ…¢SQLè®°å½•  
    connectionProperties: druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500
#    schema:
#      - classpath:department.sql
server:
  port: 9000

</code></pre>
<p>4ã€Druidé…ç½®ç›‘æ§</p>
<pre><code class="language-java">@Configuration
public class DruidConfig {

    @ConfigurationProperties(prefix = &quot;spring.datasource&quot;)
    @Bean
    public DataSource druid(){
        return  new DruidDataSource();
    }

    //é…ç½®Druidçš„ç›‘æ§
    //1ã€é…ç½®ä¸€ä¸ªç®¡ç†åå°
    @Bean
    public ServletRegistrationBean statViewServlet(){
        ServletRegistrationBean bean = new ServletRegistrationBean(new StatViewServlet(),&quot;/druid/*&quot;);
        Map&lt;String,String&gt; initParams =new HashMap&lt;&gt;();
        initParams.put(&quot;loginUsername&quot;, &quot;admin&quot;);
        initParams.put(&quot;loginPassword&quot;, &quot;123456&quot;);
        bean.setInitParameters(initParams);
        return bean;
    }
    //2ã€é…ç½®ç›‘æ§çš„filter
    @Bean
    public FilterRegistrationBean webstatFilter(){
        FilterRegistrationBean bean = new FilterRegistrationBean();
        bean.setFilter(new WebStatFilter());

        Map&lt;String,String&gt; initParams =new HashMap&lt;&gt;();
        initParams.put(&quot;exclusions&quot;, &quot;*.js,*.css,/druid/*&quot;);
        bean.setInitParameters(initParams);
        bean.setUrlPatterns(Arrays.asList(&quot;/*&quot;));
        return bean;
    }

}

</code></pre>
<p>5ã€è¿è¡Œæµ‹è¯•ï¼Œè®¿é—® localhost:9000/druid</p>
<figure data-type="image" tabindex="41"><img src="https://stormga.github.io//post-images/48.druid.jpg" alt="" loading="lazy"></figure>
<p>è¾“å…¥åˆšæ‰è°ƒå¥½çš„ç”¨æˆ·åå¯†ç å³å¯è®¿é—®</p>
<h2 id="3-æ•´åˆmybatis">3ã€æ•´åˆMybatis</h2>
<p>1ã€æ–°å»ºå·¥ç¨‹ï¼ŒSpringBoot1.5+web+JDBC+Mysql</p>
<p>å¯¼å…¥ä¾èµ–</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;1.3.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
    &lt;artifactId&gt;druid&lt;/artifactId&gt;
    &lt;version&gt;1.1.9&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;mysql&lt;/groupId&gt;
    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;
&lt;/dependency&gt;

</code></pre>
<p>2ã€å¯¼å…¥é…ç½®æ–‡ä»¶ä¸­å…³äºDruidçš„é…ç½®</p>
<p>â€‹	2.1ã€å¯¼å…¥ä¾èµ–</p>
<p>â€‹	2.2ã€é…ç½®æ–‡ä»¶application.ymlï¼ˆæŒ‡å®šç”¨æˆ·åå¯†ç ...é…ç½®Druidçš„é…ç½®å‚æ•°ï¼Œä¿®æ”¹sqlæ–‡ä»¶åŠ è½½çš„é»˜è®¤åï¼‰</p>
<p>â€‹	2.3ã€å°†Druidç»„ä»¶åŠ å…¥åˆ°å®¹å™¨ä¸­ï¼ˆç›‘æ§ï¼‰é‡ç‚¹</p>
<p>â€‹	å…·ä½“åŒä¸Š</p>
<p>3ã€åˆ›å»ºæ•°æ®è¡¨departmentå’Œemployeeè¡¨</p>
<p>â€‹	3.1ã€æ ¹æ®sqlæ–‡ä»¶ï¼Œæ–°å»ºä¸¤å¼ è¡¨</p>
<p>â€‹	3.2ã€ä¿®æ”¹åŠ è½½çš„sqlåï¼ˆé»˜è®¤ä¸ºschema.sqlå’Œschema-all.sqlï¼‰</p>
<pre><code class="language-yaml">spring:
  datasource:
    schema:
      - classpath:sql/department.sql
      - classpath:sql/employeee.sql

</code></pre>
<p>â€‹	3.3ã€è¿è¡Œç¨‹åºæ£€æŸ¥æ•°æ®åº“æ˜¯å¦åˆ›å»ºæˆåŠŸ</p>
<p>4ã€åˆ›å»ºæ•°æ®åº“å¯¹åº”çš„JavaBean ï¼ˆé©¼å³°å‘½åï¼Œgetter/setter toString/æ³¨é‡Šæ‰schemaé˜²æ­¢é‡å¤åˆ›å»ºï¼‰</p>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹é©¼å³°å‘½åå¼€å¯ ,ä¸å†™é…ç½®æ–‡ä»¶å°±å†™é…ç½®ç±»</p>
<pre><code class="language-yaml">mybatis:
  configuration:
    map-underscore-to-camel-case: true

</code></pre>
<pre><code class="language-java">//ç±»åå†²çªæ‰€ä»¥å…¨ç±»å
@org.springframework.context.annotation.Configuration
public class MyBatisConfig {

    @Bean
    public ConfigurationCustomizer configurationCustomizer(){

        return new ConfigurationCustomizer() {
            @Override
            public void customize(Configuration configuration) {
                configuration.setMapUnderscoreToCamelCase(true);
            }
        };
    }
}

</code></pre>
<h3 id="æ³¨è§£æ–¹å¼">æ³¨è§£æ–¹å¼</h3>
<p>5ã€æ–°å»ºmapper</p>
<pre><code class="language-yaml">//æŒ‡å®šæ˜¯ä¸€ä¸ªmapper
@Mapper
public interface DepartmentMapper {

    @Insert(&quot;insert into department(dept_name) value(#{deptName})&quot;)
    public int insertDept(Department department);

    @Delete(&quot;delete from department where id=#{id}&quot;)
    public int deleteDeptById(Integer id);

    @Update(&quot;update department set dept_Name=#{deptName} where id=#{id}&quot;)
    public int updateDept(Department department);

    @Select(&quot;select * from department where id=#{id}&quot;)
    public Department getDeptById(Integer id);

}

</code></pre>
<p>6ã€ç¼–å†™controlleræµ‹è¯•</p>
<pre><code class="language-java">@RestController
public class DeptController {

    @Autowired
    DepartmentMapper departmentMapper;

    @RequestMapping(&quot;/getDept/{id}&quot;)
    public Department getDepartment(@PathVariable(&quot;id&quot;) Integer id){
        return departmentMapper.getDeptById(id);
    }

    @RequestMapping(&quot;/delDept/{id}&quot;)
    public int delDept(@PathVariable(&quot;id&quot;) Integer id){
        return departmentMapper.deleteDeptById(id);
    }

    @RequestMapping(&quot;/update/{id}&quot;)
    public int updateDept(@PathVariable(&quot;id&quot;) Integer id){
        return departmentMapper.updateDept(new Department(id, &quot;å¼€å‘éƒ¨&quot;));
    }

    @GetMapping(&quot;/insert&quot;)
    public int insertDept(Department department){
        return departmentMapper.insertDept(department);
    }
}

</code></pre>
<p>é—®é¢˜ï¼š</p>
<p>mapperæ–‡ä»¶å¤¹ä¸‹æœ‰å¤šä¸ªmapperæ–‡ä»¶ï¼ŒåŠ éº»çƒ¦ï¼Œå¯ä»¥ç›´æ¥æ‰«ææ•´ä¸ªmapperæ–‡</p>
<p>ä»¶å¤¹ä¸‹çš„mapper</p>
<pre><code class="language-java">//ä¸»é…ç½®ç±»æˆ–è€…mybatisé…ç½®ç±»
@MapperScan(value = &quot;com.wdjr.springboot.mapper&quot;)

</code></pre>
<h3 id="é…ç½®æ–‡ä»¶æ–¹å¼">é…ç½®æ–‡ä»¶æ–¹å¼</h3>
<p>1ã€æ–°å»ºæ–‡ä»¶</p>
<figure data-type="image" tabindex="42"><img src="https://stormga.github.io//post-images/50.mybatisxml.jpg" alt="" loading="lazy"></figure>
<p>2ã€æ–°å»ºmybatisçš„é…ç½®æ–‡ä»¶</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE configuration
        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
&lt;configuration&gt;
    &lt;settings&gt;
        &lt;setting name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;true&quot;/&gt;
    &lt;/settings&gt;
&lt;/configuration&gt;

</code></pre>
<p>3ã€æ–°å»ºEmployeeçš„æ¥å£æ–¹æ³•</p>
<pre><code class="language-java">public interface EmployeeMapper {

    public Employee getEmpById(Integer id);

    public void insetEmp(Employee employee);
}

</code></pre>
<p>4ã€æ–°å»ºEmployeeçš„mapper.xmlçš„æ˜ å°„æ–‡ä»¶</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper
        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
&lt;mapper namespace=&quot;com.wdjr.springboot.mapper.EmployeeMapper&quot;&gt;
    &lt;select id=&quot;getEmpById&quot; resultType=&quot;com.wdjr.springboot.bean.Employee&quot;&gt;
      select * from employee where id=#{id}
   &lt;/select&gt;

    &lt;insert id=&quot;insetEmp&quot;&gt;
        INSERT  INTO employee(last_name,email,gender,d_id) VALUES (#{lastName},#{email},#{gender},#{dId})
    &lt;/insert&gt;
&lt;/mapper&gt;

</code></pre>
<p>5ã€ä¿®æ”¹application.ymlé…ç½®æ–‡ä»¶</p>
<pre><code class="language-yaml">mybatis:
  config-location: classpath:mybatis/mybatis-config.xml
  mapper-locations: classpath:mybatis/mapper/*.xml

</code></pre>
<p>6ã€æ–°å»ºä¸€ä¸ªControllerè®¿é—®æ–¹æ³•</p>
<pre><code class="language-java">@RestController
public class EmployeeController {
    @Autowired
    EmployeeMapper employeeMapper;

    @RequestMapping(&quot;/getEmp/{id}&quot;)
    public Employee getEmp(@PathVariable(&quot;id&quot;) Integer id){
        return employeeMapper.getEmpById(id);
    }

    @GetMapping(&quot;/insertEmp&quot;)
    public Employee insertEmp(Employee employee){
        employeeMapper.insetEmp(employee);
        return employee;
    }
}

</code></pre>
<h2 id="4-jpaæ•°æ®è®¿é—®">4ã€JPAæ•°æ®è®¿é—®</h2>
<p>æ–°å»ºå·¥ç¨‹ springBoot1.5+Web+JPA+MYSQL+JDBC</p>
<p>ç›®å½•ç»“æ„</p>
<figure data-type="image" tabindex="43"><img src="https://stormga.github.io//post-images/51.JPA.jpg" alt="" loading="lazy"></figure>
<p>1ã€æ–°å»ºä¸€ä¸ªå®ä½“ç±»User</p>
<pre><code class="language-java">//ä½¿ç”¨JPAæ³¨è§£é…ç½®æ˜ å°„å…³ç³»
@Entity//å‘Šè¯‰JPAè¿™æ˜¯ä¸€ä¸ªå®ä½“ç±»ï¼ˆå’Œæ•°æ®è¡¨æ˜ å°„çš„ç±»ï¼‰
@Table(name=&quot;tbl_user&quot;) //@Tableæ¥æŒ‡å®šå’Œé‚£ä¸ªæ•°æ®è¡¨å¯¹åº”ï¼Œå¦‚æœçœç•¥é»˜è®¤è¡¨æ˜å°±æ˜¯user;

public class User {

    @Id //è¿™æ˜¯ä¸€ä¸ªä¸»é”®
    @GeneratedValue(strategy = GenerationType.IDENTITY)//è‡ªå¢ç»„ä»¶
    private Integer id ;

    @Column(name=&quot;last_name&quot;,length = 50) //è¿™æ˜¯å’Œæ•°æ®è¡¨å¯¹åº”çš„ä¸€ä¸ªåˆ—
    private String lastName;
    @Column//çœç•¥é»˜è®¤åˆ—åå°±æ˜¯å±æ€§å
    private String email;
    @Column
    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getLastName() {
        return lastName;
    }

    public void setLastName(String lastName) {
        this.lastName = lastName;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }
}

</code></pre>
<p>2ã€æ–°å»ºä¸€ä¸ªUserRepositoryæ¥ç»§æ‰¿jpaçš„ç»å¤§å¤šæ•°åŠŸèƒ½</p>
<pre><code class="language-java">//ç»§æ‰¿jpaRepository
public interface UserRepository extends JpaRepository&lt;User,Integer&gt; {

}

</code></pre>
<p>3ã€ç¼–å†™é…ç½®æ–‡ä»¶application.yml</p>
<pre><code class="language-yaml">spring:
  datasource:
    url: jdbc:mysql://192.168.179.131/jpa
    username: root
    password: Welcome_1
    driver-class-name: com.mysql.jdbc.Driver
  jpa:
    hibernate:
    #æ›´æ–°æˆ–åˆ›å»º
      ddl-auto: update
    show-sql: true

</code></pre>
<p>4ã€ç¼–å†™Controlleræµ‹è¯•</p>
<pre><code class="language-java">@RestController
public class UserController {
    @Autowired
    UserRepository userRepository;

    @GetMapping(&quot;/user/{id}&quot;)
    public User getUser(@PathVariable(&quot;id&quot;) Integer id){
        User user = userRepository.findOne(id);
        return user;
    }

    @GetMapping(&quot;/insert&quot;)
    public User insertUser(User user){
        User user1 = userRepository.save(user);
        return  user1;
    }
}

</code></pre>
<h1 id="ä¸ƒ-å¯åŠ¨é…ç½®åŸç†">ä¸ƒã€å¯åŠ¨é…ç½®åŸç†</h1>
<p>å‡ ä¸ªé‡è¦çš„äº‹ä»¶å›è°ƒæœºåˆ¶</p>
<p>åŠ è½½é…ç½®æ–‡ä»¶META-INF/spring.factories</p>
<p>â€‹	ApplicationContextInitializer</p>
<p>â€‹	SpringApplicationRunListener</p>
<p>iocå®¹å™¨ä¸­</p>
<p>â€‹	ApplicationRunner</p>
<p>â€‹	CommandLineRunner</p>
<p>å¯åŠ¨æµç¨‹</p>
<h2 id="1-åˆ›å»ºspringapplicaiotnå¯¹è±¡">1ã€åˆ›å»ºSpringApplicaiotnå¯¹è±¡</h2>
<pre><code class="language-java">private void initialize(Object[] sources) {
    //ä¿å­˜ä¸»é…ç½®ç±»
   if (sources != null &amp;&amp; sources.length &gt; 0) {
      this.sources.addAll(Arrays.asList(sources));
   }
    //åˆ¤æ–­å½“å‰æ˜¯å¦æ˜¯ä¸ªwebåº”ç”¨
   this.webEnvironment = deduceWebEnvironment();
    //ä»ç±»è·¯å¾„ä¸‹æ‰¾åˆ°META-INF/spring.factoriesé…ç½®ä¸­çš„æ‰€æœ‰ApplicationInitializer ç„¶åä¿å­˜èµ·æ¥
   setInitializers((Collection) getSpringFactoriesInstances(
         ApplicationContextInitializer.class));
    //ä»ç±»è·¯å¾„ä¸‹æ‰¾åˆ°META-INF/spring.factoriesé…ç½®ä¸­çš„æ‰€æœ‰ApplicationListener ç„¶åä¿å­˜èµ·æ¥
   setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));
    //å†³å®šå“ªä¸€ä¸ªæ˜¯ä¸»ç¨‹åº
   this.mainApplicationClass = deduceMainApplicationClass();
}

</code></pre>
<p>ApplicationInitializer</p>
<figure data-type="image" tabindex="44"><img src="https://stormga.github.io//post-images/52.applicationCotextInitializer.jpg" alt="" loading="lazy"></figure>
<p>ApplicationListener</p>
<figure data-type="image" tabindex="45"><img src="https://stormga.github.io//post-images/53.Listener.jpg" alt="" loading="lazy"></figure>
<h2 id="2-è¿è¡Œrunæ–¹æ³•">2ã€è¿è¡ŒRunæ–¹æ³•</h2>
<pre><code class="language-java">public ConfigurableApplicationContext run(String... args) {
   StopWatch stopWatch = new StopWatch();
   stopWatch.start();
   ConfigurableApplicationContext context = null;
   FailureAnalyzers analyzers = null;
   configureHeadlessProperty();
    //è·å–SpringApplicationRunListeners;ä»ç±»è·¯å¾„ä¸‹META-INF/spring.factory
   SpringApplicationRunListeners listeners = getRunListeners(args);
    //å›è°ƒæ‰€æœ‰çš„SpringApplicationRunListener.starting()æ–¹æ³•
   listeners.starting();
   try {
       //å°è£…å‘½ä»¤è¡Œå‚æ•°
      ApplicationArguments applicationArguments = new DefaultApplicationArguments(
            args);
       //å‡†å¤‡ç¯å¢ƒ
      ConfigurableEnvironment environment = prepareEnvironment(listeners,
            applicationArguments);
       //åˆ›å»ºç¯å¢ƒï¼Œå®Œæˆåå›è°ƒSpringApplicationRunListener.environmentPreparedç¯å¢ƒå‡†å¤‡å®Œæˆ
       //æ‰“å°SpringBootå›¾æ ‡
      Banner printedBanner = printBanner(environment);
       //åˆ›å»ºApplicationContextï¼Œå†³å®šåˆ›å»ºwebçš„iocå®¹å™¨è¿˜æ˜¯æ™®é€šçš„ioc
      context = createApplicationContext();
       //å¼‚å¸¸åˆ†æ
      analyzers = new FailureAnalyzers(context);
       //é‡ç‚¹ï¼šå°†environmentä¿å­˜çš„iocä¸­ï¼ŒapplyInitializersåˆå§‹åŒ–å™¨ä¸Šé¢é‚£6ä¸ªçš„è·å–ï¼Œå¹¶ä¸”å›è°ƒApplicationContextInitializer.initializeæ–¹æ³•
       
       //å›è°ƒæ‰€æœ‰çš„SpringApplicationRunListenerçš„contextPrepare()
       //å‘Šè¯‰prepareContextè¿è¡Œå®Œæˆä»¥åå›è°ƒæ‰€æœ‰çš„SpringApplicationRunListenerçš„contextLoaded
      prepareContext(context, environment, listeners, applicationArguments,
            printedBanner);
       //é‡è¦ï¼šåˆ·æ–°æ‰€æœ‰ç»„ä»¶ iocå®¹å™¨åˆå§‹åŒ–ï¼Œå¦‚æœæ˜¯webåº”ç”¨è¿˜ä¼šåˆ›å»ºåµŒå…¥å¼çš„tomcat
       //æ‰«æ åˆ›å»ºåŠ è½½æ‰€æœ‰ç»„ä»¶çš„åœ°æ–¹
      refreshContext(context);
       //ä»iocä¸­è·å–æ‰€æœ‰çš„ApplicationRunnerå’ŒCommandLineRunner
       //ApplicationRunnerå…ˆå›è°ƒ
      afterRefresh(context, applicationArguments);
       //æ‰€æœ‰çš„SpringApplicationRunListenerå›è°ƒfinishedæ–¹æ³•
      listeners.finished(context, null);
       //ä¿å­˜åº”ç”¨çŠ¶æ€
      stopWatch.stop();
      if (this.logStartupInfo) {
         new StartupInfoLogger(this.mainApplicationClass)
               .logStarted(getApplicationLog(), stopWatch);
      }
       //æ•´ä¸ªspringbootå¯åŠ¨å®Œæˆä»¥åè¿”å›å¯åŠ¨çš„iocå®¹å™¨
      return context;
   }
   catch (Throwable ex) {
      handleRunFailure(context, listeners, analyzers, ex);
      throw new IllegalStateException(ex);
   }
}

</code></pre>
<h2 id="3-äº‹ä»¶ç›‘å¬æœºåˆ¶">3ã€äº‹ä»¶ç›‘å¬æœºåˆ¶</h2>
<p>æ–°å»ºlistenerç›‘å¬</p>
<p>æ–‡ä»¶ç›®å½•</p>
<figure data-type="image" tabindex="46"><img src="https://stormga.github.io//post-images/54.listener2.jpg" alt="" loading="lazy"></figure>
<p>1ã€HelloApplicationContextInitializer</p>
<pre><code class="language-java">//æ³›å‹ç›‘å¬iocå®¹å™¨
public class HelloApplicationContextInitializer implements ApplicationContextInitializer&lt;ConfigurableApplicationContext&gt; {
    @Override
    public void initialize(ConfigurableApplicationContext applicationContext) {
        System.out.println(&quot;ApplicationContextInitializer...è·‘èµ·æ¥äº†.....&quot;+applicationContext);
    }
}

</code></pre>
<p>2ã€HelloSpringApplicationRunListener</p>
<p>åŠ æ„é€ å™¨</p>
<pre><code class="language-java">public class HelloSpringApplicationRunListener implements SpringApplicationRunListener {

    public HelloSpringApplicationRunListener(SpringApplication application, String[] args){

    }

    @Override
    public void starting() {
        System.out.println(&quot;ç›‘å¬å®¹å™¨å¼€å§‹......&quot;);
    }

    @Override
    public void environmentPrepared(ConfigurableEnvironment environment) {
        System.out.println(&quot;ç¯å¢ƒå‡†å¤‡å¥½äº†......&quot;+environment.getSystemProperties().get(&quot;os.name&quot;));
    }

    @Override
    public void contextPrepared(ConfigurableApplicationContext context) {
        System.out.println(&quot;iocå®¹å™¨å‡†å¤‡å¥½äº†......&quot;);
    }

    @Override
    public void contextLoaded(ConfigurableApplicationContext context) {
        System.out.println(&quot;å®¹å™¨ç¯å¢ƒå·²ç»åŠ è½½å®Œæˆ......&quot;);
    }

    @Override
    public void finished(ConfigurableApplicationContext context, Throwable exception) {
        System.out.println(&quot;å…¨éƒ¨åŠ è½½å®Œæˆ......&quot;);
    }
}

</code></pre>
<p>3ã€HelloApplicationRunner</p>
<pre><code class="language-java">@Component
public class HelloApplicationRunner implements ApplicationRunner {
    @Override
    public void run(ApplicationArguments args) throws Exception {
        System.out.println(&quot;ApplicationRunner.....run....&quot;);
    }
}

</code></pre>
<p>4ã€HelloCommandLineRunner</p>
<pre><code class="language-java">@Component
public class HelloCommandLineRunner implements CommandLineRunner {
    @Override
    public void run(String... args) throws Exception {
        System.out.println(&quot;CommandLineRunner......run.....&quot;+Arrays.asList(args));
    }
}

</code></pre>
<p>äº‹ä»¶è¿è¡Œæ–¹æ³•</p>
<p>HelloApplicationContextInitializerå’ŒHelloSpringApplicationRunListeneræ–‡ä»¶META-INF/spring.factoriesä¸­åŠ å…¥</p>
<pre><code># Initializers
org.springframework.context.ApplicationContextInitializer=\
com.wdjr.springboot.listener.HelloApplicationContextInitializer

org.springframework.boot.SpringApplicationRunListener=\
com.wdjr.springboot.listener.HelloSpringApplicationRunListener

</code></pre>
<p>HelloApplicationRunnerå’ŒHelloCommandLineRunner iocåŠ å…¥</p>
<p>@Component</p>
<h1 id="å…«-springbootçš„è‡ªå®šä¹‰starter">å…«ã€SpringBootçš„è‡ªå®šä¹‰starter</h1>
<p>starterï¼šåœºæ™¯å¯åŠ¨å™¨</p>
<p>1ã€åœºæ™¯éœ€è¦ä½¿ç”¨ä»€ä¹ˆä¾èµ–ï¼Ÿ</p>
<p>2ã€å¦‚ä½•ç¼–å†™è‡ªåŠ¨é…ç½®</p>
<pre><code class="language-java">@Configuration //æŒ‡å®šè¿™ä¸ªç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»
@ConditionalOnXXX //åœ¨æŒ‡å®šæ¡ä»¶ä¸‹æˆç«‹çš„æƒ…å†µä¸‹è‡ªåŠ¨é…ç½®ç±»ç”Ÿæ•ˆ
@AutoConfigureAfter //æŒ‡å®šè‡ªåŠ¨é…ç½®ç±»çš„é¡ºåº
@Bean //ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶

@ConfigurationProperties //ç»“åˆç›¸å…³xxxPropertiesç±»æ¥ç»‘å®šç›¸å…³çš„é…ç½®
@EnableConfigurationProperties //è®©xxxPropertiesç”Ÿæ•ˆåŠ åˆ°å®¹å™¨ä¸­

è‡ªåŠ¨é…ç½®ç±»è¦èƒ½åŠ è½½
å°†éœ€è¦å¯åŠ¨å°±åŠ è½½çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œé…ç½®åœ¨META-INF/spring.factories
# Auto Configure
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\
org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\

</code></pre>
<p>3ã€æ¨¡å¼</p>
<p>å¯åŠ¨å™¨ç©ºçš„jaråªéœ€è¦åšä¾èµ–ç®¡ç†å¯¼å…¥ï¼›</p>
<p>ä¸“é—¨å†™ä¸€ä¸ªè‡ªåŠ¨é…ç½®æ¨¡å—ï¼›</p>
<p>å¯åŠ¨å™¨ä¾èµ–è‡ªåŠ¨é…ç½®ï¼Œåˆ«äººåªéœ€è¦å¼•å…¥starter</p>
<p>xxx-spring-boot-starter</p>
<h3 id="æ–°å»ºä¸€ä¸ªstarter">æ–°å»ºä¸€ä¸ªstarter</h3>
<blockquote>
<p>ç»•çš„ä½ æ€€ç–‘äººç”Ÿ</p>
</blockquote>
<h4 id="1-æ–°å»ºä¸€ä¸ªç©ºé¡¹ç›®å·¥ç¨‹">1ã€æ–°å»ºä¸€ä¸ªç©ºé¡¹ç›®å·¥ç¨‹</h4>
<figure data-type="image" tabindex="47"><img src="https://stormga.github.io//post-images/56.starter01.jpg" alt="" loading="lazy"></figure>
<p>2ã€é¡¹ç›®å‘½å</p>
<figure data-type="image" tabindex="48"><img src="https://stormga.github.io//post-images/57.starter02.jpg" alt="" loading="lazy"></figure>
<p>3ã€å¯¼å…¥module</p>
<figure data-type="image" tabindex="49"><img src="https://stormga.github.io//post-images/58.starter03.jpg" alt="" loading="lazy"></figure>
<p>4ã€æ–°å»ºä¸€ä¸ªMavenå·¥ç¨‹</p>
<figure data-type="image" tabindex="50"><img src="https://stormga.github.io//post-images/59.starter04.jpg" alt="" loading="lazy"></figure>
<p>5ã€é¡¹ç›®å‘½å</p>
<figure data-type="image" tabindex="51"><img src="https://stormga.github.io//post-images/60.starter05.jpg" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="52"><img src="https://stormga.github.io//post-images/61.starter06.jpg" alt="" loading="lazy"></figure>
<p>6ã€åœ¨æ–°å»ºä¸€ä¸ªautoconfigurationç±»çš„spring</p>
<figure data-type="image" tabindex="53"><img src="https://stormga.github.io//post-images/62.starter07.jpg" alt="" loading="lazy"></figure>
<p>7ã€é¡¹ç›®å‘½å</p>
<figure data-type="image" tabindex="54"><img src="https://stormga.github.io//post-images/63.starter08.jpg" alt="" loading="lazy"></figure>
<p>8ã€æ— éœ€å¯¼å…¥ä¾èµ–</p>
<figure data-type="image" tabindex="55"><img src="https://stormga.github.io//post-images/64.starter09.jpg" alt="" loading="lazy"></figure>
<p>9ã€next</p>
<figure data-type="image" tabindex="56"><img src="https://stormga.github.io//post-images/65.starter10.jpg" alt="" loading="lazy"></figure>
<p>æœ€åé…ç½®å®Œæˆ</p>
<h4 id="2-ç¼–å†™starter">2ã€ç¼–å†™starter</h4>
<h5 id="autoconfigurer">autoconfigurer</h5>
<p>å¯¹<strong>lkh-spring-boot-starter-autoconfigurer</strong>è¿›è¡Œåˆ å‡</p>
<p>ç›®å½•</p>
<figure data-type="image" tabindex="57"><img src="https://stormga.github.io//post-images/66.starter-build01.jpg" alt="" loading="lazy"></figure>
<p>2ã€pomæ–‡ä»¶ä¿®æ”¹</p>
<pre><code class="language-xml">    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
        &lt;/dependency&gt;

    &lt;/dependencies&gt;


&lt;/project&gt;

</code></pre>
<p>3ã€ç¼–å†™ç›¸å…³çš„ç±»</p>
<figure data-type="image" tabindex="58"><img src="https://stormga.github.io//post-images/67.starter-build02.jpg" alt="" loading="lazy"></figure>
<p>4ã€HelloProperties</p>
<pre><code class="language-java">package com.lkh.starter;


import org.springframework.boot.context.properties.ConfigurationProperties;

@ConfigurationProperties(prefix = &quot;lkh.hello&quot;)
public class HelloProperties {
    private String prefix;
    private String suffix;

    public String getPrefix() {
        return prefix;
    }

    public void setPrefix(String prefix) {
        this.prefix = prefix;
    }

    public String getSuffix() {
        return suffix;
    }

    public void setSuffix(String suffix) {
        this.suffix = suffix;
    }
}

</code></pre>
<p>5ã€HelloService</p>
<pre><code class="language-java">package com.lkh.starter;

public class HelloService {

    HelloProperties helloProperties;

    public HelloProperties getHelloProperties() {
        return helloProperties;
    }

    public void setHelloProperties(HelloProperties helloProperties) {
        this.helloProperties = helloProperties;
    }

    public String sayHello(String name){
        return helloProperties.getPrefix()+name+helloProperties.getSuffix();
    }
}

</code></pre>
<p>6ã€HelloServiceAutoConfiguration</p>
<pre><code class="language-java">package com.lkh.starter;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.autoconfigure.condition.ConditionalOnWebApplication;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
@ConditionalOnWebApplication
@EnableConfigurationProperties(HelloProperties.class)
public class HelloServiceAutoConfiguration {

    @Autowired
    HelloProperties helloProperties;
    @Bean
    public HelloService helloService(){
        HelloService service = new HelloService();
        service.setHelloProperties(helloProperties);
        return service;
    }

}

</code></pre>
<p>7ã€é…ç½®æ–‡ä»¶</p>
<pre><code>org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
com.lkh.starter.HelloServiceAutoConfiguration

</code></pre>
<p>8ã€ä¿®æ”¹lkh-spring-boot-starter ä¹Ÿå°±æ˜¯ä¹‹å‰çš„Mavené¡¹ç›®ï¼Œä¿®æ”¹pomæ–‡ä»¶å¼•å…¥autoconfigurationä¾èµ–</p>
<pre><code class="language-xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.lkh.starter&lt;/groupId&gt;
        &lt;artifactId&gt;lkh-spring-boot-starter-autoconfigurer&lt;/artifactId&gt;
        &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;

</code></pre>
<p>9ã€installç”Ÿæˆ</p>
<figure data-type="image" tabindex="59"><img src="https://stormga.github.io//post-images/68.starter-build03.jpg" alt="" loading="lazy"></figure>
<h4 id="3-æµ‹è¯•">3ã€æµ‹è¯•</h4>
<p>æ–°å»ºä¸€ä¸ªspringboot 1.5+web</p>
<p>1ã€å¼•å…¥starter</p>
<pre><code class="language-xml">    &lt;dependency&gt;
        &lt;groupId&gt;com.lkh.starter&lt;/groupId&gt;
        &lt;artifactId&gt;lkh-spring-boot-starter&lt;/artifactId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;/dependency&gt;

&lt;/dependencies&gt;

</code></pre>
<p>2ã€æ–°å»ºä¸€ä¸ªControllerç”¨æ¥æµ‹è¯•</p>
<pre><code class="language-java">@RestController
public class HelloController {

    @Autowired
    HelloService helloService;

    @GetMapping
    public  String hello(){
        return helloService.sayHello(&quot;test&quot;);
    }
}

</code></pre>
<p>3ã€ç¼–å†™é…ç½®æ–‡ä»¶åˆ¶å®šå‰ç¼€å’Œåç¼€å</p>
<pre><code class="language-properties">lkh.hello.prefix=Starter-
lkh.hello.suffix=-Success

</code></pre>
<p>4ã€è¿è¡Œè®¿é—®http://localhost:8080/hello</p>
<figure data-type="image" tabindex="60"><img src="https://stormga.github.io//post-images/70.starter-build05.jpg" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Redisä¸»ä»å¤åˆ¶]]></title>
        <id>https://stormga.github.io/post/redis-replication/</id>
        <link href="https://stormga.github.io/post/redis-replication/">
        </link>
        <updated>2020-03-09T09:44:55.000Z</updated>
        <summary type="html"><![CDATA[<p>æˆ‘ä»¬é€šè¿‡æŒä¹…åŒ–åŠŸèƒ½ï¼Œredisä¿è¯äº†å³ä½¿æœåŠ¡å™¨é‡å¯ä¹Ÿä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œä½†æ˜¯ç”±äºæ•°æ®å­˜å‚¨åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå¦‚æœè¯¥æœåŠ¡å™¨å‡ºç°æ•…éšœï¼Œæ¯”å¦‚ç¡¬ç›˜æŸåä¹Ÿä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸ºäº†é¿å…å•ç‚¹æ•…éšœï¼Œè¿›è¡Œä¸»ä»å¤åˆ¶æ“ä½œã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>æˆ‘ä»¬é€šè¿‡æŒä¹…åŒ–åŠŸèƒ½ï¼Œredisä¿è¯äº†å³ä½¿æœåŠ¡å™¨é‡å¯ä¹Ÿä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œä½†æ˜¯ç”±äºæ•°æ®å­˜å‚¨åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå¦‚æœè¯¥æœåŠ¡å™¨å‡ºç°æ•…éšœï¼Œæ¯”å¦‚ç¡¬ç›˜æŸåä¹Ÿä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸ºäº†é¿å…å•ç‚¹æ•…éšœï¼Œè¿›è¡Œä¸»ä»å¤åˆ¶æ“ä½œã€‚</p>
<!-- more -->
<h1 id="ä¸»ä»å¤åˆ¶">ä¸»ä»å¤åˆ¶</h1>
<ul>
<li>ä¸ºäº†é¿å…å•ç‚¹æ•…éšœï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®å¤åˆ¶å¤šä»½å¤åˆ¶å¤šä»½éƒ¨ç½²åœ¨å¤šå°ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œå³ä½¿ä¸€å°åˆå¤å¹´æ•…éšœï¼Œä¾ç„¶å¯ä»¥æä¾›æœåŠ¡</li>
<li>è¿™è¦æ±‚ä¸€å°æœåŠ¡å™¨çš„æ•°æ®æ›´æ–°åï¼Œè‡ªåŠ¨å°†æ›´æ–°çš„æ•°æ®åŒæ­¥åˆ°å…¶ä»–æœåŠ¡å™¨ï¼Œæ€ä¹ˆå®ç°å‘¢ï¼Ÿ-------redisçš„ä¸»ä»å¤åˆ¶</li>
</ul>
<figure data-type="image" tabindex="1"><img src="https://stormga.github.io//post-images/redis%E4%B8%80%E4%B8%BB%E5%A4%9A%E4%BB%8E%E6%9E%B6%E6%9E%84.png" alt="" loading="lazy"></figure>
<ul>
<li>masterç”¨äºå†™ï¼Œslaveç”¨äºè¯»ï¼Œå‘slaveå†™æ•°æ®ä¼šå¯¼è‡´é”™è¯¯</li>
</ul>
<h3 id="ä¸»ä»å¤åˆ¶å®ç°">ä¸»ä»å¤åˆ¶å®ç°</h3>
<ul>
<li>æ–¹å¼ä¸€ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶</li>
<li>æ–¹å¼äºŒï¼š./redis-server --slaveof <master-ip> <master-port>ï¼Œåœ¨å¯åŠ¨redisæ—¶æŒ‡å®šå½“å‰æœåŠ¡æˆä¸ºæŸä¸ªä¸»RedisæœåŠ¡çš„ä»Slave</li>
</ul>
<h4 id="æ–¹å¼ä¸€ä¿®æ”¹é…ç½®æ–‡ä»¶å®ç°æ–¹å¼">æ–¹å¼ä¸€ä¿®æ”¹é…ç½®æ–‡ä»¶å®ç°æ–¹å¼</h4>
<ul>
<li>æ¨¡æ‹Ÿå¤šå°redisæœåŠ¡å™¨ï¼Œè¿è¡Œå¤šä¸ªredisåº”ç”¨ï¼Œæ¨¡æ‹Ÿå¤šä¸ªæœåŠ¡å™¨ã€‚</li>
</ul>
<h5 id="æ­¥éª¤">æ­¥éª¤ï¼š</h5>
<ul>
<li>
<p>å¤åˆ¶ä¸‰ä»½redis.conf</p>
<ul>
<li>redis6380.conf</li>
<li>redis6382.conf</li>
<li>redis6384.conf</li>
</ul>
</li>
<li>
<p>ç¼–è¾‘redis6380.conf</p>
<pre><code class="language-shell">include /usr/local/redis-3.2.9/redis.conf
daemonize yes
port 6380
pidfile /var/run/redis_6380.pid
logfile 6380.log
dbfilename dump6380.rdb
</code></pre>
<ul>
<li>include ï¼š åŒ…å«åŸæ¥çš„é…ç½®æ–‡ä»¶å†…å®¹ã€‚/usr/local/redis-3.2.9/redis.confæŒ‰ç…§è‡ªå·±çš„ç›®å½•è®¾ç½®ã€‚</li>
<li>daemonizeï¼šyes åå°å¯åŠ¨åº”ç”¨ï¼Œç›¸å½“äº ./redis-server &amp; , &amp;çš„ä½œç”¨ã€‚</li>
<li>port : è‡ªå®šä¹‰çš„ç«¯å£å·</li>
<li>pidfile : è‡ªå®šä¹‰çš„æ–‡ä»¶ï¼Œè¡¨ç¤ºå½“å‰ç¨‹åºçš„pid ,è¿›ç¨‹idã€‚</li>
<li>logfileï¼šæ—¥å¿—æ–‡ä»¶å</li>
<li>dbfilenameï¼šæŒä¹…åŒ–çš„rdbæ–‡ä»¶å</li>
</ul>
</li>
<li>
<p>ç¼–è¾‘slaveé…ç½®æ–‡ä»¶</p>
<ul>
<li>slaveof ï¼šÂ è¡¨ç¤ºå½“å‰Redisæ˜¯è°çš„ä»ã€‚å½“å‰æ˜¯127.0.0.0 ç«¯å£6380è¿™ä¸ªMasterçš„ä»</li>
</ul>
</li>
</ul>
<h4 id="å¯åŠ¨æœåŠ¡å™¨masterslave">å¯åŠ¨æœåŠ¡å™¨master/slave</h4>
<ul>
<li>./redis-cli -p 6380</li>
<li>./redis-cli -p 6382</li>
<li>./redis-cli -p 6384</li>
</ul>
<h4 id="æ€»ç»“">æ€»ç»“ï¼š</h4>
<p>è¿™æ ·6380å†™å…¥æ•°æ®ï¼Œ6382ï¼Œ6384éƒ½ä¼šåŒæ­¥</p>
<h3 id="å®¹ç¾å¤„ç†">å®¹ç¾å¤„ç†</h3>
<p>å½“MasteræœåŠ¡å‡ºç°æ•…éšœï¼Œéœ€æ‰‹åŠ¨å°†slaveä¸­çš„ä¸€ä¸ªæå‡ä¸ºmasterï¼ŒÂ å‰©ä¸‹çš„slaveæŒ‚è‡³æ–°çš„masterä¸Šï¼ˆå†·å¤„ç†ï¼šæœºå™¨æŒ‚æ‰äº†ï¼Œå†å¤„ç†ï¼‰</p>
<h1 id="é«˜å¯ç”¨sentinelå“¨å…µ">é«˜å¯ç”¨Sentinelå“¨å…µ</h1>
<ul>
<li>æ­å»ºé›†ç¾¤ä¼šä½¿ç”¨æŠ•ç¥¨æœºåˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬æ­å»ºé›†ç¾¤è¦æ­å»ºå¥‡æ•°å°æœºå™¨</li>
<li>å¯ä»¥æœ‰å‡ ä¸ªredisï¼Œé…å‡ ä¸ªå“¨å…µ</li>
</ul>
<h3 id="sentinelç³»ç»Ÿçš„ä»»åŠ¡">Sentinelç³»ç»Ÿçš„ä»»åŠ¡</h3>
<ul>
<li>ç›‘æ§ï¼šSentinelä¸æ–­çš„æ£€æŸ¥ä¸»æœåŠ¡å’Œä»æœåŠ¡å™¨æ˜¯å¦æŒ‰ç…§é¢„æœŸæ­£å¸¸å·¥ä½œã€‚</li>
<li>æé†’ï¼šè¢«ç›‘æ§çš„Rediså‡ºç°é—®é¢˜æ—¶ï¼ŒSentinelä¼šé€šçŸ¥ç®¡ç†å‘˜æˆ–å…¶ä»–åº”ç”¨ç¨‹åºã€‚</li>
<li>è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼šç›‘æ§çš„ä¸»Redisä¸èƒ½æ­£å¸¸å·¥ä½œï¼ŒSentinelä¼šå¼€å§‹è¿›è¡Œæ•…éšœè¿ç§»æ“ä½œã€‚å°†ä¸€ä¸ªä»æœåŠ¡å™¨å‡çº§æ–°çš„ä¸»æœåŠ¡å™¨ã€‚ è®©å…¶ä»–ä»æœåŠ¡å™¨æŒ‚åˆ°æ–°çš„ä¸»æœåŠ¡å™¨ã€‚åŒæ—¶å‘å®¢æˆ·ç«¯æä¾›æ–°çš„ä¸»æœåŠ¡å™¨åœ°å€ã€‚</li>
</ul>
<figure data-type="image" tabindex="2"><img src="https://stormga.github.io//post-images/redis%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F.png" alt="" loading="lazy"></figure>
<ul>
<li>å½“ä¸»æœåŠ¡å™¨å®•æœºåï¼Œå“¨å…µä¼šè¿›è¡ŒæŠ•ç¥¨ï¼Œå°‘æ•°æœä»å¤šæ•°ï¼Œé€‰ä¸¾å‡ºæ–°çš„ä¸»æœåŠ¡å™¨ã€‚</li>
<li>å¦‚æœå®•æœºçš„ä¸»æœåŠ¡å™¨æ¢å¤æœåŠ¡åï¼Œæ­¤æ—¶ä¼šç§°ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨çš„ä»æœåŠ¡å™¨ï¼Œä¸å†å…·æœ‰å†™æƒé™ã€‚ç„¶ååœ¨ä¸€æ®µæ—¶é—´å†…å’Œå…¶ä»–ä»æœåŠ¡å™¨åŒæ­¥ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§ã€‚</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Redisäº”ç§æ•°æ®ç±»å‹çš„åŸºæœ¬æ“ä½œ]]></title>
        <id>https://stormga.github.io/post/redis-data/</id>
        <link href="https://stormga.github.io/post/redis-data/">
        </link>
        <updated>2020-03-09T09:17:52.000Z</updated>
        <summary type="html"><![CDATA[<p>redisäº”ç§æ•°æ®ç±»å‹çš„ä»‹ç»å’ŒåŸºæœ¬æ“ä½œ</p>
]]></summary>
        <content type="html"><![CDATA[<p>redisäº”ç§æ•°æ®ç±»å‹çš„ä»‹ç»å’ŒåŸºæœ¬æ“ä½œ</p>
<!-- more -->
<h1 id="äº”ç§æ•°æ®ç±»å‹">äº”ç§æ•°æ®ç±»å‹</h1>
<h2 id="å­—ç¬¦ä¸²string">å­—ç¬¦ä¸²ï¼šstring</h2>
<p>å­—ç¬¦ä¸²ç±»å‹æ˜¯Redisä¸­æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œå®ƒèƒ½å­˜å‚¨ä»»ä½•å½¢å¼çš„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬äºŒè¿›åˆ¶æ•°æ®ï¼Œåºåˆ—åŒ–åçš„æ•°æ®ï¼ŒJSONåŒ–çš„å¯¹è±¡ç”šè‡³æ˜¯ä¸€å¼ å›¾ç‰‡ã€‚æœ€å¤§512Mã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://stormga.github.io//post-images/1583746374280.png" alt="" loading="lazy"></figure>
<h2 id="å“ˆå¸Œç±»å‹hash">å“ˆå¸Œç±»å‹ï¼šhash</h2>
<p>Redis hash æ˜¯ä¸€ä¸ªstringç±»å‹çš„fieldå’Œvalueçš„æ˜ å°„è¡¨ï¼Œhashç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ã€‚</p>
<h2 id="åˆ—è¡¨ç±»å‹list">åˆ—è¡¨ç±»å‹ï¼šlist</h2>
<p>Redisåˆ—è¡¨æ˜¯ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼ŒæŒ‰ç…§æ’å…¥é¡ºåºæ’åºã€‚ä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ°åˆ—è¡¨çš„å¤´éƒ¨ï¼ˆå·¦è¾¹ï¼‰æˆ–è€…å°¾éƒ¨ï¼ˆå³è¾¹ï¼‰</p>
<figure data-type="image" tabindex="2"><img src="https://stormga.github.io//post-images/1583746636205.png" alt="" loading="lazy"></figure>
<h2 id="é›†åˆç±»å‹set">é›†åˆç±»å‹ï¼šset</h2>
<p>Redisçš„Setæ˜¯stringç±»å‹çš„æ— åºé›†åˆï¼Œé›†åˆæˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œå³é›†åˆä¸­ä¸èƒ½å‡ºç°é‡å¤çš„æ•°æ®.</p>
<figure data-type="image" tabindex="3"><img src="https://stormga.github.io//post-images/1583746677040.png" alt="" loading="lazy"></figure>
<h2 id="æœ‰åºé›†åˆç±»å‹zsetsorted-set">æœ‰åºé›†åˆç±»å‹ï¼šzsetï¼ˆsorted setï¼‰</h2>
<p>Redis æœ‰åºé›†åˆzsetå’Œé›†åˆsetä¸€æ ·ä¹Ÿæ˜¯stringç±»å‹å…ƒç´ çš„é›†åˆï¼Œä¸”ä¸å…è®¸é‡å¤çš„æˆå‘˜ã€‚</p>
<p>ä¸åŒçš„æ˜¯zsetçš„æ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ªåˆ†æ•°ï¼ˆåˆ†æ•°å¯ä»¥é‡å¤ï¼‰ï¼Œredisé€šè¿‡åˆ†æ•°æ¥ä¸ºé›†åˆä¸­çš„æˆå‘˜è¿›è¡Œä»å°åˆ°å¤§çš„æ’åºã€‚</p>
<figure data-type="image" tabindex="4"><img src="https://stormga.github.io//post-images/1548561480140.png" alt="" loading="lazy"></figure>
<h1 id="åŸºæœ¬æ“ä½œå‘½ä»¤">åŸºæœ¬æ“ä½œå‘½ä»¤</h1>
<h2 id="å­—ç¬¦ä¸²">å­—ç¬¦ä¸²</h2>
<p>ï¼ˆ1ï¼‰å°†å­—ç¬¦ä¸²å€¼ value è®¾ç½®åˆ° key ä¸­ï¼ŒæŸ¥çœ‹å·²æ’å…¥çš„key</p>
<p>è¯­æ³•ï¼šset key value</p>
<figure data-type="image" tabindex="5"><img src="https://stormga.github.io//post-images/1548561624959.png" alt="" loading="lazy"></figure>
<p>ï¼ˆ2ï¼‰è·å– key ä¸­è®¾ç½®çš„å­—ç¬¦ä¸²å€¼</p>
<p>è¯­æ³•ï¼š get key</p>
<figure data-type="image" tabindex="6"><img src="https://stormga.github.io//post-images/1548561659485.png" alt="" loading="lazy"></figure>
<p>ï¼ˆ3ï¼‰å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼åŠ 1ï¼Œå¦‚æœ key ä¸å­˜åœ¨ï¼Œåˆ™ key çš„å€¼å…ˆè¢«åˆå§‹åŒ–ä¸º 0 å†æ‰§è¡Œ incr æ“ä½œï¼ˆåªèƒ½å¯¹æ•°å­—ç±»å‹çš„æ•°æ®æ“ä½œï¼‰</p>
<p>è¯­æ³•ï¼šincr key</p>
<figure data-type="image" tabindex="7"><img src="https://stormga.github.io//post-images/1548561725099.png" alt="" loading="lazy"></figure>
<p>ï¼ˆ4ï¼‰å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å‡1ï¼Œå¦‚æœ key ä¸å­˜åœ¨ï¼Œåˆ™ä¹ˆ key çš„å€¼å…ˆè¢«åˆå§‹åŒ–ä¸º 0 å†æ‰§è¡Œ decr  æ“ä½œï¼ˆåªèƒ½å¯¹æ•°å­—ç±»å‹çš„æ•°æ®æ“ä½œï¼‰</p>
<p>è¯­æ³•ï¼šdecr key</p>
<figure data-type="image" tabindex="8"><img src="https://stormga.github.io//post-images/1548561761899.png" alt="" loading="lazy"></figure>
<p><strong>incr ï¼Œdecr åœ¨å®ç°å…³æ³¨äººæ•°ä¸Šï¼Œæ–‡ç« çš„ç‚¹å‡»æ•°ä¸Šã€‚</strong></p>
<p>ï¼ˆ5ï¼‰è¯­æ³•ï¼šappend key value</p>
<p>è¯´æ˜ï¼šå¦‚æœ key å­˜åœ¨ï¼Œ åˆ™å°† value è¿½åŠ åˆ° key åŸæ¥æ—§å€¼çš„æœ«å°¾</p>
<p>å¦‚æœ key ä¸å­˜åœ¨ï¼Œ åˆ™å°†key è®¾ç½®å€¼ä¸º value</p>
<p>è¿”å›å€¼ï¼šè¿½åŠ å­—ç¬¦ä¸²ä¹‹åçš„æ€»é•¿åº¦</p>
<figure data-type="image" tabindex="9"><img src="https://stormga.github.io//post-images/1548561900420.png" alt="" loading="lazy"></figure>
<ul>
<li>
<p>è¯­æ³•ï¼šstrlen key</p>
<p>è¯´æ˜ï¼šè¿”å› key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼çš„é•¿åº¦</p>
<p>è¿”å›å€¼ï¼š</p>
<p>â€‹     â‘ ï¼šå¦‚æœkeyå­˜åœ¨ï¼Œè¿”å›å­—ç¬¦ä¸²å€¼çš„é•¿åº¦</p>
<p>â€‹     â‘¡ï¼škeyä¸å­˜åœ¨ï¼Œè¿”å›0</p>
<figure data-type="image" tabindex="10"><img src="https://stormga.github.io//post-images/1548564400282.png" alt="" loading="lazy"></figure>
</li>
<li>
<p>è¯­æ³•ï¼šgetrange key start end</p>
<p>ä½œç”¨ï¼šè·å– key ä¸­å­—ç¬¦ä¸²å€¼ä» start å¼€å§‹ åˆ° end ç»“æŸ çš„å­å­—ç¬¦ä¸²,åŒ…æ‹¬startå’Œend, è´Ÿæ•°è¡¨ç¤ºä»å­—ç¬¦ä¸²çš„æœ«å°¾å¼€å§‹ï¼Œ -1 è¡¨ç¤ºæœ€åä¸€ä¸ªå­—ç¬¦ï¼Œ-2è¡¨ç¤ºå€’æ•°ç¬¬äºŒä¸ªå­—ç¬¦ã€‚ä½ç½®ä»0å¼€å§‹</p>
<p>è¿”å›å€¼ï¼šæˆªå–çš„å­å­—ç¬¦ä¸²ã€‚</p>
<figure data-type="image" tabindex="11"><img src="https://stormga.github.io//post-images/1548564561755.png" alt="" loading="lazy"></figure>
</li>
<li>
<p>è¯­æ³•ï¼šsetrange key offset value</p>
<p>è¯´æ˜ï¼šç”¨valueè¦†ç›–ï¼ˆæ›¿æ¢ï¼‰keyçš„å­˜å‚¨çš„å€¼ä»offsetå¼€å§‹,ä¸å­˜åœ¨çš„keyåšç©ºç™½å­—ç¬¦ä¸²ã€‚</p>
<p>è¿”å›å€¼ï¼šä¿®æ”¹åçš„å­—ç¬¦ä¸²çš„é•¿åº¦</p>
<figure data-type="image" tabindex="12"><img src="https://stormga.github.io//post-images/1548564742768.png" alt="" loading="lazy"></figure>
</li>
<li>
<p>è¯­æ³•ï¼šmset key value [key valueâ€¦]</p>
<p>è¯´æ˜ï¼šåŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª key-value å¯¹</p>
<p>è¿”å›å€¼ï¼š OK</p>
<figure data-type="image" tabindex="13"><img src="https://stormga.github.io//post-images/1548564796144.png" alt="" loading="lazy"></figure>
</li>
<li>
<p>è¯­æ³•ï¼šmget key [key â€¦]</p>
<p>ä½œç”¨ï¼šè·å–æ‰€æœ‰(ä¸€ä¸ªæˆ–å¤šä¸ª)ç»™å®š key çš„å€¼</p>
<p>è¿”å›å€¼ï¼šåŒ…å«æ‰€æœ‰keyçš„åˆ—è¡¨</p>
<figure data-type="image" tabindex="14"><img src="https://stormga.github.io//post-images/1548564833435.png" alt="" loading="lazy"></figure>
</li>
</ul>
<h2 id="å“ˆå¸Œç±»å‹">å“ˆå¸Œç±»å‹</h2>
<ul>
<li><strong>hset</strong></li>
</ul>
<p>è¯­æ³•ï¼šhset  hashè¡¨çš„key  field  value</p>
<p>ä½œç”¨ï¼šå°†å“ˆå¸Œè¡¨ key ä¸­çš„åŸŸ field çš„å€¼è®¾ä¸º value ï¼Œå¦‚æœkeyä¸å­˜åœ¨ï¼Œåˆ™æ–°å»ºhashè¡¨ï¼Œæ‰§è¡Œèµ‹å€¼ï¼Œå¦‚æœæœ‰field ,åˆ™è¦†ç›–å€¼ã€‚</p>
<p>è¿”å›å€¼ï¼š</p>
<p>â‘ å¦‚æœfieldæ˜¯hashè¡¨ä¸­æ–°fieldï¼Œä¸”è®¾ç½®å€¼æˆåŠŸï¼Œè¿”å›1</p>
<p>â‘¡å¦‚æœfieldå·²ç»å­˜åœ¨ï¼Œæ—§å€¼è¦†ç›–æ–°å€¼ï¼Œè¿”å›0</p>
<figure data-type="image" tabindex="15"><img src="https://stormga.github.io//post-images/1548565057765.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>hget</strong></li>
</ul>
<p>è¯­æ³•ï¼šhget key field</p>
<p>ä½œç”¨ï¼šè·å–å“ˆå¸Œè¡¨ key ä¸­ç»™å®šåŸŸ field çš„å€¼</p>
<p>è¿”å›å€¼ï¼šfieldåŸŸçš„å€¼ï¼Œå¦‚æœkeyä¸å­˜åœ¨æˆ–è€…fieldä¸å­˜åœ¨è¿”å›nil</p>
<figure data-type="image" tabindex="16"><img src="https://stormga.github.io//post-images/1548565117165.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>hmset</strong></li>
</ul>
<p>è¯­æ³•ï¼šhmset key  field value [field valueâ€¦]</p>
<p>è¯´æ˜ï¼šåŒæ—¶å°†å¤šä¸ª field-value (åŸŸ-å€¼)è®¾ç½®åˆ°å“ˆå¸Œè¡¨ key ä¸­ï¼Œæ­¤å‘½ä»¤ä¼šè¦†ç›–å·²ç»å­˜åœ¨çš„fieldï¼Œhashè¡¨keyä¸å­˜åœ¨ï¼Œåˆ›å»ºç©ºçš„hashè¡¨ï¼Œæ‰§è¡Œhmset.</p>
<p>è¿”å›å€¼ï¼šè®¾ç½®æˆåŠŸè¿”å›okï¼Œ å¦‚æœå¤±è´¥è¿”å›ä¸€ä¸ªé”™è¯¯</p>
<figure data-type="image" tabindex="17"><img src="https://stormga.github.io//post-images/1548565192160.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>hmget</strong></li>
</ul>
<p>è¯­æ³•ï¼šhmget key field [fieldâ€¦]</p>
<p>ä½œç”¨:è·å–å“ˆå¸Œè¡¨ key ä¸­ä¸€ä¸ªæˆ–å¤šä¸ªç»™å®šåŸŸçš„å€¼</p>
<p>è¿”å›å€¼ï¼šè¿”å›å’Œfieldé¡ºåºå¯¹åº”çš„å€¼ï¼Œå¦‚æœfieldä¸å­˜åœ¨ï¼Œè¿”å›nil</p>
<figure data-type="image" tabindex="18"><img src="https://stormga.github.io//post-images/1548565538725.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>hgetall</strong></li>
</ul>
<p>è¯­æ³•ï¼šhgetall key</p>
<p>ä½œç”¨ï¼šè·å–å“ˆå¸Œè¡¨ key ä¸­æ‰€æœ‰çš„åŸŸå’Œå€¼</p>
<p>è¿”å›å€¼ï¼šä»¥åˆ—è¡¨å½¢å¼è¿”å›hashä¸­åŸŸå’ŒåŸŸçš„å€¼ ï¼Œkey ä¸å­˜åœ¨ï¼Œè¿”å›ç©ºhash</p>
<figure data-type="image" tabindex="19"><img src="https://stormga.github.io//post-images/1548565574923.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>hdel</strong></li>
</ul>
<p>è¯­æ³•ï¼šhdel key field [fieldâ€¦]</p>
<p>ä½œç”¨ï¼šåˆ é™¤å“ˆå¸Œè¡¨ key ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å®šåŸŸfieldï¼Œä¸å­˜åœ¨fieldç›´æ¥å¿½ç•¥</p>
<p>è¿”å›å€¼ï¼šæˆåŠŸåˆ é™¤çš„fieldçš„æ•°é‡</p>
<figure data-type="image" tabindex="20"><img src="https://stormga.github.io//post-images/1548565640106.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>hkeys</strong></li>
</ul>
<p>è¯­æ³•ï¼šhkeys key</p>
<p>ä½œç”¨ï¼šæŸ¥çœ‹å“ˆå¸Œè¡¨ key ä¸­çš„æ‰€æœ‰fieldåŸŸ</p>
<p>è¿”å›å€¼ï¼šåŒ…å«æ‰€æœ‰fieldçš„åˆ—è¡¨ï¼Œkeyä¸å­˜åœ¨è¿”å›ç©ºåˆ—è¡¨</p>
<figure data-type="image" tabindex="21"><img src="https://stormga.github.io//post-images/1548565665188.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>hvals</strong></li>
</ul>
<p>è¯­æ³•ï¼šhvals key</p>
<p>ä½œç”¨ï¼šè¿”å›å“ˆå¸Œè¡¨ ä¸­æ‰€æœ‰åŸŸçš„å€¼</p>
<p>è¿”å›å€¼ï¼šåŒ…å«å“ˆå¸Œè¡¨æ‰€æœ‰åŸŸå€¼çš„åˆ—è¡¨ï¼Œkeyä¸å­˜åœ¨è¿”å›ç©ºåˆ—è¡¨</p>
<figure data-type="image" tabindex="22"><img src="https://stormga.github.io//post-images/1548565738515.png" alt="" loading="lazy"></figure>
<ul>
<li>hexists</li>
</ul>
<p>è¯­æ³•ï¼šhexists key field</p>
<p>ä½œç”¨ï¼šæŸ¥çœ‹å“ˆå¸Œè¡¨ key ä¸­ï¼Œç»™å®šåŸŸ field æ˜¯å¦å­˜åœ¨</p>
<p>è¿”å›å€¼ï¼šå¦‚æœfieldå­˜åœ¨ï¼Œè¿”å›1ï¼Œ å…¶ä»–è¿”å›0</p>
<figure data-type="image" tabindex="23"><img src="https://stormga.github.io//post-images/1548565785552.png" alt="" loading="lazy"></figure>
<h2 id="åˆ—è¡¨">åˆ—è¡¨</h2>
<ul>
<li><strong>lpush</strong></li>
</ul>
<p>è¯­æ³•ï¼šlpush key value [valueâ€¦]</p>
<p>ä½œç”¨ï¼šå°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ value æ’å…¥åˆ°åˆ—è¡¨ key çš„è¡¨å¤´ï¼ˆæœ€å·¦è¾¹ï¼‰ï¼Œä»å·¦è¾¹å¼€å§‹åŠ å…¥å€¼ï¼Œä»å·¦åˆ°å³çš„é¡ºåºä¾æ¬¡æ’å…¥åˆ°è¡¨å¤´</p>
<p>è¿”å›å€¼ï¼šæ•°å­—ï¼Œæ–°åˆ—è¡¨çš„é•¿åº¦</p>
<p><strong><img src="https://stormga.github.io//post-images/1548565857589.png" alt="" loading="lazy"></strong></p>
<figure data-type="image" tabindex="24"><img src="https://stormga.github.io//post-images/1548566059007.png" alt="" loading="lazy"></figure>
<p>åœ¨ redis-desktop-manageræ˜¾ç¤º</p>
<figure data-type="image" tabindex="25"><img src="https://stormga.github.io//post-images/1548566162551.png" alt="" loading="lazy"></figure>
<p>æ’å…¥é‡å¤å€¼</p>
<figure data-type="image" tabindex="26"><img src="https://stormga.github.io//post-images/1548566212605.png" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="27"><img src="https://stormga.github.io//post-images/1548566230069.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>rpush</strong></li>
</ul>
<p>è¯­æ³•ï¼šrpush key value [valueâ€¦]</p>
<p>ä½œç”¨ï¼šå°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ value æ’å…¥åˆ°åˆ—è¡¨ key çš„è¡¨å°¾ï¼ˆæœ€å³è¾¹ï¼‰ï¼Œå„ä¸ª value å€¼æŒ‰ä»å·¦åˆ°å³çš„é¡ºåºä¾æ¬¡æ’å…¥åˆ°è¡¨å°¾</p>
<p>è¿”å›å€¼ï¼šæ•°å­—ï¼Œæ–°åˆ—è¡¨çš„é•¿åº¦</p>
<figure data-type="image" tabindex="28"><img src="https://stormga.github.io//post-images/1548566275748.png" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="29"><img src="https://stormga.github.io//post-images/1548566294159.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>lrange</strong></li>
</ul>
<p>è¯­æ³•ï¼šlrange key start stop</p>
<p>ä½œç”¨ï¼šè·å–åˆ—è¡¨ key ä¸­æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ ï¼Œ0 è¡¨ç¤ºåˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä»¥ 1 è¡¨ç¤ºåˆ—è¡¨çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼›start , stop æ˜¯åˆ—è¡¨çš„ä¸‹æ ‡å€¼ï¼Œä¹Ÿå¯ä»¥è´Ÿæ•°çš„ä¸‹æ ‡ï¼Œ -1 è¡¨ç¤ºåˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œ -2 è¡¨ç¤ºåˆ—è¡¨çš„å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä»¥æ­¤ç±»æ¨ã€‚ start ï¼Œstopè¶…å‡ºåˆ—è¡¨çš„èŒƒå›´ä¸ä¼šå‡ºç°é”™è¯¯ã€‚</p>
<p>è¿”å›å€¼ï¼šæŒ‡å®šåŒºé—´çš„åˆ—è¡¨</p>
<figure data-type="image" tabindex="30"><img src="https://stormga.github.io//post-images/1548566342100.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>lindex</strong></li>
</ul>
<p>è¯­æ³•ï¼šlindex key index</p>
<p>ä½œç”¨ï¼šè·å–åˆ—è¡¨ key ä¸­ä¸‹æ ‡ä¸ºæŒ‡å®š index çš„å…ƒç´ ï¼Œåˆ—è¡¨å…ƒç´ ä¸åˆ é™¤ï¼Œåªæ˜¯æŸ¥è¯¢ã€‚0 è¡¨ç¤ºåˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä»¥ 1 è¡¨ç¤ºåˆ—è¡¨çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼›start , stop æ˜¯åˆ—è¡¨çš„ä¸‹æ ‡å€¼ï¼Œä¹Ÿå¯ä»¥è´Ÿæ•°çš„ä¸‹æ ‡ï¼Œ -1 è¡¨ç¤ºåˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œ -2 è¡¨ç¤ºåˆ—è¡¨çš„å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<p>è¿”å›å€¼ï¼šæŒ‡å®šä¸‹æ ‡çš„å…ƒç´ ï¼›indexä¸åœ¨åˆ—è¡¨èŒƒå›´ï¼Œè¿”å›nil</p>
<figure data-type="image" tabindex="31"><img src="https://stormga.github.io//post-images/1548566365030.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>llen</strong></li>
</ul>
<p>è¯­æ³•ï¼šllen key</p>
<p>ä½œç”¨ï¼šè·å–åˆ—è¡¨ key çš„é•¿åº¦</p>
<p>è¿”å›å€¼ï¼šæ•°å€¼ï¼Œåˆ—è¡¨çš„é•¿åº¦ï¼› keyä¸å­˜åœ¨è¿”å›0</p>
<figure data-type="image" tabindex="32"><img src="https://stormga.github.io//post-images/1548566394443.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>lrem</strong></li>
</ul>
<p>è¯­æ³•ï¼šlrem key count value</p>
<p>ä½œç”¨ï¼šæ ¹æ®å‚æ•° count çš„å€¼ï¼Œç§»é™¤åˆ—è¡¨ä¸­ä¸å‚æ•° value ç›¸ç­‰çš„å…ƒç´ ï¼Œ count &gt;0 ï¼Œä»åˆ—è¡¨çš„å·¦ä¾§å‘å³å¼€å§‹ç§»é™¤ï¼› count &lt; 0 ä»åˆ—è¡¨çš„å°¾éƒ¨å¼€å§‹ç§»é™¤ï¼›count = 0ç§»é™¤è¡¨ä¸­æ‰€æœ‰ä¸ value ç›¸ç­‰çš„å€¼ã€‚</p>
<p>è¿”å›å€¼ï¼šæ•°å€¼ï¼Œç§»é™¤çš„å…ƒç´ ä¸ªæ•°</p>
<figure data-type="image" tabindex="33"><img src="https://stormga.github.io//post-images/1548566520410.png" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="34"><img src="https://stormga.github.io//post-images/1548566581052.png" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="35"><img src="https://stormga.github.io//post-images/1548566568423.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>lset</strong></li>
</ul>
<p>è¯­æ³•ï¼šlset key index value</p>
<p>ä½œç”¨ï¼šå°†åˆ—è¡¨ key ä¸‹æ ‡ä¸º index çš„å…ƒç´ çš„å€¼è®¾ç½®ä¸º valueã€‚</p>
<p>è¿”å›å€¼ï¼šè®¾ç½®æˆåŠŸè¿”å›ok ; keyä¸å­˜åœ¨æˆ–è€…indexè¶…å‡ºèŒƒå›´è¿”å›é”™è¯¯ä¿¡æ¯</p>
<figure data-type="image" tabindex="36"><img src="https://stormga.github.io//post-images/1548566820411.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>linsert</strong></li>
</ul>
<p>è¯­æ³•ï¼šlinsert key BEFORE|ALFTER pivot value</p>
<p>ä½œç”¨ï¼šå°†å€¼ value æ’å…¥åˆ°åˆ—è¡¨ key å½“ä¸­ä½äºå€¼ pivot ä¹‹å‰æˆ–ä¹‹åçš„ä½ç½®ã€‚keyä¸å­˜åœ¨ï¼Œpivotä¸åœ¨åˆ—è¡¨ä¸­ï¼Œä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚</p>
<p>è¿”å›å€¼ï¼šå‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œè¿”å›æ–°åˆ—è¡¨çš„é•¿åº¦ã€‚æ²¡æœ‰æ‰¾åˆ°pivotè¿”å› -1ï¼Œ keyä¸å­˜åœ¨è¿”å›0ã€‚</p>
<p>â€‹          <strong>å°†pythonæ’å…¥åˆ°javaä¹‹å‰</strong></p>
<figure data-type="image" tabindex="37"><img src="https://stormga.github.io//post-images/1548567424622.png" alt="" loading="lazy"></figure>
<h2 id="é›†åˆ">é›†åˆ</h2>
<ul>
<li><strong>sadd</strong></li>
</ul>
<p>è¯­æ³•ï¼šsadd key member [memberâ€¦]</p>
<p>ä½œç”¨ï¼šå°†ä¸€ä¸ªæˆ–å¤šä¸ª member å…ƒç´ åŠ å…¥åˆ°é›†åˆ key å½“ä¸­ï¼Œå·²ç»å­˜åœ¨äºé›†åˆçš„ member å…ƒç´ å°†è¢«å¿½ç•¥ï¼Œä¸ä¼šå†åŠ å…¥ã€‚</p>
<p>è¿”å›å€¼ï¼šåŠ å…¥åˆ°é›†åˆçš„æ–°å…ƒç´ çš„ä¸ªæ•°ã€‚ä¸åŒ…æ‹¬è¢«å¿½ç•¥çš„å…ƒç´ ã€‚</p>
<figure data-type="image" tabindex="38"><img src="https://stormga.github.io//post-images/1548567651325.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>smembers</strong></li>
</ul>
<p>è¯­æ³•ï¼šsmembers key</p>
<p>ä½œç”¨ï¼šè·å–é›†åˆ key ä¸­çš„æ‰€æœ‰æˆå‘˜å…ƒç´ ï¼Œä¸å­˜åœ¨çš„keyè§†ä¸ºç©ºé›†åˆ</p>
<figure data-type="image" tabindex="39"><img src="https://stormga.github.io//post-images/1548567691405.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>sismember</strong></li>
</ul>
<p>è¯­æ³•ï¼šsismember key member</p>
<p>ä½œç”¨ï¼šåˆ¤æ–­ member å…ƒç´ æ˜¯å¦æ˜¯é›†åˆ key çš„æˆå‘˜</p>
<p>è¿”å›å€¼ï¼šmemberæ˜¯é›†åˆæˆå‘˜è¿”å›1ï¼Œå…¶ä»–è¿”å› 0 ã€‚</p>
<figure data-type="image" tabindex="40"><img src="https://stormga.github.io//post-images/1548567734490.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>scard</strong></li>
</ul>
<p>è¯­æ³•ï¼šscard key</p>
<p>ä½œç”¨ï¼šè·å–é›†åˆé‡Œé¢çš„å…ƒç´ ä¸ªæ•°</p>
<p>è¿”å›å€¼ï¼šæ•°å­—ï¼Œkeyçš„å…ƒç´ ä¸ªæ•°ã€‚ å…¶ä»–æƒ…å†µè¿”å› 0 ã€‚</p>
<figure data-type="image" tabindex="41"><img src="https://stormga.github.io//post-images/1548567761685.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>srem</strong></li>
</ul>
<p>è¯­æ³•ï¼šsrem key member [memberâ€¦]</p>
<p>ä½œç”¨ï¼šåˆ é™¤é›†åˆ key ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ª member å…ƒç´ ï¼Œä¸å­˜åœ¨çš„å…ƒç´ è¢«å¿½ç•¥ã€‚</p>
<p>è¿”å›å€¼ï¼šæ•°å­—ï¼ŒæˆåŠŸåˆ é™¤çš„å…ƒç´ ä¸ªæ•°ï¼Œä¸åŒ…æ‹¬è¢«å¿½ç•¥çš„å…ƒç´ ã€‚</p>
<figure data-type="image" tabindex="42"><img src="https://stormga.github.io//post-images/1548567840926.png" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="43"><img src="https://stormga.github.io//post-images/1548567854136.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>srandmember</strong></li>
</ul>
<p>è¯­æ³•ï¼šsrandmember key [count]</p>
<p>ä½œç”¨ï¼šåªæä¾›keyï¼Œéšæœºè¿”å›é›†åˆä¸­ä¸€ä¸ªå…ƒç´ ï¼Œå…ƒç´ ä¸åˆ é™¤ï¼Œä¾ç„¶åœ¨é›†åˆä¸­ï¼›æä¾›äº†countæ—¶ï¼Œcount æ­£æ•°, è¿”å›åŒ…å«countä¸ªæ•°å…ƒç´ çš„é›†åˆï¼Œ é›†åˆå…ƒç´ å„ä¸ç›¸åŒã€‚count æ˜¯è´Ÿæ•°ï¼Œè¿”å›ä¸€ä¸ªcountç»å¯¹å€¼çš„é•¿åº¦çš„é›†åˆï¼Œ é›†åˆä¸­å…ƒç´ å¯èƒ½ä¼šé‡å¤å¤šæ¬¡ã€‚</p>
<p>è¿”å›å€¼ï¼šä¸€ä¸ªå…ƒç´ ï¼›å¤šä¸ªå…ƒç´ çš„é›†åˆ</p>
<figure data-type="image" tabindex="44"><img src="https://stormga.github.io//post-images/1548567925391.png" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="45"><img src="https://stormga.github.io//post-images/1548567938119.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>spop</strong></li>
</ul>
<p>è¯­æ³•ï¼šspop key [count]</p>
<p>ä½œç”¨ï¼šéšæœºä»é›†åˆä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ , countæ˜¯åˆ é™¤çš„å…ƒç´ ä¸ªæ•°ã€‚</p>
<p>è¿”å›å€¼ï¼šè¢«åˆ é™¤çš„å…ƒç´ ï¼Œkeyä¸å­˜åœ¨æˆ–ç©ºé›†åˆè¿”å›nil</p>
<figure data-type="image" tabindex="46"><img src="https://stormga.github.io//post-images/1548568005949.png" alt="" loading="lazy"></figure>
<p>éšæœºåˆ é™¤2ä¸ªå…ƒç´ </p>
<figure data-type="image" tabindex="47"><img src="https://stormga.github.io//post-images/1548568056171.png" alt="" loading="lazy"></figure>
<h2 id="æœ‰åºé›†åˆzset">æœ‰åºé›†åˆzset</h2>
<ul>
<li><strong>zadd</strong></li>
</ul>
<p>è¯­æ³•ï¼šzadd key score member [score memberâ€¦]</p>
<p>ä½œç”¨ï¼šå°†ä¸€ä¸ªæˆ–å¤šä¸ª member å…ƒç´ åŠå…¶ score å€¼åŠ å…¥åˆ°æœ‰åºé›†åˆ key ä¸­ï¼Œå¦‚æœmemberå­˜åœ¨é›†åˆä¸­ï¼Œåˆ™æ›´æ–°å€¼ï¼›scoreå¯ä»¥æ˜¯æ•´æ•°æˆ–æµ®ç‚¹æ•°</p>
<p>è¿”å›å€¼ï¼šæ•°å­—ï¼Œæ–°æ·»åŠ çš„å…ƒç´ ä¸ªæ•°</p>
<figure data-type="image" tabindex="48"><img src="https://stormga.github.io//post-images/1548568187813.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>zrange</strong></li>
</ul>
<p>è¯­æ³•ï¼šzrange key start stop [WITHSCORES]</p>
<p>ä½œç”¨ï¼šæŸ¥è¯¢æœ‰åºé›†åˆï¼ŒæŒ‡å®šåŒºé—´çš„å†…çš„å…ƒç´ ã€‚é›†åˆæˆå‘˜æŒ‰scoreå€¼ä»å°åˆ°å¤§æ¥æ’åºã€‚ startï¼Œ stopéƒ½æ˜¯ä»0å¼€å§‹ã€‚0æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œ1 æ˜¯ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¾æ¬¡ç±»æ¨ã€‚ä»¥ -1è¡¨ç¤ºæœ€åä¸€ä¸ªæˆå‘˜ï¼Œ-2 è¡¨ç¤ºå€’æ•°ç¬¬äºŒä¸ªæˆå‘˜ã€‚WITHSCORESé€‰é¡¹è®©scoreå’Œvalueä¸€åŒè¿”å›ã€‚</p>
<p>è¿”å›å€¼ï¼šè‡ªå®šåŒºé—´çš„æˆå‘˜é›†åˆ</p>
<p>ï¼ˆ1ï¼‰æ˜¾ç¤ºé›†åˆçš„å…¨éƒ¨å…ƒç´ ï¼Œä¸æ˜¾ç¤ºscoreï¼Œä¸ä½¿ç”¨WITHSCORES</p>
<figure data-type="image" tabindex="49"><img src="https://stormga.github.io//post-images/1548568601821.png" alt="" loading="lazy"></figure>
<p>ï¼ˆ2ï¼‰æ˜¾ç¤ºé›†åˆå…¨éƒ¨å…ƒç´ ï¼Œå¹¶ä½¿ç”¨WITHSCORES</p>
<figure data-type="image" tabindex="50"><img src="https://stormga.github.io//post-images/1548568660273.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>zrevrange</strong></li>
</ul>
<p>è¯­æ³•ï¼šzrevrange key start stop [WITHSCORES]</p>
<p>ä½œç”¨ï¼šè¿”å›æœ‰åºé›† key ä¸­ï¼ŒæŒ‡å®šåŒºé—´å†…çš„æˆå‘˜ã€‚å…¶ä¸­æˆå‘˜çš„ä½ç½®æŒ‰ score å€¼é€’å‡(ä»å¤§åˆ°å°)æ¥æ’åˆ—ã€‚å…¶å®ƒåŒzrangeå‘½ä»¤ã€‚</p>
<p>è¿”å›å€¼ï¼šè‡ªå®šåŒºé—´çš„æˆå‘˜é›†åˆ</p>
<figure data-type="image" tabindex="51"><img src="https://stormga.github.io//post-images/1548569040783.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>zrem</strong></li>
</ul>
<p>è¯­æ³•ï¼šzrem key member [memberâ€¦]</p>
<p>ä½œç”¨ï¼šåˆ é™¤æœ‰åºé›†åˆ key ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ï¼Œä¸å­˜åœ¨çš„æˆå‘˜è¢«å¿½ç•¥</p>
<p>è¿”å›å€¼ï¼šè¢«æˆåŠŸåˆ é™¤çš„æˆå‘˜æ•°é‡ï¼Œä¸åŒ…æ‹¬è¢«å¿½ç•¥çš„æˆå‘˜ã€‚</p>
<figure data-type="image" tabindex="52"><img src="https://stormga.github.io//post-images/548569116524.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>zcard</strong></li>
</ul>
<p>è¯­æ³•ï¼šzcard key</p>
<p>ä½œç”¨ï¼šè·å–æœ‰åºé›† key çš„å…ƒç´ æˆå‘˜çš„ä¸ªæ•°</p>
<p>è¿”å›å€¼ï¼škeyå­˜åœ¨è¿”å›é›†åˆå…ƒç´ çš„ä¸ªæ•°ï¼Œ keyä¸å­˜åœ¨ï¼Œè¿”å›0</p>
<figure data-type="image" tabindex="53"><img src="https://stormga.github.io//post-images/1548569148453.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>zrangebyscore</strong></li>
</ul>
<p>è¯­æ³•ï¼šzrangebyscore key min max [WITHSCORES ][LIMIT offset count]</p>
<p>ä½œç”¨ï¼šè·å–æœ‰åºé›† key ä¸­ï¼Œæ‰€æœ‰ score å€¼ä»‹äº min å’Œ max ä¹‹é—´ï¼ˆåŒ…æ‹¬minå’Œmaxï¼‰çš„æˆå‘˜ï¼Œæœ‰åºæˆå‘˜æ˜¯æŒ‰é€’å¢ï¼ˆä»å°åˆ°å¤§ï¼‰æ’åºã€‚</p>
<p>â€‹      min ,maxæ˜¯åŒ…æ‹¬åœ¨å†… ï¼Œ ä½¿ç”¨ç¬¦å· ( è¡¨ç¤ºä¸åŒ…æ‹¬ã€‚ minï¼Œmax å¯ä»¥ä½¿ç”¨ -inf  ï¼Œ+infè¡¨ç¤ºæœ€å°å’Œæœ€å¤§</p>
<p>â€‹     limit ç”¨æ¥é™åˆ¶è¿”å›ç»“æœçš„æ•°é‡å’ŒåŒºé—´ã€‚</p>
<p>â€‹     withscores æ˜¾ç¤ºscore å’Œ value</p>
<p>è¿”å›å€¼ï¼šæŒ‡å®šåŒºé—´çš„é›†åˆæ•°æ®</p>
<p>ï¼ˆ1ï¼‰ æ˜¾ç¤ºæŒ‡å®šå…·ä½“åŒºé—´çš„æ•°æ®</p>
<figure data-type="image" tabindex="54"><img src="https://stormga.github.io//post-images/1548569328020.png" alt="" loading="lazy"></figure>
<p>ï¼ˆ2ï¼‰æ˜¾ç¤ºæŒ‡å®šå…·ä½“åŒºé—´çš„é›†åˆæ•°æ®ï¼Œå¼€åŒºé—´ï¼ˆä¸åŒ…æ‹¬minï¼Œmaxï¼‰</p>
<figure data-type="image" tabindex="55"><img src="https://stormga.github.io//post-images/1548569412159.png" alt="" loading="lazy"></figure>
<p>ï¼ˆ3ï¼‰æ˜¾ç¤ºæ•´ä¸ªé›†åˆçš„æ‰€æœ‰æ•°æ®</p>
<figure data-type="image" tabindex="56"><img src="https://stormga.github.io//post-images/1548569462467.png" alt="" loading="lazy"></figure>
<p>ï¼ˆ4ï¼‰ä½¿ç”¨limit  0æ˜¯å¼€å§‹ä½ç½® 2æ˜¯æ•°é‡</p>
<figure data-type="image" tabindex="57"><img src="https://stormga.github.io//post-images/1548569509068.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>zrevrangebyscore</strong></li>
</ul>
<p>è¯­æ³•ï¼šzrevrangebyscore key max min  [WITHSCORES].[LIMIT offset count]</p>
<p>ä½œç”¨ï¼šè¿”å›æœ‰åºé›† key ä¸­ï¼Œ score å€¼ä»‹äº max å’Œ min ä¹‹é—´(é»˜è®¤åŒ…æ‹¬ç­‰äº max æˆ– min )çš„æ‰€æœ‰çš„æˆå‘˜ã€‚æœ‰åºé›†æˆå‘˜æŒ‰ score å€¼é€’å‡(ä»å¤§åˆ°å°)çš„æ¬¡åºæ’åˆ—ã€‚å…¶ä»–åŒzrangebyscore</p>
<figure data-type="image" tabindex="58"><img src="https://stormga.github.io//post-images/1548569655175.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>zcount</strong></li>
</ul>
<p>è¯­æ³•ï¼šzcount key min max</p>
<p>ä½œç”¨ï¼šè¿”å›æœ‰åºé›† key ä¸­ï¼Œ score å€¼åœ¨ min å’Œ max ä¹‹é—´(é»˜è®¤åŒ…æ‹¬ score å€¼ç­‰äº min æˆ– max )çš„æˆå‘˜çš„æ•°é‡</p>
<figure data-type="image" tabindex="59"><img src="https://stormga.github.io//post-images/1548569707391.png" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[RedisæŒä¹…åŒ–]]></title>
        <id>https://stormga.github.io/post/redis-persistence/</id>
        <link href="https://stormga.github.io/post/redis-persistence/">
        </link>
        <updated>2020-03-09T09:04:48.000Z</updated>
        <summary type="html"><![CDATA[<p>Redisæœ‰ä¸¤ç§æŒä¹…åŒ–çš„æ–¹å¼ï¼šå¿«ç…§ï¼ˆRDBæ–‡ä»¶ï¼‰å’Œè¿½åŠ å¼æ–‡ä»¶ï¼ˆAOFæ–‡ä»¶ï¼‰ï¼š</p>
<p>RDBæŒä¹…åŒ–æ–¹å¼ä¼šåœ¨ä¸€ä¸ªç‰¹å®šçš„é—´éš”ä¿å­˜é‚£ä¸ªæ—¶é—´ç‚¹çš„ä¸€ä¸ªæ•°æ®å¿«ç…§ã€‚<br>
AOFæŒä¹…åŒ–æ–¹å¼åˆ™ä¼šè®°å½•æ¯ä¸€ä¸ªæœåŠ¡å™¨æ”¶åˆ°çš„å†™æ“ä½œã€‚åœ¨æœåŠ¡å¯åŠ¨æ—¶ï¼Œè¿™äº›è®°å½•çš„æ“ä½œä¼šé€æ¡æ‰§è¡Œä»è€Œé‡å»ºå‡ºåŸæ¥çš„æ•°æ®ã€‚å†™æ“ä½œå‘½ä»¤è®°å½•çš„æ ¼å¼è·ŸRedisåè®®ä¸€è‡´ï¼Œä»¥è¿½åŠ çš„æ–¹å¼è¿›è¡Œä¿å­˜ã€‚<br>
Redisçš„æŒä¹…åŒ–æ˜¯å¯ä»¥ç¦ç”¨çš„ï¼Œå°±æ˜¯è¯´ä½ å¯ä»¥è®©æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸåªå­˜åœ¨äºæœåŠ¡å™¨çš„è¿è¡Œæ—¶é—´é‡Œã€‚<br>
ä¸¤ç§æ–¹å¼çš„æŒä¹…åŒ–æ˜¯å¯ä»¥åŒæ—¶å­˜åœ¨çš„ï¼Œä½†æ˜¯å½“Redisé‡å¯æ—¶ï¼ŒAOFæ–‡ä»¶ä¼šè¢«ä¼˜å…ˆç”¨äºé‡å»ºæ•°æ®ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>Redisæœ‰ä¸¤ç§æŒä¹…åŒ–çš„æ–¹å¼ï¼šå¿«ç…§ï¼ˆRDBæ–‡ä»¶ï¼‰å’Œè¿½åŠ å¼æ–‡ä»¶ï¼ˆAOFæ–‡ä»¶ï¼‰ï¼š</p>
<p>RDBæŒä¹…åŒ–æ–¹å¼ä¼šåœ¨ä¸€ä¸ªç‰¹å®šçš„é—´éš”ä¿å­˜é‚£ä¸ªæ—¶é—´ç‚¹çš„ä¸€ä¸ªæ•°æ®å¿«ç…§ã€‚<br>
AOFæŒä¹…åŒ–æ–¹å¼åˆ™ä¼šè®°å½•æ¯ä¸€ä¸ªæœåŠ¡å™¨æ”¶åˆ°çš„å†™æ“ä½œã€‚åœ¨æœåŠ¡å¯åŠ¨æ—¶ï¼Œè¿™äº›è®°å½•çš„æ“ä½œä¼šé€æ¡æ‰§è¡Œä»è€Œé‡å»ºå‡ºåŸæ¥çš„æ•°æ®ã€‚å†™æ“ä½œå‘½ä»¤è®°å½•çš„æ ¼å¼è·ŸRedisåè®®ä¸€è‡´ï¼Œä»¥è¿½åŠ çš„æ–¹å¼è¿›è¡Œä¿å­˜ã€‚<br>
Redisçš„æŒä¹…åŒ–æ˜¯å¯ä»¥ç¦ç”¨çš„ï¼Œå°±æ˜¯è¯´ä½ å¯ä»¥è®©æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸåªå­˜åœ¨äºæœåŠ¡å™¨çš„è¿è¡Œæ—¶é—´é‡Œã€‚<br>
ä¸¤ç§æ–¹å¼çš„æŒä¹…åŒ–æ˜¯å¯ä»¥åŒæ—¶å­˜åœ¨çš„ï¼Œä½†æ˜¯å½“Redisé‡å¯æ—¶ï¼ŒAOFæ–‡ä»¶ä¼šè¢«ä¼˜å…ˆç”¨äºé‡å»ºæ•°æ®ã€‚</p>
<!-- more -->
<h1 id="rdbæ–¹å¼">RDBæ–¹å¼</h1>
<p>Redis Databaseï¼šå°±æ˜¯åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å°†å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼Œæ•°æ®æ¢å¤æ—¶å°†å¿«ç…§æ–‡ä»¶ç›´æ¥å†è¯»åˆ°å†…å­˜ã€‚<br>
RDBä¿å­˜äº†æŸä¸€ä¸ªæ—¶é—´ç‚¹çš„æ•°æ®é›†ï¼Œå­˜å‚¨åœ¨ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œé»˜è®¤åä¸ºdump.rdbã€‚RDBæŠ€æœ¯é€‚åˆåšå¤‡ä»½ï¼Œå¯ä»¥ä¿å­˜æœ€è¿‘ä¸€ä¸ªå°æ—¶ï¼Œä¸€iè°ˆï¼Œä¸€ä¸ªæœˆçš„å…¨éƒ¨æ•°æ®<br>
** RDBæ¢å¤æ•°æ®æ¯”AOFé€Ÿåº¦å¿« **</p>
<h2 id="rdbå¦‚ä½•å®ç°">RDBå¦‚ä½•å®ç°</h2>
<ul>
<li>åœ¨redis.confæ–‡ä»¶ä¸­é…ç½®å³å¯ã€‚é»˜è®¤é…ç½®æ˜¯å¯ç”¨çš„ã€‚</li>
<li>åœ¨redis.confä¸­ä¿®æ”¹SNAPSHOTTINGä¸­çš„é…ç½®</li>
<li>ä¿®æ”¹dbfilename mydump.db</li>
</ul>
<h2 id="ä¼˜ç¼ºç‚¹">ä¼˜ç¼ºç‚¹</h2>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å­˜å‚¨çš„æ˜¯æ•°æ®å¿«ç…§æ–‡ä»¶ï¼Œæ¢å¤æ•°æ®æ–¹ä¾¿ï¼Œæ¯”è¾ƒå¿«</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>ä¼šä¸¢å¤±æœ€åä¸€æ¬¡å¿«ç…§ä»¥åæ›´æ”¹çš„æ•°æ®ï¼Œå¦‚æœä½ çš„åº”ç”¨èƒ½å®¹å¿ä¸€å®šæ•°æ®çš„ä¸¢å¤±ï¼Œå¯ä»¥ä½¿ç”¨rdbã€‚</li>
<li>rdbä¼šç»å¸¸æ“ä½œç£ç›˜ï¼Œredisä¼šåˆ†å‡ºä¸€ä¸ªå­è¿›ç¨‹ã€‚å¦‚æœredisæ•°æ®åº“æ¯”è¾ƒå¤§ï¼Œå­è¿›ç¨‹å ç”¨çš„æ—¶é—´å¤ªå¤šçš„è¯ï¼Œå¯èƒ½ä¼šå½±å“redisæš‚åœæœåŠ¡ï¼ˆmillisecondçº§åˆ«ï¼‰ï¼Œå¦‚æœæ•°æ®åº“è¶…çº§å¤§ï¼Œå¹¶ä¸”CPUæ¯”è¾ƒå¼±ï¼Œå¯èƒ½ä¼šè¾¾åˆ°ä¸€ç§’ã€‚</li>
</ul>
<h1 id="aofæ–¹å¼">AOFæ–¹å¼</h1>
<p>Append-only File,Redisæ¯æ¬¡æ¥æ”¶åˆ°ä¸€æ¡æ”¹å˜æ•°æ®çš„å‘½ä»¤æ—¶ï¼Œå®ƒå°†æŠŠè¯¥å‘½ä»¤å†™åˆ°ä¸€ä¸ªAOFæ–‡ä»¶ä¸­ï¼ˆåªè®°å½•å†™æ“ä½œï¼Œè¯»æ“ä½œä¸è®°å½•ï¼‰ï¼Œå½“Redisé‡å¯æ—¶ï¼Œå®ƒé€šè¿‡æ‰§è¡ŒAOFæ–‡ä»¶ä¸­æ‰€æœ‰çš„å‘½ä»¤æ¥æ¢å¤æ•°æ®ã€‚</p>
<h2 id="é…ç½®æ–¹å¼">é…ç½®æ–¹å¼</h2>
<ul>
<li>appendonly :é»˜è®¤ä¸ºnoï¼Œæ”¹ä¸ºyeså³å¼€å¯äº†æŒä¹…åŒ–</li>
<li>appendfilenameï¼šæŒ‡å®šAOFæ–‡ä»¶åï¼Œé»˜è®¤æ–‡ä»¶åä¸ºappendonly.aof</li>
<li>dir: RDB,AOFæ–‡ä»¶å­˜å‚¨çš„ç›®å½•ï¼Œé»˜è®¤ä¸º./</li>
<li>appendfsync:é…ç½®å‘aofæ–‡ä»¶å†™å‘½ä»¤æ•°æ®çš„ç­–ç•¥
<ul>
<li>noï¼šä¸ä¸»åŠ¨è¿›è¡ŒåŒæ­¥æ“ä½œï¼Œç”±æ“ä½œç³»ç»Ÿæ¥åšï¼ˆæ¯30sä¸€æ¬¡ï¼‰ï¼Œå¿«ä½†æ˜¯ä¸å®‰å…¨</li>
<li>alwaysï¼šæ¯æ¬¡å†™å…¥éƒ½ä¼šæ‰§è¡ŒåŒæ­¥ï¼Œæ…¢ä¸€äº›ä½†æ˜¯æ¯”è¾ƒå®‰å…¨ã€‚</li>
<li>everysecï¼šæ¯ç§’æ‰§è¡Œä¸€æ¬¡åŒæ­¥æ“ä½œï¼Œæ¯”è¾ƒå¹³è¡¡ï¼Œä»‹äºé€Ÿåº¦å’Œå®‰å…¨ä¹‹é—´ã€‚é»˜è®¤é¡¹</li>
</ul>
</li>
<li>Redisæ¯æ¬¡æ¥æ”¶åˆ°ä¸€æ¡æ”¹å˜æ•°æ®çš„å‘½ä»¤æ—¶ï¼Œå®ƒå°†æŠŠè¯¥å‘½ä»¤å†™åˆ°ä¸€ä¸ªAOFæ–‡ä»¶ä¸­ï¼ˆåªè®°å½•å†™æ“ä½œï¼Œè¯»æ“ä½œä¸è®°å½•ï¼‰ï¼Œå½“Redisé‡å¯æ—¶ï¼Œå®ƒé€šè¿‡æ‰§è¡ŒAOFæ–‡ä»¶ä¸­æ‰€æœ‰çš„å‘½ä»¤æ¥æ¢å¤æ•°æ®ã€‚</li>
</ul>
<h2 id="ä¼˜ç¼ºç‚¹-2">ä¼˜ç¼ºç‚¹</h2>
<ul>
<li>AOFæ–‡ä»¶åœ¨æ“ä½œçš„æ—¶å€™ä¼šå˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œä¾‹å¦‚åš100æ¬¡å‡å‘è®¡ç®—ï¼Œåœ¨æ•°æ®åº“ä¸­ä¼šå¾—åˆ°æœ€ç»ˆçš„å€¼è€ŒAOFä¸­ä¼šå­˜åœ¨100æ¡è®°å½•ï¼Œä½†99æ¡æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œä½†æ˜¯redisæ”¯æŒåœ¨ä¸å½±å“æœåŠ¡çš„å‰æä¸‹åå°é‡æ„AOFæ–‡ä»¶ã€‚</li>
<li>å¯ä»¥åŒæ—¶ä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•ï¼Œredisé»˜è®¤ä¼˜å…ˆåŠ è½½aofæ–‡ä»¶ï¼ˆæ•°æ®æœ€å®Œæ•´ï¼‰</li>
</ul>
<h1 id="æ€§èƒ½ä¸å®è·µ">æ€§èƒ½ä¸å®è·µ</h1>
<h2 id="æ€§èƒ½åˆ†æ">æ€§èƒ½åˆ†æ</h2>
<p>RDBçš„å¿«ç…§ã€AOFçš„é‡å†™éƒ½éœ€è¦forkï¼Œè¿™æ˜¯ä¸€ä¸ªé‡é‡çº§æ“ä½œï¼Œä¼šå¯¹Redisé€ æˆé˜»å¡ã€‚å› æ­¤ä¸ºäº†ä¸å½±å“Redisä¸»è¿›ç¨‹å“åº”ï¼Œæˆ‘ä»¬éœ€è¦å°½å¯èƒ½é™ä½é˜»å¡ã€‚</p>
<ol>
<li>é™ä½forkçš„é¢‘ç‡ï¼Œæ¯”å¦‚å¯ä»¥æ‰‹åŠ¨æ¥è§¦å‘RDBç”Ÿæˆå¿«ç…§ã€ä¸AOFé‡å†™ï¼›</li>
<li>æ§åˆ¶Redisæœ€å¤§ä½¿ç”¨å†…å­˜ï¼Œé˜²æ­¢forkè€—æ—¶è¿‡é•¿ï¼›</li>
<li>ä½¿ç”¨æ›´ç‰›é€¼çš„ç¡¬ä»¶ï¼›</li>
<li>åˆç†é…ç½®Linuxçš„å†…å­˜åˆ†é…ç­–ç•¥ï¼Œé¿å…å› ä¸ºç‰©ç†å†…å­˜ä¸è¶³å¯¼è‡´forkå¤±è´¥ã€‚</li>
</ol>
<h2 id="å®è·µç»éªŒ">å®è·µç»éªŒ</h2>
<ul>
<li>å¦‚æœRedisä¸­çš„æ•°æ®å¹¶ä¸æ˜¯ç‰¹åˆ«æ•æ„Ÿæˆ–è€…å¯ä»¥é€šè¿‡å…¶å®ƒæ–¹å¼é‡å†™ç”Ÿæˆæ•°æ®ï¼Œå¯ä»¥å…³é—­æŒä¹…åŒ–ï¼Œå¦‚æœä¸¢å¤±æ•°æ®å¯ä»¥é€šè¿‡å…¶å®ƒé€”å¾„è¡¥å›ï¼›</li>
<li>è‡ªå·±åˆ¶å®šç­–ç•¥å®šæœŸæ£€æŸ¥Redisçš„æƒ…å†µï¼Œç„¶åå¯ä»¥æ‰‹åŠ¨è§¦å‘å¤‡ä»½ã€é‡å†™æ•°æ®ï¼›</li>
<li>å•æœºå¦‚æœéƒ¨ç½²å¤šä¸ªå®ä¾‹ï¼Œè¦é˜²æ­¢å¤šä¸ªæœºå™¨åŒæ—¶è¿è¡ŒæŒä¹…åŒ–ã€é‡å†™æ“ä½œï¼Œé˜²æ­¢å‡ºç°å†…å­˜ã€CPUã€IOèµ„æºç«äº‰ï¼Œè®©æŒä¹…åŒ–å˜ä¸ºä¸²è¡Œï¼›</li>
<li>å¯ä»¥åŠ å…¥ä¸»ä»æœºå™¨ï¼Œåˆ©ç”¨ä¸€å°ä»æœºå™¨è¿›è¡Œå¤‡ä»½å¤„ç†ï¼Œå…¶å®ƒæœºå™¨æ­£å¸¸å“åº”å®¢æˆ·ç«¯çš„å‘½ä»¤ï¼›</li>
<li>RDBæŒä¹…åŒ–ä¸AOFæŒä¹…åŒ–å¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œé…åˆä½¿ç”¨ã€‚</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Java-é›†åˆ]]></title>
        <id>https://stormga.github.io/post/java-jihe/</id>
        <link href="https://stormga.github.io/post/java-jihe/">
        </link>
        <updated>2020-03-09T08:11:17.000Z</updated>
        <summary type="html"><![CDATA[<p>æœ¬ç¯‡æ–‡ç« ä¸»è¦å¯¹javaé›†åˆçš„æ¡†æ¶è¿›è¡Œä»‹ç»ï¼Œä½¿å¤§å®¶å¯¹javaé›†åˆçš„æ•´ä½“æ¡†æ¶æœ‰ä¸ªäº†è§£ã€‚å…·ä½“ä»‹ç»äº†Collectionæ¥å£ï¼ŒMapæ¥å£ä»¥åŠCollectionæ¥å£çš„ä¸‰ä¸ªå­æ¥å£Setï¼ŒListï¼ŒQueueã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>æœ¬ç¯‡æ–‡ç« ä¸»è¦å¯¹javaé›†åˆçš„æ¡†æ¶è¿›è¡Œä»‹ç»ï¼Œä½¿å¤§å®¶å¯¹javaé›†åˆçš„æ•´ä½“æ¡†æ¶æœ‰ä¸ªäº†è§£ã€‚å…·ä½“ä»‹ç»äº†Collectionæ¥å£ï¼ŒMapæ¥å£ä»¥åŠCollectionæ¥å£çš„ä¸‰ä¸ªå­æ¥å£Setï¼ŒListï¼ŒQueueã€‚</p>
<!-- more -->
<h1 id="é›†åˆ">é›†åˆ</h1>
<ul>
<li>é›†åˆæ˜¯ç”¨æ¥å­˜å‚¨ç±»å‹æ•°æ®çš„å®¹å™¨</li>
<li>é›†åˆæ˜¯ç”¨æ¥å­˜å‚¨å¯¹è±¡çš„å¼•ç”¨</li>
</ul>
<h2 id="collectioné›†åˆå¸¸ç”¨æ–¹æ³•">Collectioné›†åˆå¸¸ç”¨æ–¹æ³•</h2>
<table>
<thead>
<tr>
<th>boolean</th>
<th><a href="#add-E-">add</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/Collection.html">E</a> e) å‘é›†åˆä¸­æ·»åŠ å…ƒç´ e</th>
</tr>
</thead>
<tbody>
<tr>
<td>boolean</td>
<td><a href="#addAll-java.util.Collection-">addAll</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/Collection.html">Collection</a>&lt;? extends <a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/Collection.html">E</a>&gt; c)  æŠŠcé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ åˆ°å½“å‰é›†åˆä¸­</td>
</tr>
<tr>
<td>void</td>
<td><a href="#clear--">clear</a>() æ¸…ç©ºé›†åˆä¸­æ‰€æœ‰å…ƒç´ .</td>
</tr>
<tr>
<td>boolean</td>
<td><a href="#contains-java.lang.Object-">contains</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/lang/Object.html">Object</a> o) åˆ¤æ–­å½“å‰é›†åˆæ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ o.</td>
</tr>
<tr>
<td>boolean</td>
<td><a href="#containsAll-java.util.Collection-">containsAll</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/Collection.html">Collection</a>&lt;?&gt; c) åˆ¤æ–­å½“å‰é›†åˆæ˜¯å¦åŒ…å«cé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ </td>
</tr>
<tr>
<td>boolean</td>
<td><a href="#equals-java.lang.Object-">equals</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/lang/Object.html">Object</a> o).</td>
</tr>
<tr>
<td>int</td>
<td><a href="#hashCode--">hashCode</a>().</td>
</tr>
<tr>
<td>boolean</td>
<td><a href="#isEmpty--">isEmpty</a>() åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©º.</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/Iterator.html">Iterator</a><E></td>
<td><a href="#iterator--">iterator</a>() è¿”å›é›†åˆçš„è¿­ä»£å™¨.</td>
</tr>
<tr>
<td>boolean</td>
<td><a href="#remove-java.lang.Object-">remove</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/lang/Object.html">Object</a> o) åœ¨å½“å‰é›†åˆä¸­åˆ é™¤ç¬¬ä¸€ä¸ªä¸å…ƒç´ oåŒ¹é…çš„å…ƒç´ .</td>
</tr>
<tr>
<td>boolean</td>
<td><a href="#removeAll-java.util.Collection-">removeAll</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/Collection.html">Collection</a>&lt;?&gt; c) åœ¨å½“å‰é›†åˆä¸­åˆ é™¤æ‰€æœ‰å‡ºç°åœ¨cé›†åˆä¸­çš„å…ƒç´ .</td>
</tr>
<tr>
<td>boolean</td>
<td><a href="#retainAll-java.util.Collection-">retainAll</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/Collection.html">Collection</a>&lt;?&gt; c) åªä¿ç•™åœ¨é›†åˆcä¸­å‡ºç°çš„å…ƒç´ ,å…¶ä»–çš„å…ƒç´ éƒ½åˆ é™¤.</td>
</tr>
<tr>
<td>int</td>
<td><a href="#size--">size</a>() è¿”å›å…ƒç´ çš„ä¸ªæ•°.</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/lang/Object.html">Object</a>[]</td>
<td><a href="#toArray--">toArray</a>() é›†åˆè½¬æ•°ç»„.</td>
</tr>
<tr>
<td><T> T[]</td>
<td><a href="#toArray-T:A-">toArray</a>(T[] a)</td>
</tr>
</tbody>
</table>
<h2 id="listé›†åˆ">Listé›†åˆ</h2>
<ul>
<li>ç»§æ‰¿äº†Collection,Collectionæ‰€æœ‰çš„æ“ä½œ,Listéƒ½æœ‰</li>
<li>Listå­˜å‚¨ç‰¹ç‚¹: æœ‰åº,å¯é‡å¤</li>
<li>Listé›†åˆä¸ºæ¯ä¸ªå…ƒç´ æŒ‡å®šä¸€ä¸ªç´¢å¼•å€¼, ä¸»è¦å¢åŠ äº†é’ˆå¯¹ç´¢å¼•å€¼çš„æ“ä½œ</li>
</ul>
<table>
<thead>
<tr>
<th>void</th>
<th><a href="#add-int-E-">add</a>(int index, <a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/List.html">E</a> element) åœ¨æŒ‡å®šä½ç½®æ·»åŠ å…ƒç´ </th>
</tr>
</thead>
<tbody>
<tr>
<td>boolean</td>
<td><a href="#addAll-int-java.util.Collection-">addAll</a>(int index, <a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/Collection.html">Collection</a>&lt;? extends <a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/List.html">E</a>&gt; c)</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/List.html">E</a></td>
<td><a href="#get-int-">get</a>(int index) è¿”å›æŒ‡å®šä½ç½®å…ƒç´ çš„å€¼</td>
</tr>
<tr>
<td>int</td>
<td><a href="#indexOf-java.lang.Object-">indexOf</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/lang/Object.html">Object</a> o) è¿”å›å…ƒç´ oç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</td>
</tr>
<tr>
<td>int</td>
<td><a href="#lastIndexOf-java.lang.Object-">lastIndexOf</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/lang/Object.html">Object</a> o) è¿”å›å…ƒç´ oæœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•å€¼</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/ListIterator.html">ListIterator</a><E></td>
<td><a href="#listIterator--">listIterator</a>() è¿”å›ListIteratorè¿­ä»£å™¨</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/List.html">E</a></td>
<td><a href="#remove-int-">remove</a>(int index)</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/List.html">E</a></td>
<td><a href="#set-int-E-">set</a>(int index, <a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/List.html">E</a> element)</td>
</tr>
<tr>
<td>void</td>
<td><a href="#sort-java.util.Comparator-">sort</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/Comparator.html">Comparator</a>&lt;? super <a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/List.html">E</a>&gt; c)</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/List.html">List</a><E></td>
<td><a href="#subList-int-int-">subList</a>(int fromIndex, int toIndex) è¿”å›å­åˆ—è¡¨</td>
</tr>
</tbody>
</table>
<h3 id="arraylistå’Œvector">ArrayListå’ŒVector</h3>
<ul>
<li>åº•å±‚éƒ½æ˜¯æ•°ç»„</li>
<li>é»˜è®¤åˆå§‹åŒ–å®¹é‡: 10</li>
<li>ArrayListæ‰©å®¹: 1.5å€,  Vectoré»˜è®¤æŒ‰2å€å¤§å°æ‰©å®¹</li>
<li>Vectoræä¾›çš„æ“ä½œéƒ½ä½¿ç”¨synchronizedä¿®é¥°, æ˜¯çº¿ç¨‹å®‰å…¨çš„, ArrayListä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„</li>
</ul>
<h3 id="linkedlist">LinkedList</h3>
<ul>
<li>åº•å±‚æ˜¯åŒå‘é“¾è¡¨</li>
<li>å¸¸ç”¨æ“ä½œ</li>
</ul>
<table>
<thead>
<tr>
<th>void</th>
<th><a href="#addFirst-E-">addFirst</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a> e) æŠŠå…ƒç´ eæ·»åŠ åˆ°é“¾è¡¨çš„å¤´éƒ¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>void</td>
<td><a href="#addLast-E-">addLast</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a> e)  æŠŠå…ƒç´ eæ·»åŠ åˆ°æœ€å</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/Iterator.html">Iterator</a><E></td>
<td><a href="#descendingIterator--">descendingIterator</a>() é€†åºè¿­ä»£</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a></td>
<td><a href="#element--">element</a>() è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ .</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a></td>
<td><a href="#getFirst--">getFirst</a>()è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ .</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a></td>
<td><a href="#getLast--">getLast</a>()è¿”å›æœ€åä¸€ä¸ªå…ƒç´ </td>
</tr>
<tr>
<td>boolean</td>
<td><a href="#offer-E-">offer</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a> e) æŠŠå…ƒç´ eæ·»åŠ åˆ°æœ€å.</td>
</tr>
<tr>
<td>boolean</td>
<td><a href="#offerFirst-E-">offerFirst</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a> e) æŠŠå…ƒç´ eæ·»åŠ åˆ°æœ€å‰é¢,é“¾è¡¨çš„å¤´éƒ¨</td>
</tr>
<tr>
<td>boolean</td>
<td><a href="#offerLast-E-">offerLast</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a> e) æŠŠå…ƒç´ eæ·»åŠ åˆ°æœ€å</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a></td>
<td><a href="#peek--">peek</a>().è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ .</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a></td>
<td><a href="#peekFirst--">peekFirst</a>()è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ .</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a></td>
<td><a href="#peekLast--">peekLast</a>()è¿”å›æœ€åä¸€ä¸ªå…ƒç´ .</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a></td>
<td><a href="#poll--">poll</a>() åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ,å¹¶æŠŠåˆ é™¤çš„å…ƒç´ è¿”å›.</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a></td>
<td><a href="#pollFirst--">pollFirst</a>()åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ,å¹¶æŠŠåˆ é™¤çš„å…ƒç´ è¿”å›..</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a></td>
<td><a href="#pollLast--">pollLast</a>()åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ ,å¹¶æŠŠåˆ é™¤çš„å…ƒç´ è¿”å›.</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a></td>
<td><a href="#pop--">pop</a>()åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ,å¹¶æŠŠåˆ é™¤çš„å…ƒç´ è¿”å›.</td>
</tr>
<tr>
<td>void</td>
<td><a href="#push-E-">push</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a> e) æŠŠå…ƒç´ eæ·»åŠ åˆ°é“¾è¡¨çš„å¤´éƒ¨</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a></td>
<td><a href="#removeFirst--">removeFirst</a>()åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ,å¹¶æŠŠåˆ é™¤çš„å…ƒç´ è¿”å›.</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/LinkedList.html">E</a></td>
<td><a href="#removeLast--">removeLast</a>()åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ ,å¹¶æŠŠåˆ é™¤çš„å…ƒç´ è¿”å›.</td>
</tr>
</tbody>
</table>
<h2 id="seté›†åˆ">Seté›†åˆ</h2>
<p>** ç‰¹ç‚¹ï¼šæ— åºï¼Œä¸å¯é‡å¤ **</p>
<h3 id="hashset">HashSet</h3>
<ul>
<li>
<p>HashSetåº•å±‚æ˜¯HashMap, HashSetçš„æ— å‚æ„é€ ç»™hashMapè¿›è¡Œäº†åˆå§‹åŒ–</p>
</li>
<li>
<p>å‘hashSetä¸­é€šè¿‡add(e)æ·»åŠ ä¸€ä¸ªå…ƒç´ , å®é™…ä¸Šæ˜¯æŠŠè¿™ä¸ªå…ƒç´ ä½œä¸º é”®,æ·»åŠ åˆ°äº†åº•å±‚çš„hashMapä¸­</p>
<p>map.put(e, PRESENT)</p>
</li>
<li>
<p>HashSetå®é™…ä¸Šæ˜¯å°±æ˜¯åº•å±‚HashMapçš„é”®çš„é›†åˆ</p>
</li>
<li>
<p>å› ä¸ºMapä¸­çš„é”®ä¸å…è®¸é‡å¤,æ‰€ä»¥HashSetä¹Ÿä¸èƒ½å­˜å‚¨é‡å¤çš„å…ƒç´ </p>
</li>
</ul>
<h3 id="treeset">TreeSet</h3>
<ul>
<li>
<p>TreeSet å®ç°äº†SortedSet, å¯ä»¥å¯¹å­˜å‚¨çš„å…ƒç´ è¿›è¡Œè‡ªç„¶æ’åº</p>
</li>
<li>
<p>TreeSetè¦æ±‚å­˜å‚¨çš„å…ƒç´ å¿…é¡»æ˜¯å¯æ¯”è¾ƒçš„</p>
<ul>
<li>è¦ä¹ˆæŒ‡å®šComparatoræ¯”è¾ƒå™¨</li>
<li>æ²¡æœ‰Comparatoræ¯”è¾ƒå™¨,å…ƒç´ çš„ç±»è¦å®ç°Comparableæ¥å£</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a></th>
<th><a href="#ceiling-E-">ceiling</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a> e) è¿”å›Seté›†åˆä¸­å¤§äºç­‰äºæŒ‡å®šå…ƒç´ eçš„æœ€å°å…ƒç´ .</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/Iterator.html">Iterator</a><E></td>
<td><a href="#descendingIterator--">descendingIterator</a>() è¿”å›TreeSeté›†åˆçš„é€†åºè¿­ä»£.</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/NavigableSet.html">NavigableSet</a><E></td>
<td><a href="#descendingSet--">descendingSet</a>() è¿”å›TreeSeté›†åˆçš„é€†åº.</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a></td>
<td><a href="#first--">first</a>() è¿”å›TreeSeté›†åˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ </td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a></td>
<td><a href="#floor-E-">floor</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a> e) è¿”å›Seté›†åˆä¸­å°äºç­‰äºæŒ‡å®šå…ƒç´ eçš„æœ€å¤§å…ƒç´ .</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/SortedSet.html">SortedSet</a><E></td>
<td><a href="#headSet-E-">headSet</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a> toElement) è¿”å›TreeSeté›†åˆä»å¼€å§‹åˆ°æŒ‡å®šå…ƒç´ toElementä¹‹é—´çš„è§†å›¾</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/NavigableSet.html">NavigableSet</a><E></td>
<td><a href="#headSet-E-boolean-">headSet</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a> toElement, boolean inclusive).</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a></td>
<td><a href="#higher-E-">higher</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a> e). è¿”å›TreeSeté›†åˆä¸­å¤§äºæŒ‡å®šå…ƒç´ eçš„æœ€å°å…ƒç´ </td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a></td>
<td><a href="#last--">last</a>()è¿”å›TreeSeté›†åˆæœ€åä¸€ä¸ªå…ƒç´ </td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a></td>
<td><a href="#lower-E-">lower</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a> e) è¿”å›TreeSeté›†åˆä¸­å°äºæŒ‡å®šå…ƒç´ eçš„æœ€å¤§å…ƒç´ </td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a></td>
<td><a href="#pollFirst--">pollFirst</a>() åˆ é™¤TreeSeté›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ ,å¹¶æŠŠåˆ é™¤çš„å…ƒç´ è¿”å›.</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a></td>
<td><a href="#pollLast--">pollLast</a>()åˆ é™¤TreeSeté›†åˆçš„æœ€åä¸€ä¸ªå…ƒç´ ,å¹¶æŠŠåˆ é™¤çš„å…ƒç´ è¿”å›</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/SortedSet.html">SortedSet</a><E></td>
<td><a href="#subSet-E-E-">subSet</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a> fromElement, <a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a> toElement) è¿”å›TreeSetæŒ‡å®šèŒƒå›´[fromElement, toElement)å†…çš„è§†å›¾ .</td>
</tr>
<tr>
<td><a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/SortedSet.html">SortedSet</a><E></td>
<td><a href="#tailSet-E-">tailSet</a>(<a href="mk:MSITStore:D:%5Ccourse%5C03-JavaSE%5Cresources%5Cjdk1_8.chm::/java/util/TreeSet.html">E</a> fromElement).è¿”å›ä»æŒ‡å®šå…ƒç´ fromElementåˆ°æœ€åçš„ä¸€ä¸ªå­è§†å›¾</td>
</tr>
</tbody>
</table>
<p><strong>æ³¨æ„:</strong></p>
<ul>
<li>
<p>TreeSeté›†åˆçš„contains()/remove()æ–¹æ³•æ˜¯æ ¹æ®Comparatoræˆ–è€…Comparableçš„æ¯”è¾ƒç»“æœæ˜¯å¦ä¸º0æ¥åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨</p>
</li>
<li>
<p>å¦‚ä½•é€‰æ‹©Comparatorè¿˜æ˜¯Comparable??</p>
<p>é€šè¿‡Comparatorå¯ä»¥å®šä¹‰å¤šç§æ¯”è¾ƒå™¨</p>
<p>ç±»å®ç°äº†Comparableæ¥å£ä¹‹å ,æ’åºè§„åˆ™å°±å›ºå®šäº†, å¯ä»¥æŠŠå®ƒå½“ä½œé»˜è®¤çš„æ’åº</p>
</li>
</ul>
<h2 id="è¿­ä»£å™¨">è¿­ä»£å™¨</h2>
<p><strong>é›†åˆç»§æ‰¿Iterableæ¥å£ï¼Œç”¨é›†åˆçš„iteartor()æ–¹æ³•å¾—åˆ°è¿­ä»£å™¨å¯¹è±¡</strong></p>
<h3 id="collectioné›†åˆä¸­ä½¿ç”¨è¿­ä»£å™¨">Collectioné›†åˆä¸­ä½¿ç”¨è¿­ä»£å™¨</h3>
<pre><code class="language-java">Iterator&lt;String&gt; iterator = collection.iterator();
		/*
		 * 1)åˆšåˆšè·å¾—è¿­ä»£å™¨å¯¹è±¡æ—¶, è¿­ä»£å™¨çš„æ¸¸æ ‡æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„å‰é¢
		 * 2) hasNext()åˆ¤æ–­æ˜¯å¦è¿˜æœ‰æ²¡æœ‰è®¿é—®åˆ°çš„å…ƒç´ 
		 * 3) next()æŠŠä¸‹ä¸€ä¸ªæ²¡è®¿é—®çš„å…ƒç´ è¿”å›, æ¸¸æ ‡ä¸‹ç§»
		 */
		while( iterator.hasNext()){
			String next = iterator.next();
			System.out.println( next );
		}
</code></pre>
<p>###è¿­ä»£å™¨ä¸­æœ‰ä¸¤ä¸ªé‡è¦æ–¹æ³•</p>
<ul>
<li>hasNext() åˆ¤æ–­æ¸¸æ ‡åé¢è¿˜æœ‰ æ²¡æœ‰è®¿é—®åˆ°çš„å…ƒç´ </li>
<li>next() æŠŠä¸‹ä¸€ä¸ªæ²¡æœ‰è®¿é—®çš„å…ƒç´ è¿”å›ï¼Œæ¸¸æ ‡ä¸‹ç§»</li>
</ul>
<h3 id="ä½¿ç”¨è¿­ä»£å™¨çš„æ³¨æ„äº‹é¡¹">ä½¿ç”¨è¿­ä»£å™¨çš„æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>
<p>æ¯æ¬¡è¿­ä»£å®Œåï¼Œæ¸¸æ ‡å°±åœ¨æœ€åä¸€ä¸ªå…ƒç´ åé¢ï¼Œå¦‚æœæˆ‘ä»¬è¿˜æƒ³ä½¿ç”¨è¿­ä»£å™¨æˆ‘ä»¬éœ€è¦é‡æ–°è·å–</p>
</li>
<li>
<pre><code class="language-java">Iterator&lt;String&gt; iterator = collection.iterator();
      while(iterator.hasNext()){
          collection.remove(&quot;abc&quot;);
      
</code></pre>
</li>
</ul>
<pre><code>  **è¿™æ®µä»£ç æ˜¯é”™è¯¯çš„**

  æˆ‘ä»¬é˜…è¯»æºç ä¼šå‘ç°ï¼š

  Iteratoråœ¨åˆ›å»ºçš„æ—¶å€™ä¼šè¿”å›ä¸€ä¸ªItrå¯¹è±¡

  æºç ï¼š

  ```java
      public Iterator&lt;E&gt; iterator() {
          return new Itr();
      }
</code></pre>
<p>è€Œè¿™ä¸ªItræ˜¯é›†åˆçš„å†…éƒ¨ç±»ï¼Œæˆ‘ä»¬ä»¥ArrayListåˆ†æ</p>
<pre><code class="language-java">  private class Itr implements Iterator&lt;E&gt; {
      int cursor;       // index of next element to return
      int lastRet = -1; // index of last element returned; -1 if no such
      int expectedModCount = modCount;

      // prevent creating a synthetic constructor
      Itr() {}

</code></pre>
<p>è¿™ä¸ªmodCountæ˜¯ArrayListçš„ä¸€ä¸ªæˆå‘˜å˜é‡</p>
<p>â€‹</p>
<pre><code class="language-java">protected transient int modCount = 0;
</code></pre>
<p>æ¯æ¬¡ArrayListè¿›è¡Œ remove,addæ“ä½œå°±ä¼šæ”¹å˜modCountçš„å€¼ã€‚</p>
<p>è€Œè¿­ä»£å™¨çš„nextæ–¹æ³•ä¼šæ£€æŸ¥è¿™ä¸¤ä¸ªå€¼æ˜¯å¦ä¸€æ ·ï¼Œä¸ä¸€æ ·ä¼šæŠ›å¼‚å¸¸ã€‚</p>
<p><strong>ç»“è®ºï¼š</strong></p>
<p><strong>å½“æˆ‘ä»¬åˆ›å»ºçš„Iteratoræ—¶ï¼Œæˆ‘ä»¬å°±ä¸èƒ½ä½¿ç”¨é›†åˆè‡ªèº«çš„removeï¼Œaddç­‰æ–¹æ³•äº†ï¼Œå¦åˆ™æˆ‘ä»¬è¿›è¡Œè¿­ä»£çš„æ—¶å€™ä¼šæŠ›å¼‚å¸¸ã€‚ç”±äºforeachå¾ªç¯æ˜¯åº•å±‚æ˜¯è¿­ä»£å™¨å®ç°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨foreachå¾ªç¯çš„æ—¶å€™ä¹Ÿä¸èƒ½ä½¿ç”¨removeï¼Œaddï¼Œclearç­‰æ–¹æ³•</strong></p>
<h2 id="mapé›†åˆ">Mapé›†åˆ</h2>
<h3 id="linkedhashmap">LinkedHashMap</h3>
<pre><code class="language-java">public class LinkedHashMap&lt;K,V&gt; extends HashMap&lt;K,V&gt; implements Map&lt;K,V&gt;
</code></pre>
<p>ç»§æ‰¿è‡ªHashMapï¼Œä¸€ä¸ªæœ‰åºçš„Mapæ¥å£å®ç°ï¼Œè¿™é‡Œçš„æœ‰åºæŒ‡çš„æ˜¯å…ƒç´ å¯ä»¥æŒ‰æ’å…¥é¡ºåºæˆ–è®¿é—®é¡ºåºæ’åˆ—ï¼›ä¸HashMapç›¸æ¯”ï¼Œå› ä¸ºLinkedHashMapæ˜¯ç»§æ‰¿è‡ªHashMapï¼Œå› æ­¤LinkedHashMapï¼š</p>
<ul>
<li>åŒæ ·æ˜¯åŸºäºæ•£åˆ—è¡¨å®ç°ã€‚</li>
<li>åŒæ—¶å®ç°äº†Serializable å’Œ Cloneableæ¥å£ï¼Œæ”¯æŒåºåˆ—åŒ–å’Œå…‹éš†ã€‚</li>
<li>å¹¶ä¸”åŒæ ·ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</li>
</ul>
<p>åŒºåˆ«æ˜¯å…¶å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªåŒå‘å¾ªç¯é“¾è¡¨ï¼Œè¯¥é“¾è¡¨æ˜¯æœ‰åºçš„ï¼Œå¯ä»¥æŒ‰å…ƒç´ æ’å…¥é¡ºåºæˆ–å…ƒç´ æœ€è¿‘è®¿é—®é¡ºåº(LRU)æ’åˆ—ã€‚</p>
<h4 id="linkedhashmapæºç åˆ†æ">LinkedHashMapæºç åˆ†æ</h4>
<ul>
<li>
<p>ç”±äºLinkedHashMapç»§æ‰¿è‡ªHashMapï¼Œæ‰€ä»¥å®ƒä¸ä»…åƒHashMapé‚£æ ·å¯¹å…¶è¿›è¡ŒåŸºäºå“ˆå¸Œè¡¨å’Œå•é“¾è¡¨çš„Entryæ•°ç»„+ nexté“¾è¡¨çš„å­˜å‚¨æ–¹å¼ï¼Œè€Œä¸”è¿˜ç»“åˆäº†LinkedListçš„ä¼˜ç‚¹ï¼Œä¸ºæ¯ä¸ªEntryèŠ‚ç‚¹å¢åŠ äº†å‰é©±å’Œåç»§ï¼Œå¹¶å¢åŠ äº†ä¸€ä¸ªä¸ºheaderå¤´ç»“ç‚¹ï¼Œæ„é€ äº†ä¸€ä¸ªåŒå‘å¾ªç¯é“¾è¡¨ã€‚<strong>ï¼ˆå¤šä¸€ä¸ªä»¥headerä¸ºå¤´ç»“ç‚¹çš„åŒå‘å¾ªç¯é“¾è¡¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡putè¿›æ¥KVï¼Œé™¤äº†å°†å…¶ä¿å­˜åˆ°å¯¹å“ˆå¸Œè¡¨ä¸­çš„å¯¹åº”ä½ç½®å¤–ï¼Œè¿˜è¦å°†å…¶æ’å…¥åˆ°åŒå‘å¾ªç¯é“¾è¡¨çš„å°¾éƒ¨ã€‚ï¼‰</strong></p>
</li>
<li>
<p>LinkedHashMapçš„å±æ€§æ¯”HashMapå¤šäº†ä¸€ä¸ªaccessOrderå±æ€§ã€‚<strong>å½“å®ƒfalseæ—¶ï¼Œè¡¨ç¤ºåŒå‘é“¾è¡¨ä¸­çš„å…ƒç´ æŒ‰ç…§Entryæ’å…¥LinkedHashMapåˆ°ä¸­çš„å…ˆåé¡ºåºæ’åº</strong>ï¼Œå³æ¯æ¬¡putåˆ°LinkedHashMapä¸­çš„Entryéƒ½æ”¾åœ¨åŒå‘é“¾è¡¨çš„å°¾éƒ¨ï¼Œè¿™æ ·éå†åŒå‘é“¾è¡¨æ—¶ï¼ŒEntryçš„è¾“å‡ºé¡ºåºä¾¿å’Œæ’å…¥çš„é¡ºåºä¸€è‡´ï¼Œè¿™ä¹Ÿæ˜¯é»˜è®¤çš„åŒå‘é“¾è¡¨çš„å­˜å‚¨é¡ºåºï¼›<strong>å½“å®ƒä¸ºtrueæ—¶ï¼Œè¡¨ç¤ºåŒå‘é“¾è¡¨ä¸­çš„å…ƒç´ æŒ‰ç…§è®¿é—®çš„å…ˆåé¡ºåºæ’åˆ—</strong>ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶Entryæ’å…¥é“¾è¡¨çš„é¡ºåºä¾ç„¶æ˜¯æŒ‰ç…§å…¶putåˆ°LinkedHashMapä¸­çš„é¡ºåºï¼Œä½†putå’Œgetæ–¹æ³•å‡æœ‰è°ƒç”¨recordAccessæ–¹æ³•ï¼ˆputæ–¹æ³•åœ¨keyç›¸åŒï¼Œè¦†ç›–åŸæœ‰çš„Entryçš„æƒ…å†µä¸‹è°ƒç”¨recordAccessæ–¹æ³•ï¼‰ï¼Œè¯¥æ–¹æ³•åˆ¤æ–­accessOrderæ˜¯å¦ä¸ºtrueï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å°†å½“å‰è®¿é—®çš„Entryï¼ˆputè¿›æ¥çš„Entryæˆ–getå‡ºæ¥çš„Entryï¼‰ç§»åˆ°åŒå‘é“¾è¡¨çš„å°¾éƒ¨ï¼ˆkeyä¸ç›¸åŒæ—¶ï¼Œputæ–°Entryæ—¶ï¼Œä¼šè°ƒç”¨addEntryï¼Œå®ƒä¼šè°ƒç”¨creatEntryï¼Œè¯¥æ–¹æ³•åŒæ ·å°†æ–°æ’å…¥çš„å…ƒç´ æ”¾å…¥åˆ°åŒå‘é“¾è¡¨çš„å°¾éƒ¨ï¼Œæ—¢ç¬¦åˆæ’å…¥çš„å…ˆåé¡ºåºï¼Œåˆç¬¦åˆè®¿é—®çš„å…ˆåé¡ºåºï¼Œå› ä¸ºè¿™æ—¶è¯¥Entryä¹Ÿè¢«è®¿é—®äº†ï¼‰ï¼Œå¦åˆ™ï¼Œä»€ä¹ˆä¹Ÿä¸åšã€‚</p>
</li>
<li>
<p>æ„é€ å‡½æ•°ä¸­æœ‰è®¾ç½®accessOrderçš„æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å®ç°LRUç®—æ³•æ—¶ï¼Œå°±éœ€è¦å°†accessOrderçš„å€¼è®¾å®šä¸ºTRUEã€‚</p>
</li>
<li>
<p>åœ¨HashMapçš„putæ–¹æ³•ä¸­ï¼Œå¦‚æœkeyä¸ä¸ºnullæ—¶ä¸”å“ˆå¸Œè¡¨ä¸­å·²ç»åœ¨å­˜åœ¨æ—¶ï¼Œå¾ªç¯éå†table[i]ä¸­çš„é“¾è¡¨æ—¶ä¼šè°ƒç”¨recordAccessæ–¹æ³•ï¼Œè€Œåœ¨HashMapä¸­è¿™ä¸ªæ–¹æ³•æ˜¯ä¸ªç©ºæ–¹æ³•ï¼Œåœ¨LinkedHashMapä¸­åˆ™å®ç°äº†è¯¥æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåˆ¤æ–­accessOrderæ˜¯å¦ä¸ºtrueï¼Œå¦‚æœä¸ºtrueï¼Œå®ƒä¼šå°†å½“å‰è®¿é—®çš„Entryï¼ˆåœ¨è¿™é‡ŒæŒ‡putè¿›æ¥çš„Entryï¼‰ç§»åŠ¨åˆ°åŒå‘å¾ªç¯é“¾è¡¨çš„å°¾éƒ¨ï¼Œä»è€Œå®ç°åŒå‘é“¾è¡¨ä¸­çš„å…ƒç´ æŒ‰ç…§è®¿é—®é¡ºåºæ¥æ’åºï¼ˆæœ€è¿‘è®¿é—®çš„Entryæ”¾åˆ°é“¾è¡¨çš„æœ€åï¼Œè¿™æ ·å¤šæ¬¡ä¸‹æ¥ï¼Œå‰é¢å°±æ˜¯æœ€è¿‘æ²¡æœ‰è¢«è®¿é—®çš„å…ƒç´ ï¼Œåœ¨å®ç°ã€LRUç®—æ³•æ—¶ï¼Œå½“åŒå‘é“¾è¡¨ä¸­çš„èŠ‚ç‚¹æ•°è¾¾åˆ°æœ€å¤§å€¼æ—¶ï¼Œå°†å‰é¢çš„å…ƒç´ åˆ å»å³å¯ï¼Œå› ä¸ºå‰é¢çš„å…ƒç´ æ˜¯æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ï¼‰ï¼Œå¦åˆ™ä»€ä¹ˆä¹Ÿä¸åšã€‚</p>
</li>
</ul>
<h1 id="è‡ªå®šä¹‰ç±»å‹çš„é›†åˆè¿›è¡Œæ’åº">è‡ªå®šä¹‰ç±»å‹çš„é›†åˆè¿›è¡Œæ’åº</h1>
<h2 id="å®ç°comparableæ¥å£">å®ç°comparableæ¥å£</h2>
<pre><code class="language-java">public class SortTest1 {
    public static void main(String[] args) {
        List &lt;Person&gt; personList = new ArrayList&lt;&gt;();
        personList.add(new Person(&quot;a&quot;, 15));
        personList.add(new Person(&quot;b&quot;, 11));
        personList.add(new Person(&quot;c&quot;, 18));
        personList.add(new Person(&quot;d&quot;, 10));
        Collections.sort(personList);
        System.out.println(personList);
    }

    static class Person implements Comparable&lt;Person&gt;{
        String name;
        int age;

        public Person(String name, int age) {
            this.name = name;
            this.age = age;
        }

        @Override
        public String toString() {
            return &quot;Person{&quot; +
                    &quot;name='&quot; + name + '\'' +
                    &quot;, age=&quot; + age +
                    '}';
        }

        @Override
        public int compareTo(Person o) {
            return this.age - o.age;
        }
    }
}
</code></pre>
<h2 id="å®ç°comparatoræ¯”è¾ƒå™¨">å®ç°comparatoræ¯”è¾ƒå™¨</h2>
<pre><code class="language-java">public class SortTest2 {
    public static void main(String[] args) {
        List &lt;Person&gt; personList = new ArrayList&lt;&gt;();
        personList.add(new Person(&quot;a&quot;, 15));
        personList.add(new Person(&quot;b&quot;, 11));
        personList.add(new Person(&quot;c&quot;, 18));
        personList.add(new Person(&quot;d&quot;, 10));
        Collections.sort(personList);
        System.out.println(personList);
    }

    static class Person implements Comparable&lt;Person&gt;{
        String name;
        int age;

        public Person(String name, int age) {
            this.name = name;
            this.age = age;
        }

        @Override
        public String toString() {
            return &quot;Person{&quot; +
                    &quot;name='&quot; + name + '\'' +
                    &quot;, age=&quot; + age +
                    '}';
        }

        @Override
        public int compareTo(Person o) {
            return this.age - o.age;
        }
    }
}
</code></pre>
<h2 id="åœ¨treesetä¸­çš„ä¸€äº›æ’åºå’Œæ–¹æ³•å¼‚å¸¸">åœ¨TreeSetä¸­çš„ä¸€äº›æ’åºå’Œæ–¹æ³•å¼‚å¸¸</h2>
<h3 id="ä¸€åˆ›å»ºè‡ªå®šä¹‰treesetæ—¶å‡ºé”™">ä¸€.åˆ›å»ºè‡ªå®šä¹‰TreeSetæ—¶å‡ºé”™</h3>
<pre><code class="language-java">public class TreeSetTest {
    public static void main(String[] args) {
        TreeSet&lt;Computer&gt; computers = new TreeSet&lt;&gt;();
        computers.add(new Computer(&quot;Asus&quot;,5800,8));
        computers.add(new Computer(&quot;Lenovo&quot;,4800,16));
        computers.add(new Computer(&quot;Dell&quot;,3800,8));
        computers.add(new Computer(&quot;Mac&quot;,15800,16));
        System.out.println(computers);
    }

    static class Computer {
        String brand;        //å“ç‰Œ
        int price;            //ä»·æ ¼
        int memorySize;    //å†…å­˜å¤§å°

        public Computer(String brand, int price, int memorySize) {
            super();
            this.brand = brand;
            this.price = price;
            this.memorySize = memorySize;
        }

        @Override
        public String toString() {
            return &quot;Computer{&quot; +
                    &quot;brand='&quot; + brand + '\'' +
                    &quot;, price=&quot; + price +
                    &quot;, memorySize=&quot; + memorySize +
                    '}';
        }
    }
}


</code></pre>
<p>è¿™ä¸ªç¨‹åºæˆ‘ä»¬è¿è¡Œçš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œå› ä¸ºTreeSetæ˜¯å¯æ’åºçš„ï¼Œæˆ‘ä»¬çš„è‡ªå®šä¹‰ç±»å¿…é¡»æ˜¯å¯æ’åºçš„ï¼Œæ‰€ä»¥</p>
<p>æˆ‘ä»¬è¦ä¹ˆæŒ‡å®šComparatoræ¯”è¾ƒå™¨ï¼Œè¦ä¹ˆç±»å®ç°Comparableæ¥å£ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬åº”è¯¥åœ¨æ”¹ä¸ºï¼š</p>
<pre><code class="language-java">public class TreeSetTest {
    public static void main(String[] args) {
      //åœ¨å®šä¹‰çš„æ—¶å€™åŠ ä¸ŠComparatoræ¯”è¾ƒå™¨
        TreeSet&lt;Computer&gt; computers = new TreeSet&lt;&gt;(new Comparator&lt;Computer&gt;() {
            @Override
            public int compare(Computer o1, Computer o2) {
                return o1.price - o2.price;
            }
        });
        computers.add(new Computer(&quot;Asus&quot;, 5800, 8));
        computers.add(new Computer(&quot;Lenovo&quot;, 4800, 16));
        computers.add(new Computer(&quot;Dell&quot;, 3800, 8));
        computers.add(new Computer(&quot;Mac&quot;, 15800, 16));
        System.out.println(computers);
    }

    static class Computer {
        String brand;        //å“ç‰Œ
        int price;            //ä»·æ ¼
        int memorySize;    //å†…å­˜å¤§å°

        public Computer(String brand, int price, int memorySize) {
            super();
            this.brand = brand;
            this.price = price;
            this.memorySize = memorySize;
        }

        @Override
        public String toString() {
            return &quot;Computer{&quot; +
                    &quot;brand='&quot; + brand + '\'' +
                    &quot;, price=&quot; + price +
                    &quot;, memorySize=&quot; + memorySize +
                    '}';
        }
    }
}


</code></pre>
<h3 id="äºŒæŒ‡å®šæ¯”è¾ƒå™¨åæ·»åŠ å¤±è´¥åˆ é™¤æ–¹æ³•å¼‚å¸¸">äºŒ.æŒ‡å®šæ¯”è¾ƒå™¨åæ·»åŠ å¤±è´¥ï¼Œåˆ é™¤æ–¹æ³•å¼‚å¸¸ã€‚</h3>
<p>å¦‚æœæˆ‘ä»¬åœ¨mainæ–¹æ³•ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªå’Œæ¯”è¾ƒå™¨çš„æ¯”è¾ƒå¯¹è±¡æ¯”è¾ƒå€¼ä¸€æ ·çš„å¯¹è±¡é»˜è®¤ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä¸ä¼šæ‰§è¡Œè¯¥å¯¹è±¡ã€‚</p>
<pre><code class="language-java">public static void main(String[] args) {
    TreeSet&lt;Computer&gt; computers = new TreeSet&lt;&gt;(new Comparator&lt;Computer&gt;() {
        @Override
        public int compare(Computer o1, Computer o2) {
            return o1.price - o2.price;
        }
    });
    computers.add(new Computer(&quot;Asus&quot;, 5800, 8));
    computers.add(new Computer(&quot;Lenovo&quot;, 4800, 16));
    computers.add(new Computer(&quot;Dell&quot;, 3800, 8));
    computers.add(new Computer(&quot;Mac&quot;, 15800, 16));
    System.out.println(computers);
  //[Computer{brand='Dell', price=3800, memorySize=8}, Computer{brand='Lenovo', price=4800, memorySize=16}, Computer{brand='Asus', price=5800, memorySize=8}, Computer{brand='Mac', price=15800, memorySize=16}]
    computers.add((new Computer(&quot;Acer&quot;,5800,8)));
    System.out.println(computers);
  //[Computer{brand='Dell', price=3800, memorySize=8}, Computer{brand='Lenovo', price=4800, memorySize=16}, Computer{brand='Asus', price=5800, memorySize=8}, Computer{brand='Mac', price=15800, memorySize=16}]
}

</code></pre>
<p><strong>è€Œå¦‚æœæˆ‘ä»¬åˆ é™¤ä¸€ä¸ªå“ç‰Œä¸ºå°ç±³ï¼Œpriceä¸º5800ï¼Œå†…å­˜ä¸º8çš„å¯¹è±¡æ—¶ï¼Œä»–ä¼šåˆ é™¤ä»·æ ¼ä¸º5800çš„åç¡•ç”µè„‘ã€‚</strong></p>
<p><strong>å› ä¸ºTreeSetæ‰§è¡ŒComparaToæ–¹æ³•ï¼Œè¿”å›å€¼å¦‚æœä¸º0ï¼Œé‚£ä¹ˆå®ƒä¼šè®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡æ˜¯åŒä¸€å¯¹è±¡ã€‚å¦‚è¯¥ç¨‹åºä¸­ï¼Œåç¡•ç”µè„‘å’Œå°ç±³ç”µè„‘ä¸€æ ·çš„ä»·æ ¼ï¼Œå®ƒæ‰§è¡Œæ¯”è¾ƒå™¨è¿”å›0ï¼Œå°±ä¼šè®¤ä¸ºæ˜¯åŒä¸€å¯¹è±¡</strong></p>
]]></content>
    </entry>
</feed>